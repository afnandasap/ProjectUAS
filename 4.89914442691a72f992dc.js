(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{jkDv:function(t,e,n){"use strict";n.r(e),n.d(e,"AdminModule",function(){return Op});var r=n("ofXK"),i=n("fXoL"),o=n("tyNb"),s=n("bTqV"),a=n("XhcP");let u=(()=>{class t{constructor(t){this.router=t,this.loading=!0}ngOnInit(){}logout(){confirm("Keluar aplikasi?")&&(localStorage.removeItem("appToken"),this.router.navigate(["/login"]))}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(o.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-admin"]],decls:17,vars:4,consts:[["mat-icon-button","",3,"click"],[1,"uk-width-expand"],["mat-button","","routerLink","/admin/dashboard"],["mat-button","","routerLink","/admin/employee"],["mat-button","",2,"margin-left","85%",3,"click"],[1,"example-container"],["mode","side","opened","",1,"sidenav-left",3,"position","fixedInViewport","fixedTopGap","fixedBottomGap"],["sidenav",""],[2,"padding","20px","background-color","#ECEFF1"]],template:function(t,e){if(1&t){const t=i.Wb();i.Tb(0),i.Vb(1,"button",0),i.cc("click",function(){return i.sc(t),i.qc(14).toggle()}),i.Ub(),i.Qb(2,"div",1),i.Vb(3,"button",2),i.Vb(4,"u"),i.zc(5,"DASHBOARD"),i.Ub(),i.Ub(),i.Vb(6,"button",3),i.Vb(7,"u"),i.zc(8,"BERKAS"),i.Ub(),i.Ub(),i.Vb(9,"button",4),i.cc("click",function(){return e.logout()}),i.Vb(10,"u"),i.zc(11,"LOGOUT"),i.Ub(),i.Ub(),i.Vb(12,"mat-sidenav-container",5),i.Qb(13,"mat-sidenav",6,7),i.Vb(15,"mat-sidenav-content",8),i.Qb(16,"router-outlet"),i.Ub(),i.Ub(),i.Sb()}2&t&&(i.Eb(13),i.lc("position","start")("fixedInViewport",!0)("fixedTopGap",65)("fixedBottomGap",0))},directives:[s.a,o.b,a.b,a.a,a.c,o.d],styles:[""]}),t})();var c=n("0IaG"),h=n("H+bZ"),l=n("D0XW"),f=n("HDdC"),d=n("Cfvw"),p=n("LRne"),y=n("JX91"),v=n("Zy1z"),g=n("lJxs"),m=n("Kqap"),b=n("/uUt"),w=n("pLZG"),I=n("pxpQ"),E=n("spgP"),T=n("Jgta"),_=n("zIRd"),O=n("qOnz"),S=n("q/0M"),D=function(t,e){return(D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,k="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},C=C||{},x=k||self;function j(){}function R(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var L="closure_uid_"+(1e9*Math.random()>>>0),M=0;function F(t,e,n){return t.call.apply(t.bind,arguments)}function V(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function U(t,e,n){return(U=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?F:V).apply(null,arguments)}function q(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function B(){return Date.now()}function K(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Pb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function G(){this.j=this.j,this.i=this.i}G.prototype.j=!1,G.prototype.ka=function(){!this.j&&(this.j=!0,this.H(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,L)&&t[L]||(t[L]=++M)}(this)},G.prototype.H=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var z=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function H(t){return Array.prototype.concat.apply([],arguments)}function W(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Y(t){return/^[\s\xa0]*$/.test(t)}var X,$=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function J(t,e){return-1!=t.indexOf(e)}function Z(t,e){return t<e?-1:t>e?1:0}t:{var tt=x.navigator;if(tt){var et=tt.userAgent;if(et){X=et;break t}}X=""}function nt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function rt(t){var e={};for(var n in t)e[n]=t[n];return e}var it="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ot(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<it.length;o++)n=it[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function st(t){return st[" "](t),t}st[" "]=j;var at,ut,ct=J(X,"Opera"),ht=J(X,"Trident")||J(X,"MSIE"),lt=J(X,"Edge"),ft=lt||ht,dt=J(X,"Gecko")&&!(J(X.toLowerCase(),"webkit")&&!J(X,"Edge"))&&!(J(X,"Trident")||J(X,"MSIE"))&&!J(X,"Edge"),pt=J(X.toLowerCase(),"webkit")&&!J(X,"Edge");function yt(){var t=x.document;return t?t.documentMode:void 0}t:{var vt="",gt=(ut=X,dt?/rv:([^\);]+)(\)|;)/.exec(ut):lt?/Edge\/([\d\.]+)/.exec(ut):ht?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ut):pt?/WebKit\/(\S+)/.exec(ut):ct?/(?:Version)[ \/]?(\S+)/.exec(ut):void 0);if(gt&&(vt=gt?gt[1]:""),ht){var mt=yt();if(null!=mt&&mt>parseFloat(vt)){at=String(mt);break t}}at=vt}var bt={};function wt(t){return function(t,e){var n=bt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,function(){for(var e=0,n=$(String(at)).split("."),r=$(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=Z(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||Z(0==s[2].length,0==a[2].length)||Z(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e})}var It=x.document&&ht&&(yt()||parseInt(at,10))||void 0,Et=!ht||9<=Number(It),Tt=ht&&!wt("9"),_t=function(){if(!x.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{x.addEventListener("test",j,e),x.removeEventListener("test",j,e)}catch(n){}return t}();function Ot(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function St(t,e){if(Ot.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(dt){t:{try{st(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Dt[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}Ot.prototype.b=function(){this.defaultPrevented=!0},K(St,Ot);var Dt={2:"touch",3:"pen",4:"mouse"};St.prototype.b=function(){St.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Tt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var At="closure_listenable_"+(1e6*Math.random()|0),Nt=0;function kt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.da=i,this.key=++Nt,this.Y=this.Z=!1}function Ct(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function xt(t){this.src=t,this.a={},this.b=0}function jt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=z(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Ct(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Rt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.da==r)return i}return-1}xt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Rt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new kt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Pt="closure_lm_"+(1e6*Math.random()|0),Lt={};function Mt(t,e,n,r,i){if(r&&r.once)return Vt(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Mt(t,e[o],n,r,i);return null}return n=Ht(n),t&&t[At]?t.wa(e,n,P(r)?!!r.capture:!!r,i):Ft(t,e,n,!1,r,i)}function Ft(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=P(i)?!!i.capture:!!i;if(s&&!Et)return null;var a=zt(t);if(a||(t[Pt]=a=new xt(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=Gt,e=Et?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)_t||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Bt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Vt(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Vt(t,e[o],n,r,i);return null}return n=Ht(n),t&&t[At]?t.xa(e,n,P(r)?!!r.capture:!!r,i):Ft(t,e,n,!0,r,i)}function Ut(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Ut(t,e[o],n,r,i);else r=P(r)?!!r.capture:!!r,n=Ht(n),t&&t[At]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=Rt(o=t.a[e],n,r,i))&&(Ct(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=zt(t))&&(e=t.a[e.toString()],t=-1,e&&(t=Rt(e,n,r,i)),(n=-1<t?e[t]:null)&&qt(n))}function qt(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[At])jt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Bt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=zt(e))?(jt(n,t),0==n.b&&(n.src=null,e[Pt]=null)):Ct(t)}}}function Bt(t){return t in Lt?Lt[t]:Lt[t]="on"+t}function Kt(t,e){var n=t.listener,r=t.da||t.src;return t.Z&&qt(t),n.call(r,e)}function Gt(t,e){if(t.Y)return!0;if(!Et){if(!e)t:{e=["window","event"];for(var n=x,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Kt(t,e=new St(e,this))}return Kt(t,new St(e,this))}function zt(t){return(t=t[Pt])instanceof xt?t:null}var Qt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ht(t){return"function"==typeof t?t:(t[Qt]||(t[Qt]=function(e){return t.handleEvent(e)}),t[Qt])}function Wt(){G.call(this),this.c=new xt(this),this.J=this,this.D=null}function Yt(t,e){var n,r=t.D;if(r)for(n=[];r;r=r.D)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new Ot(e,t);else if(e instanceof Ot)e.target=e.target||t;else{var i=e;ot(e=new Ot(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=Xt(s,r,!0,e)&&i}if(i=Xt(s=e.a=t,r,!0,e)&&i,i=Xt(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Xt(s=e.a=n[o],r,!1,e)&&i}function Xt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var a=s.listener,u=s.da||s.src;s.Z&&jt(t.c,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}K(Wt,G),Wt.prototype[At]=!0,(N=Wt.prototype).addEventListener=function(t,e,n,r){Mt(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){Ut(this,t,e,n,r)},N.H=function(){if(Wt.X.H.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Ct(n[r]);delete e.a[t],e.b--}}this.D=null},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.xa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var $t=x.JSON.stringify;function Jt(){this.b=this.a=null}var Zt,te=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())(function(){return new ne},function(t){t.reset()});function ee(){var t=se,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function ne(){this.next=this.b=this.a=null}function re(t){x.setTimeout(function(){throw t},0)}function ie(t,e){Zt||function(){var t=x.Promise.resolve(void 0);Zt=function(){t.then(ae)}}(),oe||(Zt(),oe=!0),se.add(t,e)}Jt.prototype.add=function(t,e){var n=te.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},ne.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},ne.prototype.reset=function(){this.next=this.b=this.a=null};var oe=!1,se=new Jt;function ae(){for(var t;t=ee();){try{t.a.call(t.b)}catch(n){re(n)}var e=te;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}oe=!1}function ue(t,e){Wt.call(this),this.b=t||1,this.a=e||x,this.f=U(this.eb,this),this.g=B()}function ce(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function he(t,e,n){if("function"==typeof t)n&&(t=U(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=U(t.handleEvent,t)}return 2147483647<Number(e)?-1:x.setTimeout(t,e||0)}function le(t){t.a=he(function(){t.a=null,t.c&&(t.c=!1,le(t))},t.h);var e=t.b;t.b=null,t.g.apply(null,e)}K(ue,Wt),(N=ue.prototype).aa=!1,N.M=null,N.eb=function(){if(this.aa){var t=B()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Yt(this,"tick"),this.aa&&(ce(this),this.start()))}},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=B())},N.H=function(){ue.X.H.call(this),ce(this),delete this.a};var fe=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}D(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:le(this)},e.prototype.H=function(){t.prototype.H.call(this),this.a&&(x.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(G);function de(t){G.call(this),this.b=t,this.a={}}K(de,G);var pe=[];function ye(t,e,n,r){Array.isArray(n)||(n&&(pe[0]=n.toString()),n=pe);for(var i=0;i<n.length;i++){var o=Mt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ve(t){nt(t.a,function(t,e){this.a.hasOwnProperty(e)&&qt(t)},t),t.a={}}function ge(){this.a=!0}function me(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return $t(n)}catch(a){return e}}(t,n)+(r?" "+r:"")})}de.prototype.H=function(){de.X.H.call(this),ve(this)},de.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ge.prototype.info=function(){};var be={},we=null;function Ie(){return we=we||new Wt}function Ee(t){Ot.call(this,be.Ga,t)}function Te(t){var e=Ie();Yt(e,new Ee(e,t))}function _e(t,e){Ot.call(this,be.STAT_EVENT,t),this.stat=e}function Oe(t){var e=Ie();Yt(e,new _e(e,t))}function Se(t){Ot.call(this,be.Ha,t)}function De(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return x.setTimeout(function(){t()},e)}be.Ga="serverreachability",K(Ee,Ot),be.STAT_EVENT="statevent",K(_e,Ot),be.Ha="timingevent",K(Se,Ot);var Ae={NO_ERROR:0,fb:1,sb:2,rb:3,mb:4,qb:5,tb:6,Ea:7,TIMEOUT:8,wb:9},Ne={kb:"complete",Gb:"success",Fa:"error",Ea:"abort",yb:"ready",zb:"readystatechange",TIMEOUT:"timeout",ub:"incrementaldata",xb:"progress",nb:"downloadprogress",Ob:"uploadprogress"};function ke(){}function Ce(){}ke.prototype.b=null;var xe,je={OPEN:"a",jb:"b",Fa:"c",vb:"d"};function Re(){Ot.call(this,"d")}function Pe(){Ot.call(this,"c")}function Le(){}function Me(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new de(this),this.P=Fe,this.R=new ue(t=ft?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.G=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}K(Re,Ot),K(Pe,Ot),K(Le,ke),Le.prototype.a=function(){return new XMLHttpRequest},Le.prototype.c=function(){return{}},xe=new Le;var Fe=45e3,Ve={},Ue={};function qe(t,e,n){t.G=1,t.i=hn(rn(e)),t.j=n,t.I=!0,Be(t,null)}function Be(t,e){t.u=B(),ze(t),t.l=rn(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),Tn(n.b,"t",r),t.D=0,t.a=gr(t.g,t.g.C?e:null),0<t.O&&(t.F=new fe(U(t.Da,t,t.a),t.O)),ye(t.J,t.a,"readystatechange",t.bb),e=t.B?rt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),Te(1),function(t,e,n,r,i,o){t.info(function(){if(t.a)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&"type"==l[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.c,t.m,t.l,t.f,t.S,t.j)}function Ke(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=Ge(t,n);if(i==Ue){4==e&&(t.h=4,Oe(14),r=!1),me(t.c,t.f,null,"[Incomplete Response]");break}if(i==Ve){t.h=4,Oe(15),me(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}me(t.c,t.f,i,null),Xe(t,i)}4==e&&0==n.length&&(t.h=1,Oe(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),cr(e),e.F=!0,Oe(11))):(me(t.c,t.f,n,"[Invalid Chunked Response]"),Ye(t),We(t))}function Ge(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?Ue:(n=Number(e.substring(n,r)),isNaN(n)?Ve:(r+=1)+n>e.length?Ue:(e=e.substr(r,n),t.D=r+n,e))}function ze(t){t.T=B()+t.P,Qe(t,t.P)}function Qe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=De(U(t.$a,t),e)}function He(t){t.o&&(x.clearTimeout(t.o),t.o=null)}function We(t){0==t.g.v||t.A||fr(t.g,t)}function Ye(t){He(t);var e=t.F;e&&"function"==typeof e.ka&&e.ka(),t.F=null,ce(t.R),ve(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ka())}function Xe(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||kn(n.b,t)))if(n.I=t.N,!t.C&&kn(n.b,t)&&3==n.v){try{var r=n.la.a.parse(e)}catch(Id){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;lr(n),tr(n)}ur(n),Oe(18)}}else n.pa=i[1],0<n.pa-n.P&&37500>i[2]&&n.G&&0==n.o&&!n.m&&(n.m=De(U(n.Xa,n),6e3));if(1>=Nn(n.b)&&n.fa){try{n.fa()}catch(Id){}n.fa=void 0}}else pr(n,11)}else if((t.C||n.a==t)&&lr(n),!Y(e))for(e=r=n.la.a.parse(e),r=0;r<e.length;r++)if(n.P=(i=e[r])[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ha=i[2];var o=i[3];null!=o&&(n.ia=o,n.c.info("VER="+n.ia));var s=i[4];null!=s&&(n.qa=s,n.c.info("SVER="+n.qa));var a=i[5];if(null!=a&&"number"==typeof a&&0<a){var u=1.5*a;n.D=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=u.b;!l.a&&(J(h,"spdy")||J(h,"quic")||J(h,"h2"))&&(l.f=l.g,l.a=new Set,l.b&&(Cn(l,l.b),l.b=null))}if(u.A){var f=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.oa=f,cn(u.B,u.A,f))}}n.v=3,n.f&&n.f.ua(),n.U&&(n.N=B()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var d=t;if((u=n).ma=vr(u,u.C?u.ha:null,u.ga),d.C){xn(u.b,d);var p=d,y=u.D;y&&p.setTimeout(y),p.o&&(He(p),ze(p)),u.a=d}else ar(u);0<n.g.length&&rr(n)}else"stop"!=i[0]&&"close"!=i[0]||pr(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?pr(n,7):Zn(n):"noop"!=i[0]&&n.f&&n.f.ta(i),n.o=0);Te(4)}catch(Id){}}function $e(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(R(t)||"string"==typeof t)Q(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(R(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(R(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Je(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Je)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];tn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)tn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function tn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Me.prototype).setTimeout=function(t){this.P=t},N.bb=function(t){t=t.target;var e=this.F;e&&3==Yn(t)?e.f():this.Da(t)},N.Da=function(t){try{if(t==this.a)t:{var e=Yn(this.a),n=this.a.va(),r=this.a.W();if(!(3>e||3==e&&!ft&&!this.a.$())){this.A||4!=e||7==n||Te(8==n||0>=r?3:2),He(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,a=this.a;if((s=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Y(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.h=3,Oe(12),Ye(this),We(this);break t}me(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Xe(this,u)}this.I?(Ke(this,e,o),ft&&this.b&&3==e&&(ye(this.J,this.R,"tick",this.ab),this.R.start())):(me(this.c,this.f,o,null),Xe(this,o)),4==e&&Ye(this),this.b&&!this.A&&(4==e?fr(this.g,this):(this.b=!1,ze(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Oe(12)):(this.h=0,Oe(13)),Ye(this),We(this)}}}catch(c){}},N.ab=function(){if(this.a){var t=Yn(this.a),e=this.a.$();this.D<e.length&&(He(this),Ke(this,t,e),this.b&&4!=t&&ze(this))}},N.cancel=function(){this.A=!0,Ye(this)},N.$a=function(){this.o=null;var t=B();0<=t-this.T?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.c,this.l),2!=this.G&&(Te(3),Oe(17)),Ye(this),this.h=2,We(this)):Qe(this,this.T-t)},(N=Je.prototype).K=function(){Ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return Ze(this),this.a.concat()},N.get=function(t,e){return tn(this.b,t)?this.b[t]:e},N.set=function(t,e){tn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var en=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function nn(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof nn){this.a=void 0!==e?e:t.a,on(this,t.f),this.j=t.j,sn(this,t.c),an(this,t.h),this.g=t.g,e=t.b;var n=new bn;n.c=e.c,e.a&&(n.a=new Je(e.a),n.b=e.b),un(this,n),this.i=t.i}else t&&(n=String(t).match(en))?(this.a=!!e,on(this,n[1]||"",!0),this.j=ln(n[2]||""),sn(this,n[3]||"",!0),an(this,n[4]),this.g=ln(n[5]||"",!0),un(this,n[6]||"",!0),this.i=ln(n[7]||"")):(this.a=!!e,this.b=new bn(null,this.a))}function rn(t){return new nn(t)}function on(t,e,n){t.f=n?ln(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function sn(t,e,n){t.c=n?ln(e,!0):e}function an(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function un(t,e,n){e instanceof bn?(t.b=e,function(t,e){e&&!t.f&&(wn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(In(this,e),Tn(this,n,t))},t)),t.f=e}(t.b,t.a)):(n||(e=fn(e,gn)),t.b=new bn(e,t.a))}function cn(t,e,n){t.b.set(e,n)}function hn(t){return cn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^B()).toString(36)),t}function ln(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function fn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,dn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function dn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}nn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(fn(e,pn,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(fn(e,pn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(fn(n,"/"==n.charAt(0)?vn:yn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",fn(n,mn)),t.join("")};var pn=/[#\/\?@]/g,yn=/[#\?:]/g,vn=/[#\?]/g,gn=/[#\?@]/g,mn=/#/g;function bn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function wn(t){t.a||(t.a=new Je,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function In(t,e){wn(t),e=_n(t,e),tn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,tn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ze(t)))}function En(t,e){return wn(t),e=_n(t,e),tn(t.a.b,e)}function Tn(t,e,n){In(t,e),0<n.length&&(t.c=null,t.a.set(_n(t,e),W(n)),t.b+=n.length)}function _n(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(N=bn.prototype).add=function(t,e){wn(this),this.c=null,t=_n(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(t,e){wn(this),this.a.forEach(function(n,r){Q(n,function(n){t.call(e,n,r,this)},this)},this)},N.L=function(){wn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){wn(this);var e=[];if("string"==typeof t)En(this,t)&&(e=H(e,this.a.get(_n(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=H(e,t[n])}return e},N.set=function(t,e){return wn(this),this.c=null,En(this,t=_n(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var On=function(){return function(t,e){this.b=t,this.a=e}}();function Sn(t){this.g=t||Dn,t=x.PerformanceNavigationTiming?0<(t=x.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(x.ja&&x.ja.za&&x.ja.za()&&x.ja.za().Qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var Dn=10;function An(t){return!!t.b||!!t.a&&t.a.size>=t.f}function Nn(t){return t.b?1:t.a?t.a.size:0}function kn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function Cn(t,e){t.a?t.a.add(e):t.b=e}function xn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function jn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.s)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return W(t.c)}function Rn(){}function Pn(){this.a=new Rn}function Ln(t,e,n){var r=n||"";try{$e(t,function(t,n){var i=t;P(t)&&(i=$t(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(zd){throw e.push(r+"type="+encodeURIComponent("_badmap")),zd}}function Mn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}Sn.prototype.cancel=function(){var t,e;if(this.c=jn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Rn.prototype.stringify=function(t){return x.JSON.stringify(t,void 0)},Rn.prototype.parse=function(t){return x.JSON.parse(t,void 0)};var Fn=x.JSON.parse;function Vn(t){Wt.call(this),this.headers=new Je,this.l=t||null,this.b=!1,this.u=this.a=null,this.C="",this.h=0,this.f="",this.g=this.B=this.m=this.A=!1,this.s=0,this.o=null,this.I=Un,this.F=this.G=!1}K(Vn,Wt);var Un="",qn=/^https?$/i,Bn=["POST","PUT"];function Kn(t){return"content-type"==t.toLowerCase()}function Gn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,zn(t),Hn(t)}function zn(t){t.A||(t.A=!0,Yt(t,"complete"),Yt(t,"error"))}function Qn(t){if(t.b&&void 0!==C&&(!t.u[1]||4!=Yn(t)||2!=t.W()))if(t.m&&4==Yn(t))he(t.Aa,0,t);else if(Yt(t,"readystatechange"),4==Yn(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.C).match(en)[1]||null;if(!o&&x.self&&x.self.location){var s=x.self.location.protocol;o=s.substr(0,s.length-1)}i=!qn.test(o?o.toLowerCase():"")}e=i}if(e)Yt(t,"complete"),Yt(t,"success");else{t.h=6;try{var a=2<Yn(t)?t.a.statusText:""}catch(n){a=""}t.f=a+" ["+t.W()+"]",zn(t)}}finally{Hn(t)}}}function Hn(t,e){if(t.a){Wn(t);var n=t.a,r=t.u[0]?j:null;t.a=null,t.u=null,e||Yt(t,"ready");try{n.onreadystatechange=r}catch(zd){}}}function Wn(t){t.a&&t.F&&(t.a.ontimeout=null),t.o&&(x.clearTimeout(t.o),t.o=null)}function Yn(t){return t.a?t.a.readyState:0}function Xn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return nt(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):cn(t,e,n))}function $n(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Jn(t){this.qa=0,this.g=[],this.c=new ge,this.ha=this.ma=this.B=this.ga=this.a=this.oa=this.A=this.V=this.i=this.O=this.l=null,this.Pa=this.R=0,this.Ma=$n("failFast",!1,t),this.G=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.pa=this.P=-1,this.T=this.o=this.u=0,this.Ia=$n("baseRetryDelayMs",5e3,t),this.Sa=$n("retryDelaySeedMs",1e4,t),this.Na=$n("forwardChannelMaxRetries",2,t),this.na=$n("forwardChannelRequestTimeoutMs",2e4,t),this.Oa=t&&t.xmlHttpFactory||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Sn(t&&t.concurrentRequestLimit),this.la=new Pn,this.ea=t&&t.fastHandshake||!1,this.Ja=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.ea&&this.S&&t&&t.detectBufferingProxy||!1,this.fa=void 0,this.N=0,this.F=!1,this.s=null,(this.La=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Zn(t){if(er(t),3==t.v){var e=t.R++,n=rn(t.B);cn(n,"SID",t.J),cn(n,"RID",e),cn(n,"TYPE","terminate"),or(t,n),(e=new Me(t,t.c,e,void 0)).G=2,e.i=hn(rn(n)),n=!1,x.navigator&&x.navigator.sendBeacon&&(n=x.navigator.sendBeacon(e.i.toString(),"")),!n&&x.Image&&((new Image).src=e.i,n=!0),n||(e.a=gr(e.g,null),e.a.ba(e.i)),e.u=B(),ze(e)}yr(t)}function tr(t){t.a&&(cr(t),t.a.cancel(),t.a=null)}function er(t){tr(t),t.j&&(x.clearTimeout(t.j),t.j=null),lr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&x.clearTimeout(t.h),t.h=null)}function nr(t,e){t.g.push(new On(t.Pa++,e)),3==t.v&&rr(t)}function rr(t){An(t.b)||t.h||(t.h=!0,ie(t.Ca,t),t.u=0)}function ir(t,e){var n;n=e?e.f:t.R++;var r=rn(t.B);cn(r,"SID",t.J),cn(r,"RID",n),cn(r,"AID",t.P),or(t,r),t.i&&t.l&&Xn(r,t.i,t.l),n=new Me(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=sr(t,n,1e3),n.setTimeout(Math.round(.5*t.na)+Math.round(.5*t.na*Math.random())),Cn(t.b,n),qe(n,r,e)}function or(t,e){t.f&&$e({},function(t,n){cn(e,n,t)})}function sr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?U(t.f.Ka,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].b)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),a=!1;else try{Ln(h,s,"req"+c+"_")}catch(ti){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function ar(t){t.a||t.j||(t.T=1,ie(t.Ba,t),t.o=0)}function ur(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=De(U(t.Ba,t),dr(t,t.o)),t.o++,0))}function cr(t){null!=t.s&&(x.clearTimeout(t.s),t.s=null)}function hr(t){t.a=new Me(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=rn(t.ma);cn(e,"RID","rpc"),cn(e,"SID",t.J),cn(e,"CI",t.G?"0":"1"),cn(e,"AID",t.P),or(t,e),cn(e,"TYPE","xmlhttp"),t.i&&t.l&&Xn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ha,n.G=1,n.i=hn(rn(e)),n.j=null,n.I=!0,Be(n,t)}function lr(t){null!=t.m&&(x.clearTimeout(t.m),t.m=null)}function fr(t,e){var n=null;if(t.a==e){lr(t),cr(t),t.a=null;var r=2}else{if(!kn(t.b,e))return;n=e.s,xn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=B()-e.u;var i=t.u;Yt(r=Ie(),new Se(r,n,e,i)),rr(t)}else ar(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(Nn(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.Ma?0:t.Na)||(t.h=De(U(t.Ca,t,e),dr(t,t.u)),t.u++,0)))}(t,e)||2==r&&ur(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:pr(t,5);break;case 4:pr(t,10);break;case 3:pr(t,6);break;default:pr(t,2)}}function dr(t,e){var n=t.Ia+Math.floor(Math.random()*t.Sa);return t.f||(n*=2),n*e}function pr(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=U(t.cb,t);n||(n=new nn("//www.google.com/images/cleardot.gif"),x.location&&"http"==x.location.protocol||on(n,"https"),hn(n)),function(t,e){var n=new ge;if(x.Image){var r=new Image;r.onload=q(Mn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=q(Mn,n,r,"TestLoadImage: error",!1,e),r.onabort=q(Mn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=q(Mn,n,r,"TestLoadImage: timeout",!1,e),x.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else Oe(2);t.v=0,t.f&&t.f.sa(e),yr(t),er(t)}function yr(t){t.v=0,t.I=-1,t.f&&(0==jn(t.b).length&&0==t.g.length||(t.b.c.length=0,W(t.g),t.g.length=0),t.f.ra())}function vr(t,e,n){var r=function(t){return t instanceof nn?rn(t):new nn(t,void 0)}(n);if(""!=r.c)e&&sn(r,e+"."+r.c),an(r,r.h);else{var i=x.location;r=function(t,e,n,r){var i=new nn(null,void 0);return t&&on(i,t),e&&sn(i,e),n&&an(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&nt(t.V,function(t,e){cn(r,e,t)}),n=t.oa,(e=t.A)&&n&&cn(r,e,n),cn(r,"VER",t.ia),or(t,r),r}function gr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Vn(t.Oa)).G=t.C,e}function mr(){}function br(){if(ht&&!(10<=Number(It)))throw Error("Environmental error: no available transport.")}function wr(t,e){Wt.call(this),this.a=new Jn(e),this.g=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!Y(t)&&(this.a.i=t),this.o=e&&e.supportsCrossDomainXhr||!1,this.m=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Y(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new Tr(this)}function Ir(t){Re.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Er(){Pe.call(this),this.status=1}function Tr(t){this.a=t}function _r(t){this.f=t}function Or(t){Wt.call(this),this.u=t,this.h=void 0,this.readyState=Sr,this.status=0,this.responseType=this.responseText=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.o="",this.a=!1,this.m=this.f=this.g=null}(N=Vn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.C+"; newUri="+t);e=e?e.toUpperCase():"GET",this.C=t,this.f="",this.h=0,this.A=!1,this.b=!0,this.a=this.l?this.l.a():xe.a(),this.u=function(t){return t.b||(t.b=t.c())}(this.l?this.l:xe),this.a.onreadystatechange=U(this.Aa,this);try{this.B=!0,this.a.open(e,String(t),!0),this.B=!1}catch(o){return void Gn(this,o)}t=n||"";var i=new Je(this.headers);r&&$e(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=Kn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=x.FormData&&t instanceof x.FormData,!(0<=z(Bn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.G&&(this.a.withCredentials=this.G);try{Wn(this),0<this.s&&((this.F=function(t){return ht&&wt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.s,this.a.ontimeout=U(this.ya,this)):this.o=he(this.ya,this.s,this)),this.m=!0,this.a.send(t),this.m=!1}catch(o){Gn(this,o)}},N.ya=function(){void 0!==C&&this.a&&(this.f="Timed out after "+this.s+"ms, aborting",this.h=8,Yt(this,"timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Yt(this,"complete"),Yt(this,"abort"),Hn(this))},N.H=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Hn(this,!0)),Vn.X.H.call(this)},N.Aa=function(){this.j||(this.B||this.m||this.g?Qn(this):this.Za())},N.Za=function(){Qn(this)},N.W=function(){try{return 2<Yn(this)?this.a.status:-1}catch(ut){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(ut){return""}},N.Qa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Fn(e)}},N.va=function(){return this.h},N.Ra=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Jn.prototype).ia=8,N.v=1,N.Ca=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Me(this,this.c,t,void 0),r=this.l;if(this.O&&(r?ot(r=rt(r),this.O):r=this.O),null===this.i&&(n.B=r),this.ea)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=sr(this,n,e),cn(i=rn(this.B),"RID",t),cn(i,"CVER",22),this.A&&cn(i,"X-HTTP-Session-Id",this.A),or(this,i),this.i&&r&&Xn(i,this.i,r),Cn(this.b,n),this.Ja&&cn(i,"TYPE","init"),this.ea?(cn(i,"$req",e),cn(i,"SID","null"),n.U=!0,qe(n,i,null)):qe(n,i,e),this.v=2}}else 3==this.v&&(t?ir(this,t):0==this.g.length||An(this.b)||ir(this))},N.Ba=function(){if(this.j=null,hr(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=De(U(this.Ya,this),t)}},N.Ya=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.F=!0,Oe(10),tr(this),hr(this))},N.Xa=function(){null!=this.m&&(this.m=null,tr(this),ur(this),Oe(19))},N.cb=function(t){t?(this.c.info("Successfully pinged google.com"),Oe(2)):(this.c.info("Failed to ping google.com"),Oe(1))},(N=mr.prototype).ua=function(){},N.ta=function(){},N.sa=function(){},N.ra=function(){},N.Ka=function(){},br.prototype.a=function(t,e){return new wr(t,e)},K(wr,Wt),wr.prototype.h=function(){this.a.f=this.f,this.o&&(this.a.C=!0);var t=this.a,e=this.g,n=this.b||void 0;Oe(0),t.ga=e,t.V=n||{},t.G=t.S,t.B=vr(t,null,t.ga),rr(t)},wr.prototype.close=function(){Zn(this.a)},wr.prototype.l=function(t){if("string"==typeof t){var e={};e.__data__=t,nr(this.a,e)}else this.m?((e={}).__data__=$t(t),nr(this.a,e)):nr(this.a,t)},wr.prototype.H=function(){this.a.f=null,delete this.f,Zn(this.a),delete this.a,wr.X.H.call(this)},K(Ir,Re),K(Er,Pe),K(Tr,mr),Tr.prototype.ua=function(){Yt(this.a,"a")},Tr.prototype.ta=function(t){Yt(this.a,new Ir(t))},Tr.prototype.sa=function(t){Yt(this.a,new Er(t))},Tr.prototype.ra=function(){Yt(this.a,"b")},K(_r,ke),_r.prototype.a=function(){return new Or(this.f)},_r.prototype.c=function(t){return function(){return t}}({}),K(Or,Wt);var Sr=0;function Dr(t){t.f.read().then(t.Ta.bind(t)).catch(t.ca.bind(t))}function Ar(t){t.readyState=4,t.g=null,t.f=null,t.m=null,Nr(t)}function Nr(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(N=Or.prototype).open=function(t,e){if(this.readyState!=Sr)throw this.abort(),Error("Error reopening a connection");this.s=t,this.o=e,this.readyState=1,Nr(this)},N.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.l,method:this.s,credentials:this.h,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.o,e)).then(this.Wa.bind(this),this.ca.bind(this))},N.abort=function(){this.responseText="",this.l=new Headers,this.status=0,this.f&&this.f.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,Ar(this)),this.readyState=Sr},N.Wa=function(t){this.a&&(this.g=t,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=t.headers,this.readyState=2,Nr(this)),this.a&&(this.readyState=3,Nr(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.Ua.bind(this),this.ca.bind(this)):void 0!==x.ReadableStream&&"body"in t?(this.responseText="",this.f=t.body.getReader(),this.m=new TextDecoder,Dr(this)):t.text().then(this.Va.bind(this),this.ca.bind(this)))))},N.Ta=function(t){if(this.a){var e=this.m.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.responseText+=e),t.done?Ar(this):Nr(this),3==this.readyState&&Dr(this)}},N.Va=function(t){this.a&&(this.responseText=t,Ar(this))},N.Ua=function(){this.a&&Ar(this)},N.ca=function(){this.a&&Ar(this)},N.setRequestHeader=function(t,e){this.l.append(t,e)},N.getResponseHeader=function(t){return this.b&&this.b.get(t.toLowerCase())||""},N.getAllResponseHeaders=function(){if(!this.b)return"";for(var t=[],e=this.b.entries(),n=e.next();!n.done;)t.push((n=n.value)[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Or.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(t){this.h=t?"include":"same-origin"}}),br.prototype.createWebChannel=br.prototype.a,wr.prototype.send=wr.prototype.l,wr.prototype.open=wr.prototype.h,wr.prototype.close=wr.prototype.close,Ae.NO_ERROR=0,Ae.TIMEOUT=8,Ae.HTTP_ERROR=6,Ne.COMPLETE="complete",Ce.EventType=je,je.OPEN="a",je.CLOSE="b",je.ERROR="c",je.MESSAGE="d",Wt.prototype.listen=Wt.prototype.wa,Vn.prototype.listenOnce=Vn.prototype.xa,Vn.prototype.getLastError=Vn.prototype.Ra,Vn.prototype.getLastErrorCode=Vn.prototype.va,Vn.prototype.getStatus=Vn.prototype.W,Vn.prototype.getResponseJson=Vn.prototype.Qa,Vn.prototype.getResponseText=Vn.prototype.$,Vn.prototype.send=Vn.prototype.ba;var kr=Ae,Cr=Ne,xr=be,jr=_r,Rr=Ce,Pr=Vn,Lr=n("mrSG"),Mr=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();Mr.o=-1;var Fr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Vr=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(Lr.c)(e,t),e}(Error),Ur=new S.b("@firebase/firestore");function qr(){return Ur.logLevel}function Br(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ur.logLevel<=S.a.DEBUG){var r=e.map(zr);Ur.debug.apply(Ur,Object(Lr.f)(["Firestore (8.6.7): "+t],r))}}function Kr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ur.logLevel<=S.a.ERROR){var r=e.map(zr);Ur.error.apply(Ur,Object(Lr.f)(["Firestore (8.6.7): "+t],r))}}function Gr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ur.logLevel<=S.a.WARN){var r=e.map(zr);Ur.warn.apply(Ur,Object(Lr.f)(["Firestore (8.6.7): "+t],r))}}function zr(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(zd){return t}}function Qr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.6.7) INTERNAL ASSERTION FAILED: "+t;throw Kr(e),new Error(e)}function Hr(t,e){t||Qr()}function Wr(t,e){return t}function Yr(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Xr=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Yr(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function $r(t,e){return t<e?-1:t>e?1:0}function Jr(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function Zr(t){return t+"\0"}var ti=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Vr(Fr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Vr(Fr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Vr(Fr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Vr(Fr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?$r(this.nanoseconds,t.nanoseconds):$r(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),ei=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new ti(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();function ni(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ri(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ii(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var oi=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Qr(),void 0===n?n=t.length-e:n>t.length-e&&Qr(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return this.construct(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),si=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Lr.c)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Vr(Fr.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.emptyPath=function(){return new e([])},e}(oi),ai=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ui=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Lr.c)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return ai.test(t)},e.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Vr(Fr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new Vr(Fr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Vr(Fr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new Vr(Fr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(oi),ci=function(){function t(t){this.fields=t,t.sort(ui.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return Jr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),hi=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.binaryString)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return $r(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();hi.EMPTY_BYTE_STRING=new hi("");var li=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function fi(t){if(Hr(!!t),"string"==typeof t){var e=0,n=li.exec(t);if(Hr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:di(t.seconds),nanos:di(t.nanos)}}function di(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function pi(t){return"string"==typeof t?hi.fromBase64String(t):hi.fromUint8Array(t)}function yi(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function vi(t){var e=t.mapValue.fields.__previous_value__;return yi(e)?vi(e):e}function gi(t){var e=fi(t.mapValue.fields.__local_write_time__.timestampValue);return new ti(e.seconds,e.nanos)}function mi(t){return null==t}function bi(t){return 0===t&&1/t==-1/0}function wi(t){return"number"==typeof t&&Number.isInteger(t)&&!bi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Ii=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(si.fromString(e))},t.fromName=function(e){return new t(si.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===si.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return si.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new si(e.slice()))},t}();function Ei(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?yi(t)?4:10:Qr()}function Ti(t,e){var n=Ei(t);if(n!==Ei(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return gi(t).isEqual(gi(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=fi(t.timestampValue),r=fi(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return pi(t.bytesValue).isEqual(pi(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return di(t.geoPointValue.latitude)===di(e.geoPointValue.latitude)&&di(t.geoPointValue.longitude)===di(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return di(t.integerValue)===di(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=di(t.doubleValue),r=di(e.doubleValue);return n===r?bi(n)===bi(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Jr(t.arrayValue.values||[],e.arrayValue.values||[],Ti);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(ni(n)!==ni(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Ti(n[i],r[i])))return!1;return!0}(t,e);default:return Qr()}}function _i(t,e){return void 0!==(t.values||[]).find(function(t){return Ti(t,e)})}function Oi(t,e){var n=Ei(t),r=Ei(e);if(n!==r)return $r(n,r);switch(n){case 0:return 0;case 1:return $r(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=di(t.integerValue||t.doubleValue),r=di(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Si(t.timestampValue,e.timestampValue);case 4:return Si(gi(t),gi(e));case 5:return $r(t.stringValue,e.stringValue);case 6:return function(t,e){var n=pi(t),r=pi(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=$r(n[i],r[i]);if(0!==o)return o}return $r(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=$r(di(t.latitude),di(e.latitude));return 0!==n?n:$r(di(t.longitude),di(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Oi(n[i],r[i]);if(o)return o}return $r(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=$r(r[s],o[s]);if(0!==a)return a;var u=Oi(n[r[s]],i[o[s]]);if(0!==u)return u}return $r(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Qr()}}function Si(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return $r(t,e);var n=fi(t),r=fi(e),i=$r(n.seconds,r.seconds);return 0!==i?i:$r(n.nanos,r.nanos)}function Di(t){return Ai(t)}function Ai(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=fi(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?pi(t.bytesValue).toBase64():"referenceValue"in t?Ii.fromName(t.referenceValue).toString():"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Ai(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Ai(t.fields[o])}return e+"}"}(t.mapValue):Qr();var e}function Ni(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function ki(t){return!!t&&"integerValue"in t}function Ci(t){return!!t&&"arrayValue"in t}function xi(t){return!!t&&"nullValue"in t}function ji(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ri(t){return!!t&&"mapValue"in t}function Pi(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue)return{timestampValue:Object.assign({},fi(t.timestampValue))};if(t.mapValue){var e={mapValue:{fields:{}}};return ri(t.mapValue.fields,function(t,n){return e.mapValue.fields[t]=Pi(n)}),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Pi(t.arrayValue.values[r]);return n}return Object.assign({},t)}var Li=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!Ri(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Pi(e)},t.prototype.setAll=function(t){var e=this,n=ui.emptyPath(),r={},i=[];t.forEach(function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=Pi(t):i.push(o.lastSegment())});var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());Ri(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return Ti(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];Ri(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){ri(e,function(e,n){return t[e]=n});for(var r=0,i=n;r<i.length;r++)delete t[i[r]]},t.prototype.clone=function(){return new t(Pi(this.value))},t}();function Mi(t){var e=[];return ri(t.fields,function(t,n){var r=new ui([t]);if(Ri(n)){var i=Mi(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)}),new ci(e)}var Fi=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,ei.min(),Li.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,Li.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,Li.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=Li.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=Li.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),Vi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};function Ui(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Vi(t,e,n,r,i,o,s)}function qi(t){var e=Wr(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.canonicalString()+t.op.toString()+Di(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return function(t){return t.field.canonicalString()+t.dir}(t)}).join(","),mi(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=to(e.startAt)),e.endAt&&(n+="|ub:",n+=to(e.endAt)),e.h=n}return e.h}function Bi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!no(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!Ti(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!io(t.startAt,e.startAt)&&io(t.endAt,e.endAt)}function Ki(t){return Ii.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Gi=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(Lr.c)(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new zi(t,n,r):"array-contains"===n?new Yi(t,r):"in"===n?new Xi(t,r):"not-in"===n?new $i(t,r):"array-contains-any"===n?new Ji(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new Qi(t,n):new Hi(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(Oi(e,this.value)):null!==e&&Ei(this.value)===Ei(e)&&this.m(Oi(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Qr()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),zi=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Ii.fromName(r.referenceValue),i}return Object(Lr.c)(e,t),e.prototype.matches=function(t){var e=Ii.comparator(t.key,this.key);return this.m(e)},e}(Gi),Qi=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Wi(0,n),r}return Object(Lr.c)(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(Gi),Hi=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Wi(0,n),r}return Object(Lr.c)(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(Gi);function Wi(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return Ii.fromName(t.referenceValue)})}var Yi=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(Lr.c)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return Ci(e)&&_i(e.arrayValue,this.value)},e}(Gi),Xi=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(Lr.c)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&_i(this.value.arrayValue,e)},e}(Gi),$i=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(Lr.c)(e,t),e.prototype.matches=function(t){if(_i(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!_i(this.value.arrayValue,e)},e}(Gi),Ji=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(Lr.c)(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!Ci(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return _i(e.value.arrayValue,t)})},e}(Gi),Zi=function(t,e){this.position=t,this.before=e};function to(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return Di(t)}).join(",")}var eo=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function no(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function ro(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?Ii.comparator(Ii.fromName(s.referenceValue),n.key):Oi(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function io(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Ti(t.position[n],e.position[n]))return!1;return!0}var oo=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null};function so(t,e,n,r,i,o,s,a){return new oo(t,e,n,r,i,o,s,a)}function ao(t){return new oo(t)}function uo(t){return!mi(t.limit)&&"F"===t.limitType}function co(t){return!mi(t.limit)&&"L"===t.limitType}function ho(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function lo(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function fo(t){return null!==t.collectionGroup}function po(t){var e=Wr(t);if(null===e.p){e.p=[];var n=lo(e),r=ho(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new eo(n)),e.p.push(new eo(ui.keyField(),"asc"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var a=s[o];e.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new eo(ui.keyField(),u))}}}return e.p}function yo(t){var e=Wr(t);if(!e.T)if("F"===e.limitType)e.T=Ui(e.path,e.collectionGroup,po(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=po(e);r<i.length;r++){var o=i[r];n.push(new eo(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new Zi(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Zi(e.startAt.position,!e.startAt.before):null;e.T=Ui(e.path,e.collectionGroup,n,e.filters,e.limit,s,a)}return e.T}function vo(t,e,n){return new oo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function go(t,e){return Bi(yo(t),yo(e))&&t.limitType===e.limitType}function mo(t){return qi(yo(t))+"|lt:"+t.limitType}function bo(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.canonicalString()+" "+e.op+" "+Di(e.value);var e}).join(", ")+"]"),mi(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+to(t.startAt)),t.endAt&&(e+=", endAt: "+to(t.endAt)),"Target("+e+")"}(yo(t))+"; limitType="+t.limitType+")"}function wo(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Ii.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!ro(t.startAt,po(t),e)||t.endAt&&ro(t.endAt,po(t),e))}(t,e)}function Io(t){return function(e,n){for(var r=!1,i=0,o=po(t);i<o.length;i++){var s=o[i],a=Eo(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function Eo(t,e,n){var r=t.field.isKeyField()?Ii.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?Oi(r,i):Qr()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Qr()}}function To(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:bi(e)?"-0":e}}function _o(t){return{integerValue:""+t}}function Oo(t,e){return wi(e)?_o(e):To(t,e)}var So=function(){this._=void 0};function Do(t,e,n){return t instanceof ko?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Co?xo(t,e):t instanceof jo?Ro(t,e):function(t,e){var n=No(t,e),r=Lo(n)+Lo(t.A);return ki(n)&&ki(t.A)?_o(r):To(t.R,r)}(t,e)}function Ao(t,e,n){return t instanceof Co?xo(t,e):t instanceof jo?Ro(t,e):n}function No(t,e){return t instanceof Po?ki(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var ko=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Lr.c)(e,t),e}(So),Co=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(Lr.c)(e,t),e}(So);function xo(t,e){for(var n=Mo(e),r=function(t){n.some(function(e){return Ti(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var jo=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(Lr.c)(e,t),e}(So);function Ro(t,e){for(var n=Mo(e),r=function(t){n=n.filter(function(e){return!Ti(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Po=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return Object(Lr.c)(e,t),e}(So);function Lo(t){return di(t.integerValue||t.doubleValue)}function Mo(t){return Ci(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Fo=function(t,e){this.field=t,this.transform=e},Vo=function(t,e){this.version=t,this.transformResults=e},Uo=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function qo(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var Bo=function(){};function Ko(t,e,n){t instanceof Wo?function(t,e,n){var r=t.value.clone(),i=$o(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof Yo?function(t,e,n){if(qo(t.precondition,e)){var r=$o(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(Xo(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Go(t,e,n){t instanceof Wo?function(t,e,n){if(qo(t.precondition,e)){var r=t.value.clone(),i=Jo(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(Ho(e),r).setHasLocalMutations()}}(t,e,n):t instanceof Yo?function(t,e,n){if(qo(t.precondition,e)){var r=Jo(t.fieldTransforms,n,e),i=e.data;i.setAll(Xo(t)),i.setAll(r),e.convertToFoundDocument(Ho(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){qo(t.precondition,e)&&e.convertToNoDocument(ei.min())}(t,e)}function zo(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=No(o.transform,s||null);null!=a&&(null==n&&(n=Li.empty()),n.set(o.field,a))}return n||null}function Qo(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Jr(t,e,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Co&&e instanceof Co||t instanceof jo&&e instanceof jo?Jr(t.elements,e.elements,Ti):t instanceof Po&&e instanceof Po?Ti(t.A,e.A):t instanceof ko&&e instanceof ko}(t.transform,e.transform)}(t,e)})}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Ho(t){return t.isFoundDocument()?t.version:ei.min()}var Wo=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return Object(Lr.c)(e,t),e}(Bo),Yo=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return Object(Lr.c)(e,t),e}(Bo);function Xo(t){var e=new Map;return t.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}}),e}function $o(t,e,n){var r=new Map;Hr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,Ao(s,a,n[i]))}return r}function Jo(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=n.data.field(s.field);r.set(s.field,Do(a,u,e))}return r}var Zo,ts,es=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return Object(Lr.c)(e,t),e}(Bo),ns=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return Object(Lr.c)(e,t),e}(Bo),rs=function(t){this.count=t};function is(t){switch(t){case Fr.OK:return Qr();case Fr.CANCELLED:case Fr.UNKNOWN:case Fr.DEADLINE_EXCEEDED:case Fr.RESOURCE_EXHAUSTED:case Fr.INTERNAL:case Fr.UNAVAILABLE:case Fr.UNAUTHENTICATED:return!1;case Fr.INVALID_ARGUMENT:case Fr.NOT_FOUND:case Fr.ALREADY_EXISTS:case Fr.PERMISSION_DENIED:case Fr.FAILED_PRECONDITION:case Fr.ABORTED:case Fr.OUT_OF_RANGE:case Fr.UNIMPLEMENTED:case Fr.DATA_LOSS:return!0;default:return Qr()}}function os(t){if(void 0===t)return Kr("GRPC error has no .code"),Fr.UNKNOWN;switch(t){case Zo.OK:return Fr.OK;case Zo.CANCELLED:return Fr.CANCELLED;case Zo.UNKNOWN:return Fr.UNKNOWN;case Zo.DEADLINE_EXCEEDED:return Fr.DEADLINE_EXCEEDED;case Zo.RESOURCE_EXHAUSTED:return Fr.RESOURCE_EXHAUSTED;case Zo.INTERNAL:return Fr.INTERNAL;case Zo.UNAVAILABLE:return Fr.UNAVAILABLE;case Zo.UNAUTHENTICATED:return Fr.UNAUTHENTICATED;case Zo.INVALID_ARGUMENT:return Fr.INVALID_ARGUMENT;case Zo.NOT_FOUND:return Fr.NOT_FOUND;case Zo.ALREADY_EXISTS:return Fr.ALREADY_EXISTS;case Zo.PERMISSION_DENIED:return Fr.PERMISSION_DENIED;case Zo.FAILED_PRECONDITION:return Fr.FAILED_PRECONDITION;case Zo.ABORTED:return Fr.ABORTED;case Zo.OUT_OF_RANGE:return Fr.OUT_OF_RANGE;case Zo.UNIMPLEMENTED:return Fr.UNIMPLEMENTED;case Zo.DATA_LOSS:return Fr.DATA_LOSS;default:return Qr()}}(ts=Zo||(Zo={}))[ts.OK=0]="OK",ts[ts.CANCELLED=1]="CANCELLED",ts[ts.UNKNOWN=2]="UNKNOWN",ts[ts.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ts[ts.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ts[ts.NOT_FOUND=5]="NOT_FOUND",ts[ts.ALREADY_EXISTS=6]="ALREADY_EXISTS",ts[ts.PERMISSION_DENIED=7]="PERMISSION_DENIED",ts[ts.UNAUTHENTICATED=16]="UNAUTHENTICATED",ts[ts.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ts[ts.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ts[ts.ABORTED=10]="ABORTED",ts[ts.OUT_OF_RANGE=11]="OUT_OF_RANGE",ts[ts.UNIMPLEMENTED=12]="UNIMPLEMENTED",ts[ts.INTERNAL=13]="INTERNAL",ts[ts.UNAVAILABLE=14]="UNAVAILABLE",ts[ts.DATA_LOSS=15]="DATA_LOSS";var ss=function(){function t(t,e){this.comparator=t,this.root=e||us.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,us.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,us.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.inorderTraversal(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new as(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new as(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new as(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new as(this.root,t,this.comparator,!0)},t}(),as=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),us=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Qr();if(this.right.isRed())throw Qr();var t=this.left.check();if(t!==this.right.check())throw Qr();return t+(this.isRed()?0:1)},t}();us.EMPTY=null,us.RED=!0,us.BLACK=!1,us.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Qr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Qr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Qr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Qr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Qr()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new us(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());var cs=function(){function t(t){this.comparator=t,this.data=new ss(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new hs(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new hs(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),hs=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),ls=new ss(Ii.comparator);function fs(){return ls}var ds=new ss(Ii.comparator);function ps(){return ds}var ys=new ss(Ii.comparator);function vs(){return ys}var gs=new cs(Ii.comparator);function ms(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=gs,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var bs=new cs($r);function ws(){return bs}var Is=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,Es.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(ei.min(),r,ws(),fs(),ms())},t}(),Es=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(hi.EMPTY_BYTE_STRING,n,ms(),ms(),ms())},t}(),Ts=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},_s=function(t,e){this.targetId=t,this.V=e},Os=function(t,e,n,r){void 0===n&&(n=hi.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Ss=function(){function t(){this.S=0,this.D=Ns(),this.C=hi.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=ms(),e=ms(),n=ms();return this.D.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Qr()}}),new Es(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=Ns()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),Ds=function(){function t(t){this.W=t,this.G=new Map,this.H=fs(),this.J=As(),this.Y=new cs($r)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.tt(r=o[i],t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:Qr()}})},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach(function(t,r){n.st(r)&&e(r)})},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(Ki(i))if(0===n){var o=new Ii(i.path);this.tt(e,o,Fi.newNoDocument(o,ei.min()))}else Hr(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach(function(r,i){var o=e.ot(i);if(o){if(r.current&&Ki(o.target)){var s=new Ii(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,Fi.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}});var r=ms();this.J.forEach(function(t,n){var i=!0;n.forEachWhile(function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(t))});var i=new Is(t,n,this.Y,this.H,r);return this.H=fs(),this.J=As(),this.Y=new cs($r),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new Ss,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new cs($r),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||Br("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new Ss),this.W.getRemoteKeysForTarget(t).forEach(function(n){e.tt(t,n,null)})},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function As(){return new ss(Ii.comparator)}function Ns(){return new ss(Ii.comparator)}var ks={asc:"ASCENDING",desc:"DESCENDING"},Cs={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},xs=function(t,e){this.databaseId=t,this.I=e};function js(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Rs(t,e){return t.I?e.toBase64():e.toUint8Array()}function Ps(t,e){return js(t,e.toTimestamp())}function Ls(t){return Hr(!!t),ei.fromTimestamp(function(t){var e=fi(t);return new ti(e.seconds,e.nanos)}(t))}function Ms(t,e){return function(t){return new si(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Fs(t){var e=si.fromString(t);return Hr(ua(e)),e}function Vs(t,e){return Ms(t.databaseId,e.path)}function Us(t,e){var n=Fs(e);if(n.get(1)!==t.databaseId.projectId)throw new Vr(Fr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Vr(Fr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ii(Gs(n))}function qs(t,e){return Ms(t.databaseId,e)}function Bs(t){var e=Fs(t);return 4===e.length?si.emptyPath():Gs(e)}function Ks(t){return new si(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Gs(t){return Hr(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function zs(t,e,n){return{name:Vs(t,e),fields:n.value.mapValue.fields}}function Qs(t,e,n){var r=Us(t,e.name),i=Ls(e.updateTime),o=new Li({mapValue:{fields:e.fields}}),s=Fi.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}function Hs(t,e){var n;if(e instanceof Wo)n={update:zs(t,e.key,e.value)};else if(e instanceof es)n={delete:Vs(t,e.key)};else if(e instanceof Yo)n={update:zs(t,e.key,e.data),updateMask:aa(e.fieldMask)};else{if(!(e instanceof ns))return Qr();n={verify:Vs(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof ko)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Co)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof jo)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Po)return{fieldPath:e.field.canonicalString(),increment:n.A};throw Qr()}(0,t)})),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Ps(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Qr()}(t,e.precondition)),n}function Ws(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Uo.updateTime(Ls(t.updateTime)):void 0!==t.exists?Uo.exists(t.exists):Uo.none()}(e.currentDocument):Uo.none(),r=e.updateTransforms?e.updateTransforms.map(function(e){return function(t,e){var n=null;"setToServerValue"in e?(Hr("REQUEST_TIME"===e.setToServerValue),n=new ko):"appendMissingElements"in e?n=new Co(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new jo(e.removeAllFromArray.values||[]):"increment"in e?n=new Po(t,e.increment):Qr();var r=ui.fromServerFormat(e.fieldPath);return new Fo(r,n)}(t,e)}):[];if(e.update){var i=Us(t,e.update.name),o=new Li({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){return new ci((t.fieldPaths||[]).map(function(t){return ui.fromServerFormat(t)}))}(e.updateMask);return new Yo(i,o,s,n,r)}return new Wo(i,o,n,r)}if(e.delete){var a=Us(t,e.delete);return new es(a,n)}if(e.verify){var u=Us(t,e.verify);return new ns(u,n)}return Qr()}function Ys(t,e){return{documents:[qs(t,e.path)]}}function Xs(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=qs(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=qs(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(ji(t.value))return{unaryFilter:{field:ra(t.field),op:"IS_NAN"}};if(xi(t.value))return{unaryFilter:{field:ra(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(ji(t.value))return{unaryFilter:{field:ra(t.field),op:"IS_NOT_NAN"}};if(xi(t.value))return{unaryFilter:{field:ra(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ra(t.field),op:na(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:ra(t.field),direction:ea(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.I||mi(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=Zs(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Zs(e.endAt)),n}function $s(t){var e=Bs(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Hr(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=Js(n.where));var a=[];n.orderBy&&(a=n.orderBy.map(function(t){return function(t){return new eo(ia(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var u=null;n.limit&&(u=function(t){var e;return mi(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=ta(n.startAt));var h=null;return n.endAt&&(h=ta(n.endAt)),so(e,i,a,s,u,"F",c,h)}function Js(t){return t?void 0!==t.unaryFilter?[sa(t)]:void 0!==t.fieldFilter?[oa(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return Js(t)}).reduce(function(t,e){return t.concat(e)}):Qr():[]}function Zs(t){return{before:t.before,values:t.position}}function ta(t){return new Zi(t.values||[],!!t.before)}function ea(t){return ks[t]}function na(t){return Cs[t]}function ra(t){return{fieldPath:t.canonicalString()}}function ia(t){return ui.fromServerFormat(t.fieldPath)}function oa(t){return Gi.create(ia(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Qr()}}(t.fieldFilter.op),t.fieldFilter.value)}function sa(t){switch(t.unaryFilter.op){case"IS_NAN":var e=ia(t.unaryFilter.field);return Gi.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=ia(t.unaryFilter.field);return Gi.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=ia(t.unaryFilter.field);return Gi.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=ia(t.unaryFilter.field);return Gi.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Qr()}}function aa(t){var e=[];return t.fields.forEach(function(t){return e.push(t.canonicalString())}),{fieldPaths:e}}function ua(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function ca(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=la(e)),e=ha(t.get(n),e);return la(e)}function ha(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function la(t){return t+"\x01\x01"}function fa(t){var e=t.length;if(Hr(e>=2),2===e)return Hr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),si.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&Qr(),t.charAt(s+1)){case"\x01":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Qr()}o=s+2}return new si(r)}var da=function(t,e){this.seconds=t,this.nanoseconds=e},pa=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};pa.store="owner",pa.key="owner";var ya=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};ya.store="mutationQueues",ya.keyPath="userId";var va=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};va.store="mutations",va.keyPath="batchId",va.userMutationsIndex="userMutationsIndex",va.userMutationsKeyPath=["userId","batchId"];var ga=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,ca(e)]},t.key=function(t,e,n){return[t,ca(e),n]},t}();ga.store="documentMutations",ga.PLACEHOLDER=new ga;var ma=function(t,e){this.path=t,this.readTime=e},ba=function(t,e){this.path=t,this.version=e},wa=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};wa.store="remoteDocuments",wa.readTimeIndex="readTimeIndex",wa.readTimeIndexPath="readTime",wa.collectionReadTimeIndex="collectionReadTimeIndex",wa.collectionReadTimeIndexPath=["parentPath","readTime"];var Ia=function(t){this.byteSize=t};Ia.store="remoteDocumentGlobal",Ia.key="remoteDocumentGlobalKey";var Ea=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Ea.store="targets",Ea.keyPath="targetId",Ea.queryTargetsIndexName="queryTargetsIndex",Ea.queryTargetsKeyPath=["canonicalId","targetId"];var Ta=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ta.store="targetDocuments",Ta.keyPath=["targetId","path"],Ta.documentTargetsIndex="documentTargetsIndex",Ta.documentTargetsKeyPath=["path","targetId"];var _a=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};_a.key="targetGlobalKey",_a.store="targetGlobal";var Oa=function(t,e){this.collectionId=t,this.parent=e};Oa.store="collectionParents",Oa.keyPath=["collectionId","parent"];var Sa=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Sa.store="clientMetadata",Sa.keyPath="clientId";var Da=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Da.store="bundles",Da.keyPath="bundleId";var Aa=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Aa.store="namedQueries",Aa.keyPath="name";var Na=Object(Lr.f)(Object(Lr.f)([],Object(Lr.f)(Object(Lr.f)([],Object(Lr.f)(Object(Lr.f)([],Object(Lr.f)(Object(Lr.f)([],[ya.store,va.store,ga.store,wa.store,Ea.store,pa.store,_a.store,Ta.store]),[Sa.store])),[Ia.store])),[Oa.store])),[Da.store,Aa.store]),ka="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ca=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach(function(t){return t()})},t}(),xa=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},ja=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&Qr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}})},t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.waitFor=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.waitFor(r)},t}(),Ra=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new xa,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new Ma(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=Ba(e.target.error);n.ft.reject(new Ma(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Ma(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(Br("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Va(e)},t}(),Pa=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(Object(O.i)())&&Kr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Br("SimpleDb","Removing database:",t),Ua(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=Object(O.i)(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return Object(Lr.b)(this,void 0,void 0,function(){var e,n=this;return Object(Lr.d)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(Br("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new Ma(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new Vr(Fr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new Ma(t,n))},i.onupgradeneeded=function(t){Br("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.wt.Rt(t.target.result,i.transaction,t.oldVersion,n.version).next(function(){Br("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}})})},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(Lr.b)(this,void 0,void 0,function(){var i,o,s,a,u;return Object(Lr.d)(this,function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,h;return Object(Lr.d)(this,function(l){switch(l.label){case 0:++o,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,a.At(t)];case 2:return a.db=l.sent(),e=Ra.open(a.db,t,i?"readonly":"readwrite",n),s=r(e).catch(function(t){return e.abort(t),ja.reject(t)}).toPromise(),u={},s.catch(function(){}),[4,e.dt];case 3:return[2,(u.value=(l.sent(),s),u)];case 4:return Br("SimpleDb","Transaction failed with error:",(c=l.sent()).message,"Retrying:",h="FirebaseError"!==c.name&&o<3),a.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),La=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return Ua(this.Pt.delete())},t}(),Ma=function(t){function e(e,n){var r=this;return(r=t.call(this,Fr.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(Lr.c)(e,t),e}(Vr);function Fa(t){return"IndexedDbTransactionError"===t.name}var Va=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Br("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Br("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Ua(n)},t.prototype.add=function(t){return Br("SimpleDb","ADD",this.store.name,t,t),Ua(this.store.add(t))},t.prototype.get=function(t){var e=this;return Ua(this.store.get(t)).next(function(n){return void 0===n&&(n=null),Br("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return Br("SimpleDb","DELETE",this.store.name,t),Ua(this.store.delete(t))},t.prototype.count=function(){return Br("SimpleDb","COUNT",this.store.name),Ua(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.Ft=function(t,e){Br("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,function(t,e,n){return n.delete()})},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new ja(function(n,r){e.onerror=function(t){var e=Ba(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.xt=function(t,e){var n=[];return new ja(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new La(i),s=e(i.primaryKey,i.value,o);if(s instanceof ja){var a=s.catch(function(t){return o.done(),ja.reject(t)});n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}}).next(function(){return ja.waitFor(n)})},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Ua(t){return new ja(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=Ba(t.target.error);n(e)}})}var qa=!1;function Ba(t){var e=Pa._t(Object(O.i)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Vr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return qa||(qa=!0,setTimeout(function(){throw r},0)),r}}return t}var Ka=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return Object(Lr.c)(e,t),e}(Ca);function Ga(t,e){var n=Wr(t);return Pa.It(n.Mt,e)}var za=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&Ko(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&Go(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&Go(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach(function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(ei.min())})},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},ms())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Jr(this.mutations,t.mutations,function(t,e){return Qo(t,e)})&&Jr(this.baseMutations,t.baseMutations,function(t,e){return Qo(t,e)})},t}(),Qa=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){Hr(e.mutations.length===r.length);for(var i=vs(),o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Ha=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=ei.min()),void 0===o&&(o=ei.min()),void 0===s&&(s=hi.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),Wa=function(t){this.Lt=t};function Ya(t,e){if(e.document)return Qs(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Ii.fromSegments(e.noDocument.path),r=tu(e.noDocument.readTime),i=Fi.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=Ii.fromSegments(e.unknownDocument.path);return r=tu(e.unknownDocument.version),Fi.newUnknownDocument(o,r)}return Qr()}function Xa(t,e,n){var r=$a(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:Vs(t,e.key),fields:e.data.value.mapValue.fields,updateTime:js(t,e.version.toTimestamp())}}(t.Lt,e),s=e.hasCommittedMutations;return new wa(null,null,o,s,r,i)}if(e.isNoDocument()){var a=e.key.path.toArray(),u=Za(e.version);return s=e.hasCommittedMutations,new wa(null,new ma(a,u),null,s,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),h=Za(e.version);return new wa(new ba(c,h),null,null,!0,r,i)}return Qr()}function $a(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Ja(t){var e=new ti(t[0],t[1]);return ei.fromTimestamp(e)}function Za(t){var e=t.toTimestamp();return new da(e.seconds,e.nanoseconds)}function tu(t){var e=new ti(t.seconds,t.nanoseconds);return ei.fromTimestamp(e)}function eu(t,e){for(var n=(e.baseMutations||[]).map(function(e){return Ws(t.Lt,e)}),r=0;r<e.mutations.length-1;++r)r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform&&(e.mutations[r].updateTransforms=e.mutations[r+1].transform.fieldTransforms,e.mutations.splice(r+1,1),++r);var i=e.mutations.map(function(e){return Ws(t.Lt,e)}),o=ti.fromMillis(e.localWriteTimeMs);return new za(e.batchId,o,n,i)}function nu(t){var e,n,r=tu(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?tu(t.lastLimboFreeSnapshotVersion):ei.min();return void 0!==t.query.documents?(Hr(1===(n=t.query).documents.length),e=yo(ao(Bs(n.documents[0])))):e=function(t){return yo($s(t))}(t.query),new Ha(e,t.targetId,0,t.lastListenSequenceNumber,r,i,hi.fromBase64String(t.resumeToken))}function ru(t,e){var n,r=Za(e.snapshotVersion),i=Za(e.lastLimboFreeSnapshotVersion);n=Ki(e.target)?Ys(t.Lt,e.target):Xs(t.Lt,e.target);var o=e.resumeToken.toBase64();return new Ea(e.targetId,qi(e.target),r,o,e.sequenceNumber,i,n)}function iu(t){var e=$s({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?vo(e,e.limit,"L"):e}var ou=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return su(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:tu(e.createTime),version:e.version};var e})},t.prototype.saveBundleMetadata=function(t,e){return su(t).put({bundleId:(n=e).id,createTime:Za(Ls(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return au(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:iu(e.bundledQuery),readTime:tu(e.readTime)};var e})},t.prototype.saveNamedQuery=function(t,e){return au(t).put(function(t){return{name:t.name,readTime:Za(Ls(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function su(t){return Ga(t,Da.store)}function au(t){return Ga(t,Aa.store)}var uu=function(){function t(){this.Bt=new cu}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),ja.resolve()},t.prototype.getCollectionParents=function(t,e){return ja.resolve(this.Bt.getEntries(e))},t}(),cu=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new cs(si.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new cs(si.comparator)).toArray()},t}(),hu=function(){function t(){this.qt=new cu}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener(function(){n.qt.add(e)});var o={collectionId:r,parent:ca(i)};return lu(t).put(o)}return ja.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Zr(e),""],!1,!0);return lu(t).Nt(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(fa(o.parent))}return n})},t}();function lu(t){return Ga(t,Oa.store)}var fu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},du=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();function pu(t,e,n){var r=t.store(va.store),i=t.store(ga.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},function(t,e,n){return a++,n.delete()});o.push(u.next(function(){Hr(1===a)}));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],d=ga.key(e,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return ja.waitFor(o).next(function(){return c})}function yu(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Qr();e=t.noDocument}return JSON.stringify(e).length}du.DEFAULT_COLLECTION_PERCENTILE=10,du.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,du.DEFAULT=new du(41943040,du.DEFAULT_COLLECTION_PERCENTILE,du.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),du.DISABLED=new du(-1,0,0);var vu=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Qt={}}return t.Kt=function(e,n,r,i){return Hr(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return mu(t).$t({index:va.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=bu(t),s=mu(t);return s.add({}).next(function(a){Hr("number"==typeof a);for(var u=new za(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return Hs(t.Lt,e)}),i=n.mutations.map(function(e){return Hs(t.Lt,e)});return new va(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),h=[],l=new cs(function(t,e){return $r(t.canonicalString(),e.canonicalString())}),f=0,d=r;f<d.length;f++){var p=d[f],y=ga.key(i.userId,p.key.path,a);l=l.add(p.key.path.popLast()),h.push(s.put(c)),h.push(o.put(y,ga.PLACEHOLDER))}return l.forEach(function(e){h.push(i.Ut.addToCollectionParentIndex(t,e))}),t.addOnCommittedListener(function(){i.Qt[a]=u.keys()}),ja.waitFor(h).next(function(){return u})})},t.prototype.lookupMutationBatch=function(t,e){var n=this;return mu(t).get(e).next(function(t){return t?(Hr(t.userId===n.userId),eu(n.R,t)):null})},t.prototype.jt=function(t,e){var n=this;return this.Qt[e]?ja.resolve(this.Qt[e]):this.lookupMutationBatch(t,e).next(function(t){if(t){var r=t.keys();return n.Qt[e]=r,r}return null})},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return mu(t).$t({index:va.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(Hr(e.batchId>=r),o=eu(n.R,e)),i.done()}).next(function(){return o})},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return mu(t).$t({index:va.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return mu(t).Nt(va.userMutationsIndex,n).next(function(t){return t.map(function(t){return eu(e.R,t)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=ga.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return bu(t).$t({range:i},function(r,i,s){var a=r[0],u=r[2],c=fa(r[1]);if(a===n.userId&&e.path.isEqual(c))return mu(t).get(u).next(function(t){if(!t)throw Qr();Hr(t.userId===n.userId),o.push(eu(n.R,t))});s.done()}).next(function(){return o})},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new cs($r),i=[];return e.forEach(function(e){var o=ga.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=bu(t).$t({range:s},function(t,i,o){var s=t[0],a=t[2],u=fa(t[1]);s===n.userId&&e.path.isEqual(u)?r=r.add(a):o.done()});i.push(a)}),ja.waitFor(i).next(function(){return n.Wt(t,r)})},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=ga.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new cs($r);return bu(t).$t({range:s},function(t,e,o){var s=t[0],u=t[2],c=fa(t[1]);s===n.userId&&r.isPrefixOf(c)?c.length===i&&(a=a.add(u)):o.done()}).next(function(){return n.Wt(t,a)})},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(mu(t).get(e).next(function(t){if(null===t)throw Qr();Hr(t.userId===n.userId),r.push(eu(n.R,t))}))}),ja.waitFor(i).next(function(){return r})},t.prototype.removeMutationBatch=function(t,e){var n=this;return pu(t.Mt,this.userId,e).next(function(r){return t.addOnCommittedListener(function(){n.Gt(e.batchId)}),ja.forEach(r,function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)})})},t.prototype.Gt=function(t){delete this.Qt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next(function(n){if(!n)return ja.resolve();var r=IDBKeyRange.lowerBound(ga.prefixForUser(e.userId)),i=[];return bu(t).$t({range:r},function(t,n,r){if(t[0]===e.userId){var o=fa(t[1]);i.push(o)}else r.done()}).next(function(){Hr(0===i.length)})})},t.prototype.containsKey=function(t,e){return gu(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return wu(t).get(this.userId).next(function(t){return t||new ya(e.userId,-1,"")})},t}();function gu(t,e,n){var r=ga.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return bu(t).$t({range:o,kt:!0},function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()}).next(function(){return s})}function mu(t){return Ga(t,va.store)}function bu(t){return Ga(t,ga.store)}function wu(t){return Ga(t,ya.store)}var Iu=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),Eu=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next(function(n){var r=new Iu(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next(function(){return n.highestTargetId})})},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next(function(t){return ei.fromTimestamp(new ti(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)})},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next(function(){return n.Xt(t).next(function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)})})},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){return Tu(t).delete(e.targetId)}).next(function(){return n.Xt(t)}).next(function(e){return Hr(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)})},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Tu(t).$t(function(s,a){var u=nu(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))}).next(function(){return ja.waitFor(o)}).next(function(){return i})},t.prototype.forEachTarget=function(t,e){return Tu(t).$t(function(t,n){var r=nu(n);e(r)})},t.prototype.Xt=function(t){return _u(t).get(_a.key).next(function(t){return Hr(null!==t),t})},t.prototype.Zt=function(t,e){return _u(t).put(_a.key,e)},t.prototype.te=function(t,e){return Tu(t).put(ru(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next(function(t){return t.targetCount})},t.prototype.getTargetData=function(t,e){var n=qi(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Tu(t).$t({range:r,index:Ea.queryTargetsIndexName},function(t,n,r){var o=nu(n);Bi(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Ou(t);return e.forEach(function(e){var s=ca(e.path);i.push(o.put(new Ta(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))}),ja.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Ou(t);return ja.forEach(e,function(e){var o=ca(e.path);return ja.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])})},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Ou(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Ou(t),i=ms();return r.$t({range:n,kt:!0},function(t,e,n){var r=fa(t[1]),o=new Ii(r);i=i.add(o)}).next(function(){return i})},t.prototype.containsKey=function(t,e){var n=ca(e.path),r=IDBKeyRange.bound([n],[Zr(n)],!1,!0),i=0;return Ou(t).$t({index:Ta.documentTargetsIndex,kt:!0,range:r},function(t,e,n){0!==t[0]&&(i++,n.done())}).next(function(){return i>0})},t.prototype.lt=function(t,e){return Tu(t).get(e).next(function(t){return t?nu(t):null})},t}();function Tu(t){return Ga(t,Ea.store)}function _u(t){return Ga(t,_a.store)}function Ou(t){return Ga(t,Ta.store)}function Su(t){return Object(Lr.b)(this,void 0,void 0,function(){return Object(Lr.d)(this,function(e){if(t.code!==Fr.FAILED_PRECONDITION||t.message!==ka)throw t;return Br("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Du(t,e){var n=t[1],r=e[1],i=$r(t[0],e[0]);return 0===i?$r(n,r):i}var Au=function(){function t(t){this.ne=t,this.buffer=new cs(Du),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Du(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Nu=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;Br("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,function(){return Object(Lr.b)(e,void 0,void 0,function(){var e;return Object(Lr.d)(this,function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return Fa(e=n.sent())?(Br("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Su(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}})})})},t}(),ku=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return ja.resolve(Mr.o);var r=new Au(e);return this.ae.forEachTarget(t,function(t){return r.re(t.sequenceNumber)}).next(function(){return n.ae.le(t,function(t){return r.re(t)})}).next(function(){return r.maxValue})},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Br("LruGarbageCollector","Garbage collection skipped; disabled"),ja.resolve(fu)):this.getCacheSize(t).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(Br("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),fu):n.fe(t,e)})},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,a,u,c=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(function(e){return e>c.params.maximumSequenceNumbersToCollect?(Br("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)}).next(function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)}).next(function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)}).next(function(t){return u=Date.now(),qr()<=S.a.DEBUG&&Br("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-h)+"ms"),ja.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})})},t}(),Cu=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new ku(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.de=function(t){var e=0;return this.le(t,function(t){e++}).next(function(){return e})},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,function(t,n){return e(n)})},t.prototype.addReference=function(t,e,n){return xu(t,n)},t.prototype.removeReference=function(t,e,n){return xu(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return xu(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return wu(t).Ot(function(r){return gu(t,r,e).next(function(t){return t&&(n=!0),ja.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,function(s,a){if(a<=e){var u=n._e(t,s).next(function(e){if(!e)return o++,r.getEntry(t,s).next(function(){return r.removeEntry(s),Ou(t).delete([0,ca(s.path)])})});i.push(u)}}).next(function(){return ja.waitFor(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return xu(t,e)},t.prototype.we=function(t,e){var n,r=Ou(t),i=Mr.o;return r.$t({index:Ta.documentTargetsIndex},function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==Mr.o&&e(new Ii(fa(n)),i),i=s,n=o):i=Mr.o}).next(function(){i!==Mr.o&&e(new Ii(fa(n)),i)})},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function xu(t,e){return Ou(t).put(function(t,e){return new Ta(0,ca(t.path),e)}(e,t.currentSequenceNumber))}var ju=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.equalsFn(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){ri(this.inner,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}})},t.prototype.isEmpty=function(){return ii(this.inner)},t}(),Ru=function(){function t(){this.changes=new ju(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:ei.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:Fi.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?ja.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),Pu=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return Fu(t).put(Vu(e),n)},t.prototype.removeEntry=function(t,e){var n=Fu(t),r=Vu(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.me(t,r)})},t.prototype.getEntry=function(t,e){var n=this;return Fu(t).get(Vu(e)).next(function(t){return n.ye(e,t)})},t.prototype.ge=function(t,e){var n=this;return Fu(t).get(Vu(e)).next(function(t){return{document:n.ye(e,t),size:yu(t)}})},t.prototype.getEntries=function(t,e){var n=this,r=fs();return this.pe(t,e,function(t,e){var i=n.ye(t,e);r=r.insert(t,i)}).next(function(){return r})},t.prototype.Ee=function(t,e){var n=this,r=fs(),i=new ss(Ii.comparator);return this.pe(t,e,function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,yu(e))}).next(function(){return{documents:r,Te:i}})},t.prototype.pe=function(t,e,n){if(e.isEmpty())return ja.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return Fu(t).$t({range:r},function(t,e,r){for(var s=Ii.fromSegments(t);o&&Ii.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()}).next(function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null})},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=fs(),o=e.path.length+1,s={};if(n.isEqual(ei.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=$a(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=wa.collectionReadTimeIndex}return Fu(t).$t(s,function(t,n,s){if(t.length===o){var a=Ya(r.R,n);e.path.isPrefixOf(a.key.path)?wo(e,a)&&(i=i.insert(a.key,a)):s.done()}}).next(function(){return i})},t.prototype.newChangeBuffer=function(t){return new Lu(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Mu(t).get(Ia.key).next(function(t){return Hr(!!t),t})},t.prototype.me=function(t,e){return Mu(t).put(Ia.key,e)},t.prototype.ye=function(t,e){if(e){var n=Ya(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(ei.min()))return n}return Fi.newInvalidDocument(t)},t}(),Lu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new ju(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return Object(Lr.c)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new cs(function(t,e){return $r(t.canonicalString(),e.canonicalString())});return this.changes.forEach(function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=Xa(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=yu(u);r+=c-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var h=Xa(e.Ie.R,Fi.newNoDocument(o,ei.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,h))}else n.push(e.Ie.removeEntry(t,o))}),i.forEach(function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))}),n.push(this.Ie.updateMetadata(t,r)),ja.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next(function(t){return n.Ae.set(e,t.size),t.document})},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next(function(t){var e=t.documents;return t.Te.forEach(function(t,e){n.Ae.set(t,e)}),e})},e}(Ru);function Mu(t){return Ga(t,Ia.store)}function Fu(t){return Ga(t,wa.store)}function Vu(t){return t.path.toArray()}var Uu=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;Hr(n<r&&n>=0&&r<=11);var o=new Ra("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(pa.store)}(t),function(t){t.createObjectStore(ya.store,{keyPath:ya.keyPath}),t.createObjectStore(va.store,{keyPath:va.keyPath,autoIncrement:!0}).createIndex(va.userMutationsIndex,va.userMutationsKeyPath,{unique:!0}),t.createObjectStore(ga.store)}(t),qu(t),function(t){t.createObjectStore(wa.store)}(t));var s=ja.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Ta.store),t.deleteObjectStore(Ea.store),t.deleteObjectStore(_a.store)}(t),qu(t)),s=s.next(function(){return function(t){var e=t.store(_a.store),n=new _a(0,0,ei.min().toTimestamp(),0);return e.put(_a.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(va.store).Nt().next(function(n){t.deleteObjectStore(va.store),t.createObjectStore(va.store,{keyPath:va.keyPath,autoIncrement:!0}).createIndex(va.userMutationsIndex,va.userMutationsKeyPath,{unique:!0});var r=e.store(va.store),i=n.map(function(t){return r.put(t)});return ja.waitFor(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(Sa.store,{keyPath:Sa.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.Re(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(Ia.store)}(t),i.be(o)})),n<7&&r>=7&&(s=s.next(function(){return i.ve(o)})),n<8&&r>=8&&(s=s.next(function(){return i.Pe(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(wa.store);e.createIndex(wa.readTimeIndex,wa.readTimeIndexPath,{unique:!1}),e.createIndex(wa.collectionReadTimeIndex,wa.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.Ve(o)})),n<11&&r>=11&&(s=s.next(function(){!function(t){t.createObjectStore(Da.store,{keyPath:Da.keyPath})}(t),function(t){t.createObjectStore(Aa.store,{keyPath:Aa.keyPath})}(t)})),s},t.prototype.be=function(t){var e=0;return t.store(wa.store).$t(function(t,n){e+=yu(n)}).next(function(){var n=new Ia(e);return t.store(Ia.store).put(Ia.key,n)})},t.prototype.Re=function(t){var e=this,n=t.store(ya.store),r=t.store(va.store);return n.Nt().next(function(n){return ja.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(va.userMutationsIndex,i).next(function(r){return ja.forEach(r,function(r){Hr(r.userId===n.userId);var i=eu(e.R,r);return pu(t,n.userId,i).next(function(){})})})})})},t.prototype.ve=function(t){var e=t.store(Ta.store),n=t.store(wa.store);return t.store(_a.store).get(_a.key).next(function(t){var r=[];return n.$t(function(n,i){var o=new si(n),s=function(t){return[0,ca(t)]}(o);r.push(e.get(s).next(function(n){return n?ja.resolve():function(n){return e.put(new Ta(0,ca(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return ja.waitFor(r)})})},t.prototype.Pe=function(t,e){t.createObjectStore(Oa.store,{keyPath:Oa.keyPath});var n=e.store(Oa.store),r=new cu,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:ca(i)})}};return e.store(wa.store).$t({kt:!0},function(t,e){var n=new si(t);return i(n.popLast())}).next(function(){return e.store(ga.store).$t({kt:!0},function(t,e){var n=fa(t[1]);return i(n.popLast())})})},t.prototype.Ve=function(t){var e=this,n=t.store(Ea.store);return n.$t(function(t,r){var i=nu(r),o=ru(e.R,i);return n.put(o)})},t}();function qu(t){t.createObjectStore(Ta.store,{keyPath:Ta.keyPath}).createIndex(Ta.documentTargetsIndex,Ta.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ea.store,{keyPath:Ea.keyPath}).createIndex(Ea.queryTargetsIndexName,Ea.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(_a.store)}var Bu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Ku=function(){function t(e,n,r,i,o,s,a,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=c,this.Ce=h,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new Vr(Fr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Cu(this,i),this.Le=n+"main",this.R=new Wa(u),this.Be=new Pa(this.Le,11,new Uu(this.R)),this.qe=new Eu(this.referenceDelegate,this.R),this.Ut=new hu,this.Ue=function(t,e){return new Pu(t,e)}(this.R,this.Ut),this.Qe=new ou,this.window&&this.window.localStorage?this.Ke=this.window.localStorage:(this.Ke=null,!1===h&&Kr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Vr(Fr.FAILED_PRECONDITION,Bu);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.qe.getHighestSequenceNumber(e)})}).then(function(e){t.Ne=new Mr(e,t.De)}).then(function(){t.xe=!0}).catch(function(e){return t.Be&&t.Be.close(),Promise.reject(e)})},t.prototype.He=function(t){var e=this;return this.Me=function(n){return Object(Lr.b)(e,void 0,void 0,function(){return Object(Lr.d)(this,function(e){return this.started?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt(function(n){return Object(Lr.b)(e,void 0,void 0,function(){return Object(Lr.d)(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget(function(){return Object(Lr.b)(e,void 0,void 0,function(){return Object(Lr.d)(this,function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return zu(e).put(new Sa(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.Je(e).next(function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable(function(){return t.Me(!1)}))})}).next(function(){return t.Ye(e)}).next(function(n){return t.isPrimary&&!n?t.Xe(e).next(function(){return!1}):!!n&&t.Ze(e).next(function(){return!0})})}).catch(function(e){if(Fa(e))return Br("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Br("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.Se.enqueueRetryable(function(){return t.Me(e)}),t.isPrimary=e})},t.prototype.Je=function(t){var e=this;return Gu(t).get(pa.key).next(function(t){return ja.resolve(e.tn(t))})},t.prototype.en=function(t){return zu(t).delete(this.clientId)},t.prototype.nn=function(){return Object(Lr.b)(this,void 0,void 0,function(){var t,e,n,r=this;return Object(Lr.d)(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var e=Ga(t,Sa.store);return e.Nt().next(function(t){var n=r.rn(t,18e5),i=t.filter(function(t){return-1===n.indexOf(t)});return ja.forEach(i,function(t){return e.delete(t.clientId)}).next(function(){return i})})}).catch(function(){return[]})]);case 1:if(t=i.sent(),this.Ke)for(e=0,n=t;e<n.length;e++)this.Ke.removeItem(this.on(n[e].clientId));i.label=2;case 2:return[2]}})})},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,function(){return t.je().then(function(){return t.nn()}).then(function(){return t.ze()})})},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?ja.resolve(!0):Gu(t).get(pa.key).next(function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new Vr(Fr.FAILED_PRECONDITION,Bu);return!1}}return!(!e.networkEnabled||!e.inForeground)||zu(t).Nt().next(function(t){return void 0===e.rn(t,5e3).find(function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))})})}).next(function(t){return e.isPrimary!==t&&Br("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.shutdown=function(){return Object(Lr.b)(this,void 0,void 0,function(){var t=this;return Object(Lr.d)(this,function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[pa.store,Sa.store],function(e){var n=new Ka(e,Mr.o);return t.Xe(n).next(function(){return t.en(n)})})];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}})})},t.prototype.rn=function(t,e){var n=this;return t.filter(function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)})},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return zu(e).Nt().next(function(e){return t.rn(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return vu.Kt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var r,i=this;return Br("IndexedDbPersistence","Starting transaction:",t),this.Be.runTransaction(t,"readonly"===e?"readonly":"readwrite",Na,function(o){return r=new Ka(o,i.Ne?i.Ne.next():Mr.o),"readwrite-primary"===e?i.Je(r).next(function(t){return!!t||i.Ye(r)}).next(function(e){if(!e)throw Kr("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.Se.enqueueRetryable(function(){return i.Me(!1)}),new Vr(Fr.FAILED_PRECONDITION,ka);return n(r)}).next(function(t){return i.Ze(r).next(function(){return t})}):i.dn(r).next(function(){return n(r)})}).then(function(t){return r.raiseOnCommittedEvent(),t})},t.prototype.dn=function(t){var e=this;return Gu(t).get(pa.key).next(function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Vr(Fr.FAILED_PRECONDITION,Bu)})},t.prototype.Ze=function(t){var e=new pa(this.clientId,this.allowTabSynchronization,Date.now());return Gu(t).put(pa.key,e)},t.yt=function(){return Pa.yt()},t.prototype.Xe=function(t){var e=this,n=Gu(t);return n.get(pa.key).next(function(t){return e.tn(t)?(Br("IndexedDbPersistence","Releasing primary lease."),n.delete(pa.key)):ja.resolve()})},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Kr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget(function(){return t.inForeground="visible"===t.document.visibilityState,t.je()})},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.un(),e.Se.enqueueAndForget(function(){return e.shutdown()})},this.window.addEventListener("pagehide",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("pagehide",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Ke)||void 0===e?void 0:e.getItem(this.on(t)));return Br("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Kr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Ke)try{this.Ke.setItem(this.on(this.clientId),String(Date.now()))}catch(t){Kr("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Ke)try{this.Ke.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Gu(t){return Ga(t,pa.store)}function zu(t){return Ga(t,Sa.store)}function Qu(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Hu=function(t,e){this.progress=t,this.wn=e},Wu=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next(function(r){return n.yn(t,e,r)})},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next(function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t})},t.prototype.gn=function(t,e){t.forEach(function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)})},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next(function(e){return n.En(t,e).next(function(){return e})})},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next(function(t){return n.gn(e,t)})},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return Ii.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):fo(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new Ii(e)).next(function(t){var e=ps();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e})},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=ps();return this.Ut.getCollectionParents(t,i).next(function(s){return ja.forEach(s,function(s){var a=function(t,e){return new oo(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.An(t,a,n).next(function(t){t.forEach(function(t,e){o=o.insert(t,e)})})}).next(function(){return o})})},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next(function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)}).next(function(e){return o.Rn(t,i=e,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,h=r.get(c);null==h&&(h=Fi.newInvalidDocument(c),r=r.insert(c,h)),Go(u,h,o.localWriteTime),h.isFoundDocument()||(r=r.remove(c))}})}).next(function(){return r.forEach(function(t,n){wo(e,n)||(r=r.remove(t))}),r})},t.prototype.Rn=function(t,e,n){for(var r=ms(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof Yo&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next(function(t){return t.forEach(function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))}),c})},t}(),Yu=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=ms(),i=ms(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Xu=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(ei.min())?this.Dn(t,e):this.Sn.pn(t,r).next(function(o){var s=i.Cn(e,o);return(uo(e)||co(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(qr()<=S.a.DEBUG&&Br("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),bo(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next(function(t){return s.forEach(function(e){t=t.insert(e.key,e)}),t}))})},t.prototype.Cn=function(t,e){var n=new cs(Io(t));return e.forEach(function(e,r){wo(t,r)&&(n=n.add(r))}),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return qr()<=S.a.DEBUG&&Br("QueryEngine","Using full collection scan to execute query:",bo(e)),this.Sn.getDocumentsMatchingQuery(t,e,ei.min())},t}(),$u=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new ss($r),this.kn=new ju(function(t){return qi(t)},Bi),this.$n=ei.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new Wu(this.On,this._n,this.persistence.getIndexManager()),this.Qe=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.collect(n,e.Fn)})},t}();function Ju(t,e,n,r){return new $u(t,e,n,r)}function Zu(t,e){return Object(Lr.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(Lr.d)(this,function(s){switch(s.label){case 0:return n=Wr(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n._n.getAllMutationBatches(t).next(function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new Wu(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)}).next(function(e){for(var n=[],r=[],s=ms(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++)s=s.add(l[h].key)}for(var f=0,d=e;f<d.length;f++){var p=d[f];r.push(p.batchId);for(var y=0,v=p.mutations;y<v.length;y++)s=s.add(v[y].key)}return i.pn(t,s).next(function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}})})})];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}})})}function tc(t,e){var n=Wr(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=ja.resolve();return o.forEach(function(t){s=s.next(function(){return r.getEntry(e,t)}).next(function(e){var o=n.docVersions.get(t);Hr(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))})}),s.next(function(){return t._n.removeMutationBatch(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n._n.performConsistencyCheck(t)}).next(function(){return n.Mn.pn(t,r)})})}function ec(t){var e=Wr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.qe.getLastRemoteSnapshotVersion(t)})}function nc(t,e){var n=Wr(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.Fn;var s=[];e.targetChanges.forEach(function(e,o){var a=i.get(o);if(a){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next(function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)}));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=a.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return Hr(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,c,e)&&s.push(n.qe.updateTargetData(t,c))}}});var a=fs();if(e.documentUpdates.forEach(function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))}),s.push(rc(t,o,e.documentUpdates,r,void 0).next(function(t){a=t})),!r.isEqual(ei.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next(function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)});s.push(u)}return ja.waitFor(s).next(function(){return o.apply(t)}).next(function(){return n.Mn.En(t,a)}).next(function(){return a})}).then(function(t){return n.Fn=i,t})}function rc(t,e,n,r,i){var o=ms();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var o=fs();return n.forEach(function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(ei.min())?(e.removeEntry(n,u),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):Br("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)}),o})}function ic(t,e){var n=Wr(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)})}function oc(t,e){var n=Wr(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.qe.getTargetData(t,e).next(function(i){return i?ja.resolve(r=i):n.qe.allocateTargetId(t).next(function(i){return r=new Ha(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next(function(){return r})})})}).then(function(t){var r=n.Fn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t})}function sc(t,e,n){return Object(Lr.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Lr.d)(this,function(a){switch(a.label){case 0:r=Wr(t),i=r.Fn.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.referenceDelegate.removeTarget(t,i)})];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!Fa(s=a.sent()))throw s;return Br("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}})})}function ac(t,e,n){var r=Wr(t),i=ei.min(),o=ms();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=Wr(t),i=r.kn.get(n);return void 0!==i?ja.resolve(r.Fn.get(i)):r.qe.getTargetData(e,n)}(r,t,yo(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next(function(t){o=t})}).next(function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:ei.min(),n?o:ms())}).next(function(t){return{documents:t,Bn:o}})})}function uc(t,e){var n=Wr(t),r=Wr(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.lt(t,e).next(function(t){return t?t.target:null})})}function cc(t){var e=Wr(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=Wr(t),i=fs(),o=$a(n),s=Fu(e),a=IDBKeyRange.lowerBound(o,!0);return s.$t({index:wa.readTimeIndex,range:a},function(t,e){var n=Ya(r.R,e);i=i.insert(n.key,n),o=e.readTime}).next(function(){return{wn:i,readTime:Ja(o)}})}(e.On,t,e.$n)}).then(function(t){var n=t.wn;return e.$n=t.readTime,n})}function hc(t){return Object(Lr.b)(this,void 0,void 0,function(){var e;return Object(Lr.d)(this,function(n){return[2,(e=Wr(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=Fu(t),n=ei.min();return e.$t({index:wa.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=Ja(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){e.$n=t})]})})}function lc(t,e,n,r){return Object(Lr.b)(this,void 0,void 0,function(){var i,o,s,a,u,c,h,l,f,d;return Object(Lr.d)(this,function(p){switch(p.label){case 0:for(i=Wr(t),o=ms(),s=fs(),a=vs(),u=0,c=n;u<c.length;u++)l=e.qn((h=c[u]).metadata.name),h.document&&(o=o.add(l)),s=s.insert(l,e.Un(h)),a=a.insert(l,e.Qn(h.metadata.readTime));return f=i.On.newChangeBuffer({trackRemovals:!0}),[4,oc(i,function(t){return yo(ao(si.fromString("__bundle__/docs/"+t)))}(r))];case 1:return d=p.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",function(t){return rc(t,f,s,ei.min(),a).next(function(e){return f.apply(t),e}).next(function(e){return i.qe.removeMatchingKeysForTargetId(t,d.targetId).next(function(){return i.qe.addMatchingKeys(t,o,d.targetId)}).next(function(){return i.Mn.En(t,e)}).next(function(){return e})})})]}})})}function fc(t,e,n){return void 0===n&&(n=ms()),Object(Lr.b)(this,void 0,void 0,function(){var r,i;return Object(Lr.d)(this,function(o){switch(o.label){case 0:return[4,oc(t,yo(iu(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=Wr(t)).persistence.runTransaction("Save named query","readwrite",function(t){var o=Ls(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Qe.saveNamedQuery(t,e);var s=r.withResumeToken(hi.EMPTY_BYTE_STRING,o);return i.Fn=i.Fn.insert(s.targetId,s),i.qe.updateTargetData(t,s).next(function(){return i.qe.removeMatchingKeysForTargetId(t,r.targetId)}).next(function(){return i.qe.addMatchingKeys(t,n,r.targetId)}).next(function(){return i.Qe.saveNamedQuery(t,e)})})]}})})}var dc=function(){function t(t){this.R=t,this.Kn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return ja.resolve(this.Kn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Kn.set(e.id,{id:(n=e).id,version:n.version,createTime:Ls(n.createTime)}),ja.resolve()},t.prototype.getNamedQuery=function(t,e){return ja.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:iu(t.bundledQuery),readTime:Ls(t.readTime)}}(e)),ja.resolve()},t}(),pc=function(){function t(){this.Wn=new cs(yc.Gn),this.zn=new cs(yc.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new yc(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},t.prototype.removeReference=function(t,e){this.Yn(new yc(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},t.prototype.Zn=function(t){var e=this,n=new Ii(new si([])),r=new yc(n,t),i=new yc(n,t+1),o=[];return this.zn.forEachInRange([r,i],function(t){e.Yn(t),o.push(t.key)}),o},t.prototype.ts=function(){var t=this;this.Wn.forEach(function(e){return t.Yn(e)})},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new Ii(new si([])),n=new yc(e,t),r=new yc(e,t+1),i=ms();return this.zn.forEachInRange([n,r],function(t){i=i.add(t.key)}),i},t.prototype.containsKey=function(t){var e=new yc(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),yc=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return Ii.comparator(t.key,e.key)||$r(t.ns,e.ns)},t.Hn=function(t,e){return $r(t.ns,e.ns)||Ii.comparator(t.key,e.key)},t}(),vc=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new cs(yc.Gn)}return t.prototype.checkEmpty=function(t){return ja.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++;var o=new za(i,e,n,r);this._n.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.rs=this.rs.add(new yc(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return ja.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return ja.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this.cs(e+1),r=n<0?0:n;return ja.resolve(this._n.length>r?this._n[r]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return ja.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return ja.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new yc(e,0),i=new yc(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],function(t){var e=n.os(t.ns);o.push(e)}),ja.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new cs($r);return e.forEach(function(t){var e=new yc(t,0),i=new yc(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],function(t){r=r.add(t.ns)})}),ja.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;Ii.isDocumentKey(i)||(i=i.child(""));var o=new yc(new Ii(i),0),s=new cs($r);return this.rs.forEachWhile(function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)},o),ja.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.os(t);null!==r&&n.push(r)}),n},t.prototype.removeMutationBatch=function(t,e){var n=this;Hr(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return ja.forEach(e.mutations,function(i){var o=new yc(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(function(){n.rs=r})},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new yc(e,0),r=this.rs.firstAfterOrEqual(n);return ja.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return ja.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),gc=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new ss(Ii.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return ja.resolve(n?n.document.clone():Fi.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=fs();return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():Fi.newInvalidDocument(t))}),ja.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=fs(),i=new Ii(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.value,u=a.document,c=a.readTime;if(!e.path.isPrefixOf(s.key.path))break;c.compareTo(n)<=0||wo(e,u)&&(r=r.insert(u.key,u.clone()))}return ja.resolve(r)},t.prototype.fs=function(t,e){return ja.forEach(this.docs,function(t){return e(t)})},t.prototype.newChangeBuffer=function(t){return new mc(this)},t.prototype.getSize=function(t){return ja.resolve(this.size)},t}(),mc=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return Object(Lr.c)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach(function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)}),ja.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(Ru),bc=function(){function t(t){this.persistence=t,this.ds=new ju(function(t){return qi(t)},Bi),this.lastRemoteSnapshotVersion=ei.min(),this.highestTargetId=0,this.ws=0,this._s=new pc,this.targetCount=0,this.ys=Iu.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach(function(t,n){return e(n)}),ja.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return ja.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return ja.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),ja.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),ja.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new Iu(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,ja.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),ja.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,ja.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach(function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)}),ja.waitFor(o).next(function(){return i})},t.prototype.getTargetCount=function(t){return ja.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return ja.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),ja.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.markPotentiallyOrphaned(t,e))}),ja.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),ja.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return ja.resolve(n)},t.prototype.containsKey=function(t,e){return ja.resolve(this._s.containsKey(e))},t}(),wc=function(){function t(t,e){var n=this;this.gs={},this.Ne=new Mr(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new bc(this),this.Ut=new uu,this.Ue=function(t,e){return new gc(t,function(t){return n.referenceDelegate.ps(t)})}(this.Ut),this.R=new Wa(e),this.Qe=new dc(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new vc(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var r=this;Br("MemoryPersistence","Starting transaction:",t);var i=new Ic(this.Ne.next());return this.referenceDelegate.Es(),n(i).next(function(t){return r.referenceDelegate.Ts(i).next(function(){return t})}).toPromise().then(function(t){return i.raiseOnCommittedEvent(),t})},t.prototype.Is=function(t,e){return ja.or(Object.values(this.gs).map(function(n){return function(){return n.containsKey(t,e)}}))},t}(),Ic=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return Object(Lr.c)(e,t),e}(Ca),Ec=function(){function t(t){this.persistence=t,this.As=new pc,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw Qr()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),ja.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),ja.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),ja.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach(function(t){return n.vs.add(t.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(function(t){t.forEach(function(t){return n.vs.add(t.toString())})}).next(function(){return r.removeTargetData(t,e)})},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ja.forEach(this.vs,function(r){var i=Ii.fromPath(r);return e.Ps(t,i).next(function(t){t||n.removeEntry(i)})}).next(function(){return e.Rs=null,n.apply(t)})},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next(function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())})},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return ja.or([function(){return ja.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),Tc=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();function _c(t,e){return"firestore_clients_"+t+"_"+e}function Oc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function Sc(t,e){return"firestore_targets_"+t+"_"+e}Tc.UNAUTHENTICATED=new Tc(null),Tc.GOOGLE_CREDENTIALS=new Tc("google-credentials-uid"),Tc.FIRST_PARTY=new Tc("first-party-uid");var Dc=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new Vr(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(Kr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Ac=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Vr(i.error.code,i.error.message)),o?new t(e,i.state,r):(Kr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Nc=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=ws(),s=0;i&&s<r.activeTargetIds.length;++s)i=wi(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(Kr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),kc=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Kr("SharedClientState","Failed to parse online state: "+e),null)},t}(),Cc=function(){function t(){this.activeTargetIds=ws()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),xc=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new ss($r),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=_c(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new Cc),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Qs=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(Lr.b)(this,void 0,void 0,function(){var t,e,n,r,i,o,s,a,u,c,h=this;return Object(Lr.d)(this,function(l){switch(l.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=l.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(_c(this.persistenceKey,r)))&&(o=Nc.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Ks(),(s=this.storage.getItem(this.Us))&&(a=this.js(s))&&this.Ws(a),u=0,c=this.$s;u<c.length;u++)this.Fs(c[u]);return this.$s=[],this.window.addEventListener("pagehide",function(){return h.shutdown()}),this.started=!0,[2]}})})},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(Sc(this.persistenceKey,t));if(n){var r=Ac.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Ks(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Ks()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(Sc(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach(function(t){r.Hs(t)}),this.currentUser=t,n.forEach(function(t){r.addPendingMutation(t)})},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Br("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Br("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Br("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Br("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void Kr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable(function(){return Object(Lr.b)(e,void 0,void 0,function(){var t,e,r,i,o,s;return Object(Lr.d)(this,function(a){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(s=function(t){var e=Mr.o;if(null!=t)try{var n=JSON.parse(t);Hr("number"==typeof n),e=n}catch(t){Kr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Mr.o&&this.sequenceNumberHandler(s);else if(n.key===this.Qs)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Ks=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new Dc(this.currentUser,t,e,n),i=Oc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=Oc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){this.storage.setItem(this.Us,JSON.stringify({clientId:this.Ns,onlineState:t}))},t.prototype.Ys=function(t,e,n){var r=Sc(this.persistenceKey,t),i=new Ac(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Qs,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return Nc.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]);return Dc.Vs(new Tc(void 0!==n[2]?n[2]:null),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return Ac.Vs(r,e)},t.prototype.js=function(t){return kc.Vs(t)},t.prototype.ii=function(t){return Object(Lr.b)(this,void 0,void 0,function(){return Object(Lr.d)(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(Br("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),s=[],a=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||a.push(t)}),this.syncEngine.hi(s,a).then(function(){n.ks=r})},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=ws();return t.forEach(function(t,n){e=e.unionWith(n.activeTargetIds)}),e},t}(),jc=function(){function t(){this.li=new Cc,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new Cc,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),Rc=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),Pc=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){Br("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){Br("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Lc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Mc=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),Fc=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return Object(Lr.c)(e,t),e.prototype.ki=function(t,e,n,r){return new Promise(function(i,o){var s=new Pr;s.listenOnce(Cr.COMPLETE,function(){try{switch(s.getLastErrorCode()){case kr.NO_ERROR:var e=s.getResponseJson();Br("Connection","XHR received:",JSON.stringify(e)),i(e);break;case kr.TIMEOUT:Br("Connection",'RPC "'+t+'" timed out'),o(new Vr(Fr.DEADLINE_EXCEEDED,"Request time out"));break;case kr.HTTP_ERROR:var n=s.getStatus();if(Br("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Fr).indexOf(e)>=0?e:Fr.UNKNOWN}(r.status);o(new Vr(a,r.message))}else o(new Vr(Fr.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Vr(Fr.UNAVAILABLE,"Connection failed."));break;default:Qr()}}finally{Br("Connection",'RPC "'+t+'" completed.')}});var a=JSON.stringify(r);s.send(e,"POST",a,n,15)})},e.prototype.Oi=function(t,e){var n=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new br,i=Ie(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new jr({})),this.Fi(o.initMessageHeaders,e),Object(O.n)()||Object(O.p)()||Object(O.l)()||Object(O.m)()||Object(O.q)()||Object(O.k)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");Br("Connection","Creating WebChannel: "+s,o);var a=r.createWebChannel(s,o),u=!1,c=!1,h=new Mc({Ei:function(t){c?Br("Connection","Not sending because WebChannel is closed:",t):(u||(Br("Connection","Opening WebChannel transport."),a.open(),u=!0),Br("Connection","WebChannel sending:",t),a.send(t))},Ti:function(){return a.close()}}),l=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return l(a,Rr.EventType.OPEN,function(){c||Br("Connection","WebChannel transport opened.")}),l(a,Rr.EventType.CLOSE,function(){c||(c=!0,Br("Connection","WebChannel transport closed"),h.Vi())}),l(a,Rr.EventType.ERROR,function(t){c||(c=!0,Gr("Connection","WebChannel transport errored:",t),h.Vi(new Vr(Fr.UNAVAILABLE,"The operation could not be completed")))}),l(a,Rr.EventType.MESSAGE,function(t){var e;if(!c){var n=t.data[0];Hr(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){Br("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=Zo[t];if(void 0!==e)return os(e)}(i),s=r.message;void 0===o&&(o=Fr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,h.Vi(new Vr(o,s)),a.close()}else Br("Connection","WebChannel received:",n),h.Si(n)}}),l(i,xr.STAT_EVENT,function(t){10===t.stat?Br("Connection","Detected buffering proxy"):11===t.stat&&Br("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Pi()},0),h},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId,this.Di=(t.ssl?"https":"http")+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);Br("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then(function(t){return Br("RestConnection","Received: ",t),t},function(e){throw Gr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.6.7",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){return this.Di+"/v1/"+e+":"+Lc[t]},t}());function Vc(){return"undefined"!=typeof window?window:null}function Uc(){return"undefined"!=typeof document?document:null}function qc(t){return new xs(t,!0)}var Bc=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Qi=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Ki=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Qi),i=Math.max(0,n-r);i>0&&Br("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,function(){return e.Qi=Date.now(),t()}),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),Kc=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Bc(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return Object(Lr.b)(this,void 0,void 0,function(){return Object(Lr.d)(this,function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,function(){return t.rr()}))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return Object(Lr.b)(this,void 0,void 0,function(){return Object(Lr.d)(this,function(t){return this.er()?[2,this.close(0)]:[2]})})},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return Object(Lr.b)(this,void 0,void 0,function(){return Object(Lr.d)(this,function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===Fr.RESOURCE_EXHAUSTED?(Kr(e.toString()),Kr("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Ki()):e&&e.code===Fr.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}})})},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then(function(e){t.Yi===n&&t.lr(e)},function(n){e(function(){var e=new Vr(Fr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)})})},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii(function(){n(function(){return e.state=2,e.listener.Ii()})}),this.stream.Ri(function(t){n(function(){return e.dr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji(function(){return Object(Lr.b)(t,void 0,void 0,function(){return Object(Lr.d)(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.dr=function(t){return Br("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget(function(){return e.Yi===t?n():(Br("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),Gc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return Object(Lr.c)(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Qr()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(Hr(void 0===e||"string"==typeof e),hi.fromBase64String(e||"")):(Hr(void 0===e||e instanceof Uint8Array),hi.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?Fr.UNKNOWN:os(t.code);return new Vr(e,t.message||"")}(a);n=new Os(r,i,o,s||null)}else if("documentChange"in e){i=Us(t,(r=e.documentChange).document.name),o=Ls(r.document.updateTime);var a=new Li({mapValue:{fields:r.document.fields}}),u=(s=Fi.newFoundDocument(i,o,a),r.targetIds||[]);n=new Ts(u,r.removedTargetIds||[],s.key,s)}else if("documentDelete"in e)i=Us(t,(r=e.documentDelete).document),o=r.readTime?Ls(r.readTime):ei.min(),a=Fi.newNoDocument(i,o),n=new Ts([],s=r.removedTargetIds||[],a.key,a);else if("documentRemove"in e)i=Us(t,(r=e.documentRemove).document),n=new Ts([],o=r.removedTargetIds||[],i,null);else{if(!("filter"in e))return Qr();var c=e.filter;i=new rs(r=c.count||0),n=new _s(o=c.targetId,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return ei.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?ei.min():e.readTime?Ls(e.readTime):ei.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=Ks(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=Ki(r)?{documents:Ys(t,r)}:{query:Xs(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Rs(t,e.resumeToken):e.snapshotVersion.compareTo(ei.min())>0&&(n.readTime=js(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Qr()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=Ks(this.R),e.removeTarget=t,this.cr(e)},e}(Kc),zc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return Object(Lr.c)(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(Hr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(Hr(void 0!==e),t.map(function(t){return function(t,e){var n=Ls(t.updateTime?t.updateTime:e);return n.isEqual(ei.min())&&(n=Ls(e)),new Vo(n,t.transformResults||[])}(t,e)})):[]}(t.writeResults,t.commitTime),n=Ls(t.commitTime);return this.listener.Tr(n,e)}return Hr(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=Ks(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Hs(e.R,t)})};this.cr(n)},e}(Kc),Qc=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return Object(Lr.c)(e,t),e.prototype.br=function(){if(this.Rr)throw new Vr(Fr.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.Ni(t,e,n,i)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===Fr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Vr(Fr.UNKNOWN,t.toString())})},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.$i(t,e,n,i)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===Fr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Vr(Fr.UNKNOWN,t.toString())})},e.prototype.terminate=function(){this.Rr=!0},e}(function(){}),Hc=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()}))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(Kr(e),this.Vr=!1):Br("OnlineStateTracker",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),Wc=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di(function(t){n.enqueueAndForget(function(){return Object(Lr.b)(o,void 0,void 0,function(){return Object(Lr.d)(this,function(t){switch(t.label){case 0:return rh(this)?(Br("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(Lr.b)(this,void 0,void 0,function(){var e;return Object(Lr.d)(this,function(n){switch(n.label){case 0:return(e=Wr(t)).Or.add(4),[4,Xc(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,Yc(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Br=new Hc(n,r)};function Yc(t){return Object(Lr.b)(this,void 0,void 0,function(){var e,n;return Object(Lr.d)(this,function(r){switch(r.label){case 0:if(!rh(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Xc(t){return Object(Lr.b)(this,void 0,void 0,function(){var e,n;return Object(Lr.d)(this,function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function $c(t,e){var n=Wr(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),nh(n)?eh(n):mh(n).er()&&Zc(n,e))}function Jc(t,e){var n=Wr(t),r=mh(n);n.$r.delete(e),r.er()&&th(n,e),0===n.$r.size&&(r.er()?r.ir():rh(n)&&n.Br.set("Unknown"))}function Zc(t,e){t.qr.U(e.targetId),mh(t).mr(e)}function th(t,e){t.qr.U(e),mh(t).yr(e)}function eh(t){t.qr=new Ds({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),mh(t).start(),t.Br.Sr()}function nh(t){return rh(t)&&!mh(t).tr()&&t.$r.size>0}function rh(t){return 0===Wr(t).Or.size}function ih(t){t.qr=void 0}function oh(t){return Object(Lr.b)(this,void 0,void 0,function(){return Object(Lr.d)(this,function(e){return t.$r.forEach(function(e,n){Zc(t,e)}),[2]})})}function sh(t,e){return Object(Lr.b)(this,void 0,void 0,function(){return Object(Lr.d)(this,function(n){return ih(t),nh(t)?(t.Br.Nr(e),eh(t)):t.Br.set("Unknown"),[2]})})}function ah(t,e,n){return Object(Lr.b)(this,void 0,void 0,function(){var r,i,o;return Object(Lr.d)(this,function(s){switch(s.label){case 0:if(t.Br.set("Online"),!(e instanceof Os&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Object(Lr.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(Lr.d)(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.$r.has(o=i[r])?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.$r.delete(o),t.qr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),Br("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,uh(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Ts?t.qr.X(e):e instanceof _s?t.qr.rt(e):t.qr.et(e),n.isEqual(ei.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,ec(t.localStore)];case 8:return i=s.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach(function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}}),n.targetMismatches.forEach(function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(hi.EMPTY_BYTE_STRING,n.snapshotVersion)),th(t,e);var r=new Ha(n.target,e,1,n.sequenceNumber);Zc(t,r)}}),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return Br("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,uh(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function uh(t,e,n){return Object(Lr.b)(this,void 0,void 0,function(){var r=this;return Object(Lr.d)(this,function(i){switch(i.label){case 0:if(!Fa(e))throw e;return t.Or.add(1),[4,Xc(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return ec(t.localStore)}),t.asyncQueue.enqueueRetryable(function(){return Object(Lr.b)(r,void 0,void 0,function(){return Object(Lr.d)(this,function(e){switch(e.label){case 0:return Br("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,Yc(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function ch(t,e){return e().catch(function(n){return uh(t,n,e)})}function hh(t){return Object(Lr.b)(this,void 0,void 0,function(){var e,n,r,i,o;return Object(Lr.d)(this,function(s){switch(s.label){case 0:e=Wr(t),n=bh(e),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return rh(t)&&t.kr.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,ic(e.localStore,r)];case 3:return null===(i=s.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=bh(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,uh(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return lh(e)&&fh(e),[2]}})})}function lh(t){return rh(t)&&!bh(t).tr()&&t.kr.length>0}function fh(t){bh(t).start()}function dh(t){return Object(Lr.b)(this,void 0,void 0,function(){return Object(Lr.d)(this,function(e){return bh(t).Ar(),[2]})})}function ph(t){return Object(Lr.b)(this,void 0,void 0,function(){var e,n,r;return Object(Lr.d)(this,function(i){for(e=bh(t),n=0,r=t.kr;n<r.length;n++)e.Er(r[n].mutations);return[2]})})}function yh(t,e,n){return Object(Lr.b)(this,void 0,void 0,function(){var r,i;return Object(Lr.d)(this,function(o){switch(o.label){case 0:return r=t.kr.shift(),i=Qa.from(r,e,n),[4,ch(t,function(){return t.remoteSyncer.applySuccessfulWrite(i)})];case 1:return o.sent(),[4,hh(t)];case 2:return o.sent(),[2]}})})}function vh(t,e){return Object(Lr.b)(this,void 0,void 0,function(){return Object(Lr.d)(this,function(n){switch(n.label){case 0:return e&&bh(t).pr?[4,function(t,e){return Object(Lr.b)(this,void 0,void 0,function(){var n,r;return Object(Lr.d)(this,function(i){switch(i.label){case 0:return is(r=e.code)&&r!==Fr.ABORTED?(n=t.kr.shift(),bh(t).sr(),[4,ch(t,function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,hh(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return lh(t)&&fh(t),[2]}})})}function gh(t,e){return Object(Lr.b)(this,void 0,void 0,function(){var n;return Object(Lr.d)(this,function(r){switch(r.label){case 0:return n=Wr(t),e?(n.Or.delete(2),[4,Yc(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,Xc(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function mh(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=Wr(t);return r.br(),new Gc(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:oh.bind(null,t),Ri:sh.bind(null,t),_r:ah.bind(null,t)}),t.Mr.push(function(n){return Object(Lr.b)(e,void 0,void 0,function(){return Object(Lr.d)(this,function(e){switch(e.label){case 0:return n?(t.Ur.sr(),nh(t)?eh(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),ih(t),e.label=3;case 3:return[2]}})})})),t.Ur}function bh(t){var e=this;return t.Qr||(t.Qr=function(t,e,n){var r=Wr(t);return r.br(),new zc(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:dh.bind(null,t),Ri:vh.bind(null,t),Ir:ph.bind(null,t),Tr:yh.bind(null,t)}),t.Mr.push(function(n){return Object(Lr.b)(e,void 0,void 0,function(){return Object(Lr.d)(this,function(e){switch(e.label){case 0:return n?(t.Qr.sr(),[4,hh(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Qr.stop()];case 3:e.sent(),t.kr.length>0&&(Br("RemoteStore","Stopping write stream with "+t.kr.length+" pending writes"),t.kr=[]),e.label=4;case 4:return[2]}})})})),t.Qr}var wh=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new xa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(t){})}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout(function(){return e.handleDelayElapsed()},t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Vr(Fr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget(function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then(function(e){return t.deferred.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function Ih(t,e){if(Kr("AsyncQueue",e+": "+t),Fa(t))return new Vr(Fr.UNAVAILABLE,e+": "+t);throw t}var Eh=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||Ii.comparator(e.key,n.key)}:function(t,e){return Ii.comparator(t.key,e.key)},this.keyedMap=ps(),this.sortedSet=new ss(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),Th=function(){function t(){this.Kr=new ss(Ii.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Kr.get(e);n?0!==t.type&&3===n.type?this.Kr=this.Kr.insert(e,t):3===t.type&&1!==n.type?this.Kr=this.Kr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Kr=this.Kr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Kr=this.Kr.remove(e):1===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):Qr():this.Kr=this.Kr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Kr.inorderTraversal(function(e,n){t.push(n)}),t},t}(),_h=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,Eh.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&go(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Oh=function(){this.Wr=void 0,this.listeners=[]},Sh=function(){this.queries=new ju(function(t){return mo(t)},go),this.onlineState="Unknown",this.Gr=new Set};function Dh(t,e){return Object(Lr.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u;return Object(Lr.d)(this,function(c){switch(c.label){case 0:if(n=Wr(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new Oh),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=c.sent(),[3,4];case 3:return a=c.sent(),u=Ih(a,"Initialization of query '"+bo(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&Ch(n),[2]}})})}function Ah(t,e){return Object(Lr.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Lr.d)(this,function(a){return n=Wr(t),i=!1,(o=n.queries.get(r=e.query))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]})})}function Nh(t,e){for(var n=Wr(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=n.queries.get(s.query);if(a){for(var u=0,c=a.listeners;u<c.length;u++)c[u].Hr(s)&&(r=!0);a.Wr=s}}r&&Ch(n)}function kh(t,e,n){var r=Wr(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Ch(t){t.Gr.forEach(function(t){t.next()})}var xh=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new _h(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){return!t.fromCache||!(this.options.so&&"Offline"!==e||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){return t.docChanges.length>0||!!(t.syncStateChanged||this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=_h.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),jh=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.io=function(){return"metadata"in this.payload},t}(),Rh=function(){function t(t){this.R=t}return t.prototype.qn=function(t){return Us(this.R,t)},t.prototype.Un=function(t){return t.metadata.exists?Qs(this.R,t.document,!1):Fi.newNoDocument(this.qn(t.metadata.name),this.Qn(t.metadata.readTime))},t.prototype.Qn=function(t){return Ls(t)},t}();!function(){function t(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=function(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(t)}t.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.co=function(t){for(var e=new Map,n=new Rh(this.R),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.qn(o.metadata.name),a=0,u=o.metadata.queries;a<u.length;a++){var c=u[a],h=(e.get(c)||ms()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return Object(Lr.b)(this,void 0,void 0,function(){var t,e,n,r,i;return Object(Lr.d)(this,function(o){switch(o.label){case 0:return[4,lc(this.localStore,new Rh(this.R),this.documents,this.ro.id)];case 1:t=o.sent(),e=this.co(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?[4,fc(this.localStore,i=r[n],e.get(i.name))]:[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Hu(Object.assign({},this.progress),t))]}})})}}();var Ph=function(t){this.key=t},Lh=function(t){this.key=t},Mh=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=ms(),this.mutatedKeys=ms(),this.lo=Io(t),this.fo=new Eh(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new Th,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=uo(this.query)&&i.size===this.query.limit?i.last():null,c=co(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(function(t,e){var h=i.get(t),l=wo(n.query,e)?e:null,f=!!h&&n.mutatedKeys.has(h.key),d=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),p=!1;h&&l?h.data.isEqual(l.data)?f!==d&&(r.track({type:3,doc:l}),p=!0):n.yo(h,l)||(r.track({type:2,doc:l}),p=!0,(u&&n.lo(l,u)>0||c&&n.lo(l,c)<0)&&(a=!0)):!h&&l?(r.track({type:0,doc:l}),p=!0):h&&!l&&(r.track({type:1,doc:h}),p=!0,(u||c)&&(a=!0)),p&&(l?(s=s.add(l),o=d?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),uo(this.query)||co(this.query))for(;s.size>this.query.limit;){var h=uo(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Qr()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)}),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new _h(this.query,t.fo,i,o,t.mutatedKeys,0===a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new Th,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach(function(t){return e.uo=e.uo.add(t)}),t.modifiedDocuments.forEach(function(t){}),t.removedDocuments.forEach(function(t){return e.uo=e.uo.delete(t)}),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=ms(),this.fo.forEach(function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))});var n=[];return e.forEach(function(e){t.ho.has(e)||n.push(new Lh(e))}),this.ho.forEach(function(t){e.has(t)||n.push(new Ph(t))}),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=ms();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return _h.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),Fh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Vh=function(t){this.key=t,this.bo=!1},Uh=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new ju(function(t){return mo(t)},go),this.Vo=new Map,this.So=new Set,this.Do=new ss(Ii.comparator),this.Co=new Map,this.No=new pc,this.xo={},this.Fo=new Map,this.ko=Iu.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();function qh(t,e){return Object(Lr.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Lr.d)(this,function(a){switch(a.label){case 0:return n=vl(t),(i=n.Po.get(e))?(n.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.Ro(),[3,4]):[3,1];case 1:return[4,oc(n.localStore,yo(e))];case 2:return o=a.sent(),s=n.sharedClientState.addLocalQueryTarget(o.targetId),[4,Bh(n,e,o.targetId,"current"===s)];case 3:r=a.sent(),n.isPrimaryClient&&$c(n.remoteStore,o),a.label=4;case 4:return[2,r]}})})}function Bh(t,e,n,r){return Object(Lr.b)(this,void 0,void 0,function(){var i,o,s,a,u,c;return Object(Lr.d)(this,function(h){switch(h.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return Object(Lr.b)(this,void 0,void 0,function(){var i,o,s;return Object(Lr.d)(this,function(a){switch(a.label){case 0:return(i=e.view._o(n)).Nn?[4,ac(t.localStore,e.query,!1).then(function(t){return e.view._o(t.documents,i)})]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(el(t,e.targetId,s.To),s.snapshot)]}})})}(t,e,n,r)},[4,ac(t.localStore,e,!0)];case 1:return i=h.sent(),o=new Mh(e,i.Bn),s=o._o(i.documents),a=Es.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(s,t.isPrimaryClient,a),el(t,n,u.To),c=new Fh(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}})})}function Kh(t,e){return Object(Lr.b)(this,void 0,void 0,function(){var n,r,i;return Object(Lr.d)(this,function(o){switch(o.label){case 0:return n=Wr(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter(function(t){return!go(t,e)})),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,sc(n.localStore,r.targetId,!1).then(function(){n.sharedClientState.clearQueryState(r.targetId),Jc(n.remoteStore,r.targetId),Zh(n,r.targetId)}).catch(Su)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Zh(n,r.targetId),[4,sc(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function Gh(t,e,n){return Object(Lr.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Lr.d)(this,function(a){switch(a.label){case 0:r=gl(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=Wr(t),i=ti.now(),o=e.reduce(function(t,e){return t.add(e.key)},ms());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Mn.pn(t,o).next(function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],h=zo(c,n.get(c.key));null!=h&&s.push(new Yo(c.key,h,Mi(h.value.mapValue),Uo.exists(!0)))}return r._n.addMutationBatch(t,i,s,e)})}).then(function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}})}(r.localStore,e)];case 2:return i=a.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new ss($r)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,il(r,i.changes)];case 3:return a.sent(),[4,hh(r.remoteStore)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=Ih(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function zh(t,e){return Object(Lr.b)(this,void 0,void 0,function(){var n,r;return Object(Lr.d)(this,function(i){switch(i.label){case 0:n=Wr(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,nc(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach(function(t,e){var r=n.Co.get(e);r&&(Hr(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?Hr(r.bo):t.removedDocuments.size>0&&(Hr(r.bo),r.bo=!1))}),[4,il(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Su(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function Qh(t,e,n){var r=Wr(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach(function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=Wr(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)}),r&&Ch(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Hh(t,e,n){return Object(Lr.b)(this,void 0,void 0,function(){var r,i,o,s,a,u;return Object(Lr.d)(this,function(c){switch(c.label){case 0:return(r=Wr(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(s=(s=new ss(Ii.comparator)).insert(o,Fi.newNoDocument(o,ei.min())),a=ms().add(o),u=new Is(ei.min(),new Map,new cs($r),s,a),[4,zh(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),rl(r),[3,4];case 2:return[4,sc(r.localStore,e,!1).then(function(){return Zh(r,e,n)}).catch(Su)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function Wh(t,e){return Object(Lr.b)(this,void 0,void 0,function(){var n,r,i;return Object(Lr.d)(this,function(o){switch(o.label){case 0:n=Wr(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,tc(n.localStore,e)];case 2:return i=o.sent(),Jh(n,r,null),$h(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,il(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Su(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Yh(t,e,n){return Object(Lr.b)(this,void 0,void 0,function(){var r,i;return Object(Lr.d)(this,function(o){switch(o.label){case 0:r=Wr(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Wr(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n._n.lookupMutationBatch(t,e).next(function(e){return Hr(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)}).next(function(){return n._n.performConsistencyCheck(t)}).next(function(){return n.Mn.pn(t,r)})})}(r.localStore,e)];case 2:return i=o.sent(),Jh(r,e,n),$h(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,il(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Su(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Xh(t,e){return Object(Lr.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Lr.d)(this,function(a){switch(a.label){case 0:rh((n=Wr(t)).remoteStore)||Br("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=Wr(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e._n.getHighestUnacknowledgedBatchId(t)})}(n.localStore)];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return o=a.sent(),s=Ih(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}})})}function $h(t,e){(t.Fo.get(e)||[]).forEach(function(t){t.resolve()}),t.Fo.delete(e)}function Jh(t,e,n){var r=Wr(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function Zh(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach(function(e){t.No.containsKey(e)||tl(t,e)})}function tl(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(Jc(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),rl(t))}function el(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Ph?(t.No.addReference(o.key,e),nl(t,o)):o instanceof Lh?(Br("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||tl(t,o.key)):Qr()}}function nl(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(Br("SyncEngine","New document in limbo: "+n),t.So.add(r),rl(t))}function rl(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new Ii(si.fromString(e)),r=t.ko.next();t.Co.set(r,new Vh(n)),t.Do=t.Do.insert(n,r),$c(t.remoteStore,new Ha(yo(ao(n.path)),r,2,Mr.o))}}function il(t,e,n){return Object(Lr.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Lr.d)(this,function(a){switch(a.label){case 0:return r=Wr(t),i=[],o=[],s=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach(function(t,a){s.push(r.Oo(a,e,n).then(function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Yu.Pn(a.targetId,t);o.push(e)}}))}),[4,Promise.all(s)]);case 1:return a.sent(),r.vo._r(i),[4,function(t,e){return Object(Lr.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u,c;return Object(Lr.d)(this,function(h){switch(h.label){case 0:n=Wr(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return ja.forEach(e,function(e){return ja.forEach(e.bn,function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)}).next(function(){return ja.forEach(e.vn,function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)})})})})];case 2:return h.sent(),[3,4];case 3:if(!Fa(r=h.sent()))throw r;return Br("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)a=(s=o[i]).targetId,s.fromCache||(u=n.Fn.get(a),c=u.withLastLimboFreeSnapshotVersion(u.snapshotVersion),n.Fn=n.Fn.insert(a,c));return[2]}})})}(r.localStore,o)];case 2:a.sent(),a.label=3;case 3:return[2]}})})}function ol(t,e){return Object(Lr.b)(this,void 0,void 0,function(){var n,r;return Object(Lr.d)(this,function(i){switch(i.label){case 0:return(n=Wr(t)).currentUser.isEqual(e)?[3,3]:(Br("SyncEngine","User change. New user:",e.toKey()),[4,Zu(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fo.forEach(function(t){t.forEach(function(t){t.reject(new Vr(Fr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.Fo.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,il(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function sl(t,e){var n=Wr(t),r=n.Co.get(e);if(r&&r.bo)return ms().add(r.key);var i=ms(),o=n.Vo.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=n.Po.get(a[s]);i=i.unionWith(u.view.wo)}return i}function al(t,e){return Object(Lr.b)(this,void 0,void 0,function(){var n,r,i;return Object(Lr.d)(this,function(o){switch(o.label){case 0:return[4,ac((n=Wr(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&el(n,e.targetId,i.To),i)]}})})}function ul(t){return Object(Lr.b)(this,void 0,void 0,function(){var e;return Object(Lr.d)(this,function(n){return[2,cc((e=Wr(t)).localStore).then(function(t){return il(e,t)})]})})}function cl(t,e,n,r){return Object(Lr.b)(this,void 0,void 0,function(){var i,o;return Object(Lr.d)(this,function(s){switch(s.label){case 0:return[4,function(t,e){var n=Wr(t),r=Wr(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.jt(t,e).next(function(e){return e?n.Mn.pn(t,e):ja.resolve(null)})})}((i=Wr(t)).localStore,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,hh(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Jh(i,e,r||null),$h(i,e),function(t,e){Wr(Wr(t)._n).Gt(e)}(i.localStore,e)):Qr(),s.label=4;case 4:return[4,il(i,o)];case 5:return s.sent(),[3,7];case 6:Br("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}function hl(t,e){return Object(Lr.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u;return Object(Lr.d)(this,function(c){switch(c.label){case 0:return vl(n=Wr(t)),gl(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,ll(n,r.toArray())]);case 1:return i=c.sent(),n.$o=!0,[4,gh(n.remoteStore,!0)];case 2:for(c.sent(),o=0,s=i;o<s.length;o++)$c(n.remoteStore,s[o]);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(a=[],u=Promise.resolve(),n.Vo.forEach(function(t,e){n.sharedClientState.isLocalQueryTarget(e)?a.push(e):u=u.then(function(){return Zh(n,e),sc(n.localStore,e,!0)}),Jc(n.remoteStore,e)}),[4,u]);case 4:return c.sent(),[4,ll(n,a)];case 5:return c.sent(),function(t){var e=Wr(t);e.Co.forEach(function(t,n){Jc(e.remoteStore,n)}),e.No.ts(),e.Co=new Map,e.Do=new ss(Ii.comparator)}(n),n.$o=!1,[4,gh(n.remoteStore,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})}function ll(t,e,n){return Object(Lr.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u,c,h,l,f,d,p;return Object(Lr.d)(this,function(y){switch(y.label){case 0:n=Wr(t),r=[],i=[],o=0,s=e,y.label=1;case 1:return o<s.length?(u=void 0,(c=n.Vo.get(a=s[o]))&&0!==c.length?[4,oc(n.localStore,yo(c[0]))]:[3,7]):[3,13];case 2:u=y.sent(),h=0,l=c,y.label=3;case 3:return h<l.length?(f=n.Po.get(l[h]),[4,al(n,f)]):[3,6];case 4:(d=y.sent()).snapshot&&i.push(d.snapshot),y.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,uc(n.localStore,a)];case 8:return p=y.sent(),[4,oc(n.localStore,p)];case 9:return u=y.sent(),[4,Bh(n,fl(p),a,!1)];case 10:y.sent(),y.label=11;case 11:r.push(u),y.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}})})}function fl(t){return so(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function dl(t){var e=Wr(t);return Wr(Wr(e.localStore).persistence).fn()}function pl(t,e,n,r){return Object(Lr.b)(this,void 0,void 0,function(){var i,o,s;return Object(Lr.d)(this,function(a){switch(a.label){case 0:return(i=Wr(t)).$o?(Br("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,cc(i.localStore)];case 3:return o=a.sent(),s=Is.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,il(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,sc(i.localStore,e,!0)];case 6:return a.sent(),Zh(i,e,r),[3,8];case 7:Qr(),a.label=8;case 8:return[2]}})})}function yl(t,e,n){return Object(Lr.b)(this,void 0,void 0,function(){var r,i,o,s,a,u,c,h,l;return Object(Lr.d)(this,function(f){switch(f.label){case 0:if(!(r=vl(t)).$o)return[3,10];i=0,o=e,f.label=1;case 1:return i<o.length?r.Vo.has(s=o[i])?(Br("SyncEngine","Adding an already active target "+s),[3,5]):[4,uc(r.localStore,s)]:[3,6];case 2:return a=f.sent(),[4,oc(r.localStore,a)];case 3:return u=f.sent(),[4,Bh(r,fl(a),u.targetId,!1)];case 4:f.sent(),$c(r.remoteStore,u),f.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(Lr.d)(this,function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,sc(r.localStore,t,!1).then(function(){Jc(r.remoteStore,t),Zh(r,t)}).catch(Su)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},h=0,l=n,f.label=7;case 7:return h<l.length?[5,c(l[h])]:[3,10];case 8:f.sent(),f.label=9;case 9:return h++,[3,7];case 10:return[2]}})})}function vl(t){var e=Wr(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=zh.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=sl.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Hh.bind(null,e),e.vo._r=Nh.bind(null,e.eventManager),e.vo.Mo=kh.bind(null,e.eventManager),e}function gl(t){var e=Wr(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Wh.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Yh.bind(null,e),e}var ml=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(Lr.b)(this,void 0,void 0,function(){return Object(Lr.d)(this,function(e){switch(e.label){case 0:return this.R=qc(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Qo(t),[2]}})})},t.prototype.Uo=function(t){return null},t.prototype.Qo=function(t){return Ju(this.persistence,new Xu,t.initialUser,this.R)},t.prototype.qo=function(t){return new wc(Ec.bs,this.R)},t.prototype.Bo=function(t){return new jc},t.prototype.terminate=function(){return Object(Lr.b)(this,void 0,void 0,function(){return Object(Lr.d)(this,function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}})})},t}(),bl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Ko=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(Lr.c)(e,t),e.prototype.initialize=function(e){return Object(Lr.b)(this,void 0,void 0,function(){return Object(Lr.d)(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,hc(this.localStore)];case 2:return n.sent(),[4,this.Ko.initialize(this,e)];case 3:return n.sent(),[4,gl(this.Ko.syncEngine)];case 4:return n.sent(),[4,hh(this.Ko.remoteStore)];case 5:return n.sent(),[2]}})})},e.prototype.Qo=function(t){return Ju(this.persistence,new Xu,t.initialUser,this.R)},e.prototype.Uo=function(t){return new Nu(this.persistence.referenceDelegate.garbageCollector,t.asyncQueue)},e.prototype.qo=function(t){var e=Qu(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?du.withCacheSize(this.cacheSizeBytes):du.DEFAULT;return new Ku(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,Vc(),Uc(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new jc},e}(ml),wl=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Ko=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(Lr.c)(e,t),e.prototype.initialize=function(e){return Object(Lr.b)(this,void 0,void 0,function(){var n,r=this;return Object(Lr.d)(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Ko.syncEngine,this.sharedClientState instanceof xc?(this.sharedClientState.syncEngine={ui:cl.bind(null,n),ai:pl.bind(null,n),hi:yl.bind(null,n),fn:dl.bind(null,n),ci:ul.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He(function(t){return Object(Lr.b)(r,void 0,void 0,function(){return Object(Lr.d)(this,function(e){switch(e.label){case 0:return[4,hl(this.Ko.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.Bo=function(t){var e=Vc();if(!xc.yt(e))throw new Vr(Fr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Qu(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new xc(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(bl),Il=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(Lr.b)(this,void 0,void 0,function(){var n=this;return Object(Lr.d)(this,function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return Qh(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=ol.bind(null,this.syncEngine),[4,gh(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.createEventManager=function(t){return new Sh},t.prototype.createDatastore=function(t){var e=qc(t.databaseInfo.databaseId),n=new Fc(t.databaseInfo);return function(t,e,n){return new Qc(t,e,n)}(t.credentials,n,e)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return Qh(s.syncEngine,t,0)},o=Pc.yt()?new Pc:new Rc,new Wc(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){var a=new Uh(t,e,n,r,i,o);return s&&(a.$o=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return Object(Lr.b)(this,void 0,void 0,function(){var e;return Object(Lr.d)(this,function(n){switch(n.label){case 0:return e=Wr(t),Br("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,Xc(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}})})}(this.remoteStore)},t}(),El=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),Tl=(function(){function t(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new xa,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then(function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}t.prototype.close=function(){return this.Go.cancel()},t.prototype.getMetadata=function(){return Object(Lr.b)(this,void 0,void 0,function(){return Object(Lr.d)(this,function(t){return[2,this.metadata.promise]})})},t.prototype.Lo=function(){return Object(Lr.b)(this,void 0,void 0,function(){return Object(Lr.d)(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}})})},t.prototype.Ho=function(){return Object(Lr.b)(this,void 0,void 0,function(){var t,e,n,r;return Object(Lr.d)(this,function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(t=i.sent())?[2,null]:(e=this.zo.decode(t),n=Number(e),isNaN(n)&&this.Yo("length string ("+e+") is not valid number"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new jh(JSON.parse(r),t.length+n)]}})})},t.prototype.Zo=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},t.prototype.Jo=function(){return Object(Lr.b)(this,void 0,void 0,function(){var t,e;return Object(Lr.d)(this,function(n){switch(n.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}})})},t.prototype.Xo=function(t){return Object(Lr.b)(this,void 0,void 0,function(){var e;return Object(Lr.d)(this,function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}})})},t.prototype.Yo=function(t){throw this.Go.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.tc=function(){return Object(Lr.b)(this,void 0,void 0,function(){var t,e;return Object(Lr.d)(this,function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}})})}}(),function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return Object(Lr.b)(this,void 0,void 0,function(){var e,n=this;return Object(Lr.d)(this,function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Vr(Fr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(Lr.b)(this,void 0,void 0,function(){var n,r,i,o,s,a;return Object(Lr.d)(this,function(u){switch(u.label){case 0:return n=Wr(t),r=Ks(n.R)+"/documents",i={documents:e.map(function(t){return Vs(n.R,t)})},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){Hr(!!e.found);var n=Us(t,e.found.name),r=Ls(e.found.updateTime),i=new Li({mapValue:{fields:e.found.fields}});return Fi.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){Hr(!!e.missing),Hr(!!e.readTime);var n=Us(t,e.missing),r=Ls(e.readTime);return Fi.newNoDocument(n,r)}(t,e):Qr()}(n.R,t);s.set(e.key.toString(),e)}),a=[],[2,(e.forEach(function(t){var e=s.get(t.toString());Hr(!!e),a.push(e)}),a)]}})})}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach(function(t){return n.recordVersion(t)}),e)]}})})},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new es(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return Object(Lr.b)(this,void 0,void 0,function(){var t,e=this;return Object(Lr.d)(this,function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=Ii.fromPath(n);e.mutations.push(new ns(r,e.precondition(r)))}),[4,function(t,e){return Object(Lr.b)(this,void 0,void 0,function(){var n,r,i;return Object(Lr.d)(this,function(o){switch(o.label){case 0:return n=Wr(t),r=Ks(n.R)+"/documents",i={writes:e.map(function(t){return Hs(n.R,t)})},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}})})},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw Qr();e=ei.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Vr(Fr.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?Uo.updateTime(e):Uo.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(ei.min()))throw new Vr(Fr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Uo.updateTime(e)}return Uo.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}()),_l=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new Bc(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji(function(){return Object(Lr.b)(t,void 0,void 0,function(){var t,e,n=this;return Object(Lr.d)(this,function(r){return t=new Tl(this.datastore),(e=this.sc(t))&&e.then(function(e){n.asyncQueue.enqueueAndForget(function(){return t.commit().then(function(){n.deferred.resolve(e)}).catch(function(t){n.ic(t)})})}).catch(function(t){n.ic(t)}),[2]})})})},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!mi(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget(function(){return e.nc(),Promise.resolve()})):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!is(e)}return!1},t}(),Ol=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=Tc.UNAUTHENTICATED,this.clientId=Xr.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,function(t){return Object(Lr.b)(r,void 0,void 0,function(){return Object(Lr.d)(this,function(e){switch(e.label){case 0:return Br("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}})})})}return t.prototype.getConfiguration=function(){return Object(Lr.b)(this,void 0,void 0,function(){return Object(Lr.d)(this,function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]})})},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Vr(Fr.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new xa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(function(){return Object(Lr.b)(t,void 0,void 0,function(){var t,n;return Object(Lr.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Ih(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}();function Sl(t,e){return Object(Lr.b)(this,void 0,void 0,function(){var n,r,i=this;return Object(Lr.d)(this,function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),Br("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener(function(t){return Object(Lr.b)(i,void 0,void 0,function(){return Object(Lr.d)(this,function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,Zu(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}})})}),e.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t.offlineComponents=e,[2]}})})}function Dl(t,e){return Object(Lr.b)(this,void 0,void 0,function(){var n,r;return Object(Lr.d)(this,function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,Al(t)];case 1:return n=i.sent(),Br("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener(function(t){return function(t,e){return Object(Lr.b)(this,void 0,void 0,function(){var n,r;return Object(Lr.d)(this,function(i){switch(i.label){case 0:return(n=Wr(t)).asyncQueue.verifyOperationInProgress(),Br("RemoteStore","RemoteStore received new credentials"),r=rh(n),n.Or.add(3),[4,Xc(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,Yc(n)];case 3:return i.sent(),[2]}})})}(e.remoteStore,t)}),t.onlineComponents=e,[2]}})})}function Al(t){return Object(Lr.b)(this,void 0,void 0,function(){return Object(Lr.d)(this,function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(Br("FirestoreClient","Using default OfflineComponentProvider"),[4,Sl(t,new ml)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}})})}function Nl(t){return Object(Lr.b)(this,void 0,void 0,function(){return Object(Lr.d)(this,function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(Br("FirestoreClient","Using default OnlineComponentProvider"),[4,Dl(t,new Il)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}})})}function kl(t){return Al(t).then(function(t){return t.persistence})}function Cl(t){return Al(t).then(function(t){return t.localStore})}function xl(t){return Nl(t).then(function(t){return t.remoteStore})}function jl(t){return Nl(t).then(function(t){return t.syncEngine})}function Rl(t){return Object(Lr.b)(this,void 0,void 0,function(){var e,n;return Object(Lr.d)(this,function(r){switch(r.label){case 0:return[4,Nl(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=qh.bind(null,e.syncEngine),n.onUnlisten=Kh.bind(null,e.syncEngine),n)]}})})}function Pl(t,e,n){var r=this;void 0===n&&(n={});var i=new xa;return t.asyncQueue.enqueueAndForget(function(){return Object(Lr.b)(r,void 0,void 0,function(){var r;return Object(Lr.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new El({next:function(o){e.enqueueAndForget(function(){return Ah(t,s)});var a=o.docs.has(n);!a&&o.fromCache?i.reject(new Vr(Fr.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new Vr(Fr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new xh(ao(n.path),o,{includeMetadataChanges:!0,so:!0});return Dh(t,s)},[4,Rl(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}})})}),i.promise}function Ll(t,e,n){var r=this;void 0===n&&(n={});var i=new xa;return t.asyncQueue.enqueueAndForget(function(){return Object(Lr.b)(r,void 0,void 0,function(){var r;return Object(Lr.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new El({next:function(n){e.enqueueAndForget(function(){return Ah(t,s)}),n.fromCache&&"server"===r.source?i.reject(new Vr(Fr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new xh(n,o,{includeMetadataChanges:!0,so:!0});return Dh(t,s)},[4,Rl(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}})})}),i.promise}var Ml=function(t,e,n,r,i,o,s,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},Fl=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Vl=new Map,Ul=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},ql=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable(function(){return e(Tc.UNAUTHENTICATED)})},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Bl=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable(function(){return e(n.token.user)})},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Kl=function(){function t(t){var e=this;this.currentUser=Tc.UNAUTHENTICATED,this.oc=new xa,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable(function(){return e.changeListener(e.currentUser)})};var n=function(t){Br("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit(function(t){return n(t)}),setTimeout(function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(Br("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}},0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.cc!==e?(Br("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Hr("string"==typeof n.accessToken),new Ul(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable(function(){return Object(Lr.b)(n,void 0,void 0,function(){return Object(Lr.d)(this,function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}})})})},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return Hr(null===t||"string"==typeof t),new Tc(t)},t}(),Gl=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=Tc.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),zl=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new Gl(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable(function(){return e(Tc.FIRST_PARTY)})},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function Ql(t,e,n){if(!n)throw new Vr(Fr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Hl(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Vr(Fr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Wl(t,e,n,r){if(!0===e&&!0===r)throw new Vr(Fr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Yl(t){if(!Ii.isDocumentKey(t))throw new Vr(Fr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Xl(t){if(Ii.isDocumentKey(t))throw new Vr(Fr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function $l(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Qr()}function Jl(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Vr(Fr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=$l(t);throw new Vr(Fr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Zl(t,e){if(e<=0)throw new Vr(Fr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var tf=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Vr(Fr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Vr(Fr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,Wl("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),ef=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new tf({}),this._settingsFrozen=!1,t instanceof Fl?(this._databaseId=t,this._credentials=new ql):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Vr(Fr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Fl(t.options.projectId)}(t),this._credentials=new Kl(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new Vr(Fr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new Vr(Fr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new tf(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new ql;switch(t.type){case"gapi":var e=t.client;return Hr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new zl(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Vr(Fr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return(t=Vl.get(this))&&(Br("ComponentProvider","Removing Datastore"),Vl.delete(this),t.terminate()),Promise.resolve();var t},t}(),nf=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new of(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),rf=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),of=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,ao(r))||this)._path=r,i.type="collection",i}return Object(Lr.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new nf(this.firestore,null,new Ii(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(rf);function sf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Object(O.h)(t),Ql("collection","path",e),t instanceof ef)return Xl(n=si.fromString.apply(si,Object(Lr.f)([e],r))),new of(t,null,n);if(!(t instanceof nf||t instanceof of))throw new Vr(Fr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Xl(n=si.fromString.apply(si,Object(Lr.f)([t.path],r)).child(si.fromString(e))),new of(t.firestore,null,n)}function af(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Object(O.h)(t),1===arguments.length&&(e=Xr.u()),Ql("doc","path",e),t instanceof ef)return Yl(n=si.fromString.apply(si,Object(Lr.f)([e],r))),new nf(t,null,new Ii(n));if(!(t instanceof nf||t instanceof of))throw new Vr(Fr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Yl(n=t._path.child(si.fromString.apply(si,Object(Lr.f)([e],r)))),new nf(t.firestore,t instanceof of?t.converter:null,new Ii(n))}function uf(t,e){return t=Object(O.h)(t),e=Object(O.h)(e),(t instanceof nf||t instanceof of)&&(e instanceof nf||e instanceof of)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function cf(t,e){return t=Object(O.h)(t),e=Object(O.h)(e),t instanceof rf&&e instanceof rf&&t.firestore===e.firestore&&go(t._query,e._query)&&t.converter===e.converter}var hf=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=[],this.Zi=new Bc(this,"async_queue_retry"),this.Tc=function(){var e=Uc();e&&Br("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=Uc();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Tc)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ic(),this.Ac(t)},t.prototype.enterRestrictedMode=function(){if(!this._c){this._c=!0;var t=Uc();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Tc)}},t.prototype.enqueue=function(t){return this.Ic(),this._c?new Promise(function(t){}):this.Ac(t)},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget(function(){return e.wc.push(t),e.Rc()})},t.prototype.Rc=function(){return Object(Lr.b)(this,void 0,void 0,function(){var t,e=this;return Object(Lr.d)(this,function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!Fa(t=n.sent()))throw t;return Br("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji(function(){return e.Rc()}),n.label=5;case 5:return[2]}})})},t.prototype.Ac=function(t){var e=this,n=this.dc.then(function(){return e.gc=!0,t().catch(function(t){throw e.yc=t,e.gc=!1,Kr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.gc=!1,t})});return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ic(),this.Ec.indexOf(t)>-1&&(e=0);var i=wh.createAndSchedule(this,t,e,n,function(t){return r.bc(t)});return this.mc.push(i),i},t.prototype.Ic=function(){this.yc&&Qr()},t.prototype.verifyOperationInProgress=function(){},t.prototype.vc=function(){return Object(Lr.b)(this,void 0,void 0,function(){var t;return Object(Lr.d)(this,function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.Pc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Vc=function(t){var e=this;return this.vc().then(function(){e.mc.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs});for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.vc()})},t.prototype.Sc=function(t){this.Ec.push(t)},t.prototype.bc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function lf(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}!function(){function t(){this._progressObserver={},this._taskCompletionResolver=new xa,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},t.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},t.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},t.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},t.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)}}();var ff=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new hf,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return Object(Lr.c)(e,t),e.prototype._terminate=function(){return this._firestoreClient||pf(this),this._firestoreClient.terminate()},e}(ef);function df(t){return t._firestoreClient||pf(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function pf(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new Ml(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Ol(t._credentials,t._queue,r)}function yf(t,e,n){var r=this,i=new xa;return t.asyncQueue.enqueue(function(){return Object(Lr.b)(r,void 0,void 0,function(){var r;return Object(Lr.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,Sl(t,n)];case 1:return o.sent(),[4,Dl(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Fr.FAILED_PRECONDITION||t.code===Fr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function vf(t){if(t._initialized||t._terminated)throw new Vr(Fr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var gf=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Vr(Fr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ui(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),mf=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(hi.fromBase64String(e))}catch(e){throw new Vr(Fr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(hi.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),bf=function(t){this._methodName=t},wf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Vr(Fr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Vr(Fr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return $r(this._lat,t._lat)||$r(this._long,t._long)},t}(),If=/^__.*__$/,Ef=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new Yo(t,this.data,this.fieldMask,e,this.fieldTransforms):new Wo(t,this.data,e,this.fieldTransforms)},t}(),Tf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new Yo(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();function _f(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Qr()}}var Of=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Dc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Cc",{get:function(){return this.settings.Cc},enumerable:!1,configurable:!0}),t.prototype.Nc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.xc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.kc(t),r},t.prototype.$c=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.Dc(),r},t.prototype.Oc=function(t){return this.Nc({path:void 0,Fc:!0})},t.prototype.Mc=function(t){return zf(t,this.settings.methodName,this.settings.Lc||!1,this.path,this.settings.Bc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find(function(e){return t.isPrefixOf(e)})||void 0!==this.fieldTransforms.find(function(e){return t.isPrefixOf(e.field)})},t.prototype.Dc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.kc(this.path.get(t))},t.prototype.kc=function(t){if(0===t.length)throw this.Mc("Document fields must not be empty");if(_f(this.Cc)&&If.test(t))throw this.Mc('Document fields cannot begin and end with "__"')},t}(),Sf=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||qc(t)}return t.prototype.qc=function(t,e,n,r){return void 0===r&&(r=!1),new Of({Cc:t,methodName:e,Bc:n,path:ui.emptyPath(),Fc:!1,Lc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function Df(t){var e=t._freezeSettings(),n=qc(t._databaseId);return new Sf(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Af(t,e,n,r,i,o){void 0===o&&(o={});var s=t.qc(o.merge||o.mergeFields?2:0,e,n,i);qf("Data must be an object, but it was:",s,r);var a,u,c=Vf(r,s);if(o.merge)a=new ci(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var d=Bf(e,f[l],n);if(!s.contains(d))throw new Vr(Fr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Qf(h,d)||h.push(d)}a=new ci(h),u=s.fieldTransforms.filter(function(t){return a.covers(t.field)})}else a=null,u=s.fieldTransforms;return new Ef(new Li(c),a,u)}var Nf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Lr.c)(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Cc)throw t.Mc(1===t.Cc?this._methodName+"() can only appear at the top level of your update data":this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(bf);function kf(t,e,n){return new Of({Cc:3,Bc:e.settings.Bc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var Cf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Lr.c)(e,t),e.prototype._toFieldTransform=function(t){return new Fo(t.path,new ko)},e.prototype.isEqual=function(t){return t instanceof e},e}(bf),xf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return Object(Lr.c)(e,t),e.prototype._toFieldTransform=function(t){var e=kf(this,t,!0),n=this.Uc.map(function(t){return Ff(t,e)}),r=new Co(n);return new Fo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(bf),jf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return Object(Lr.c)(e,t),e.prototype._toFieldTransform=function(t){var e=kf(this,t,!0),n=this.Uc.map(function(t){return Ff(t,e)}),r=new jo(n);return new Fo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(bf),Rf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Qc=n,r}return Object(Lr.c)(e,t),e.prototype._toFieldTransform=function(t){var e=new Po(t.R,Oo(t.R,this.Qc));return new Fo(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(bf);function Pf(t,e,n,r){var i=t.qc(1,e,n);qf("Data must be an object, but it was:",i,r);var o=[],s=Li.empty();ri(r,function(t,r){var a=Gf(e,t,n);r=Object(O.h)(r);var u=i.$c(a);if(r instanceof Nf)o.push(a);else{var c=Ff(r,u);null!=c&&(o.push(a),s.set(a,c))}});var a=new ci(o);return new Tf(s,a,i.fieldTransforms)}function Lf(t,e,n,r,i,o){var s=t.qc(1,e,n),a=[Bf(e,r,n)],u=[i];if(o.length%2!=0)throw new Vr(Fr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(Bf(e,o[c])),u.push(o[c+1]);for(var h=[],l=Li.empty(),f=a.length-1;f>=0;--f)if(!Qf(h,a[f])){var d=a[f],p=u[f];p=Object(O.h)(p);var y=s.$c(d);if(p instanceof Nf)h.push(d);else{var v=Ff(p,y);null!=v&&(h.push(d),l.set(d,v))}}var g=new ci(h);return new Tf(l,g,s.fieldTransforms)}function Mf(t,e,n,r){return void 0===r&&(r=!1),Ff(n,t.qc(r?4:3,e))}function Ff(t,e){if(Uf(t=Object(O.h)(t)))return qf("Unsupported field value:",e,t),Vf(t,e);if(t instanceof bf)return function(t,e){if(!_f(e.Cc))throw e.Mc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Mc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&4!==e.Cc)throw e.Mc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Ff(o[i],e.Oc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=Object(O.h)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Oo(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ti.fromDate(t);return{timestampValue:js(e.R,n)}}if(t instanceof ti)return n=new ti(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:js(e.R,n)};if(t instanceof wf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof mf)return{bytesValue:Rs(e.R,t._byteString)};if(t instanceof nf){var r=t.firestore._databaseId;if(!r.isEqual(n=e.databaseId))throw e.Mc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Ms(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Mc("Unsupported field value: "+$l(t))}(t,e)}function Vf(t,e){var n={};return ii(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ri(t,function(t,r){var i=Ff(r,e.xc(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function Uf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ti||t instanceof wf||t instanceof mf||t instanceof nf||t instanceof bf)}function qf(t,e,n){if(!Uf(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=$l(n);throw e.Mc("an object"===r?t+" a custom object":t+" "+r)}}function Bf(t,e,n){if((e=Object(O.h)(e))instanceof gf)return e._internalPath;if("string"==typeof e)return Gf(t,e);throw zf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Kf=new RegExp("[~\\*/\\[\\]]");function Gf(t,e,n){if(e.search(Kf)>=0)throw zf("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(gf.bind.apply(gf,Object(Lr.f)([void 0],e.split(".")))))._internalPath}catch(r){throw zf("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function zf(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new Vr(Fr.INVALID_ARGUMENT,(a+=". ")+t+u)}function Qf(t,e){return t.some(function(t){return t.isEqual(e)})}var Hf=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new nf(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new Wf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(Yf("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),Wf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Lr.c)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Hf);function Yf(t,e){return"string"==typeof e?Gf(t,e):e instanceof gf?e._internalPath:e._delegate._internalPath}var Xf=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),$f=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return Object(Lr.c)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new Jf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(Yf("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(Hf),Jf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Lr.c)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}($f),Zf=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new Xf(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach(function(r){t.call(e,new Jf(n._firestore,n._userDataWriter,r.key,r,new Xf(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Vr(Fr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map(function(e){return{type:"added",doc:new Jf(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Xf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}})}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new Jf(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Xf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:td(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function td(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Qr()}}function ed(t,e){return t instanceof $f&&e instanceof $f?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Zf&&e instanceof Zf&&t._firestore===e._firestore&&cf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function nd(t){if(co(t)&&0===t.explicitOrderBy.length)throw new Vr(Fr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var rd=function(){};function id(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var od=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Kc=e,i.jc=n,i.Wc=r,i.type="where",i}return Object(Lr.c)(e,t),e.prototype._apply=function(t){var e=Df(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new Vr(Fr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){fd(s,o);for(var u=[],c=0,h=s;c<h.length;c++)u.push(ld(r,t,h[c]));a={arrayValue:{values:u}}}else a=ld(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||fd(s,o),a=Mf(n,"where",s,"in"===o||"not-in"===o);var l=Gi.create(i,o,a);return function(t,e){if(e.g()){var n=lo(t);if(null!==n&&!n.isEqual(e.field))throw new Vr(Fr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=ho(t);null!==r&&dd(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new Vr(Fr.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(t._query,0,e,t.firestore._databaseId,this.Kc,this.jc,this.Wc);return new rf(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new oo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(rd),sd=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Kc=e,r.Gc=n,r.type="orderBy",r}return Object(Lr.c)(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Vr(Fr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Vr(Fr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new eo(e,n);return function(t,e){if(null===ho(t)){var n=lo(t);null!==n&&dd(0,n,e.field)}}(t,r),r}(t._query,this.Kc,this.Gc);return new rf(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new oo(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(rd),ad=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.zc=n,i.Hc=r,i}return Object(Lr.c)(e,t),e.prototype._apply=function(t){return new rf(t.firestore,t.converter,vo(t._query,this.zc,this.Hc))},e}(rd),ud=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return Object(Lr.c)(e,t),e.prototype._apply=function(t){var e=hd(t,this.type,this.Jc,this.Yc);return new rf(t.firestore,t.converter,function(t,e){return new oo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(rd),cd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return Object(Lr.c)(e,t),e.prototype._apply=function(t){var e=hd(t,this.type,this.Jc,this.Yc);return new rf(t.firestore,t.converter,function(t,e){return new oo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(rd);function hd(t,e,n,r){if(n[0]=Object(O.h)(n[0]),n[0]instanceof Hf)return function(t,e,n,r,i){if(!r)throw new Vr(Fr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=po(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(Ni(e,r.key));else{var c=r.data.field(u.field);if(yi(c))throw new Vr(Fr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.canonicalString();throw new Vr(Fr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Zi(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=Df(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new Vr(Fr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new Vr(Fr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!fo(t)&&-1!==c.indexOf("/"))throw new Vr(Fr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(si.fromString(c));if(!Ii.isDocumentKey(h))throw new Vr(Fr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new Ii(h);a.push(Ni(e,l))}else{var f=Mf(n,r,c);a.push(f)}}return new Zi(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function ld(t,e,n){if("string"==typeof(n=Object(O.h)(n))){if(""===n)throw new Vr(Fr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!fo(e)&&-1!==n.indexOf("/"))throw new Vr(Fr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(si.fromString(n));if(!Ii.isDocumentKey(r))throw new Vr(Fr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Ni(t,new Ii(r))}if(n instanceof nf)return Ni(t,n._key);throw new Vr(Fr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+$l(n)+".")}function fd(t,e){if(!Array.isArray(t)||0===t.length)throw new Vr(Fr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Vr(Fr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function dd(t,e,n){if(!n.isEqual(e))throw new Vr(Fr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}var pd=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),Ei(t)){case 0:return null;case 1:return t.booleanValue;case 2:return di(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(pi(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Qr()}},t.prototype.convertObject=function(t,e){var n=this,r={};return ri(t.fields,function(t,i){r[t]=n.convertValue(i,e)}),r},t.prototype.convertGeoPoint=function(t){return new wf(di(t.latitude),di(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.convertValue(t,e)})},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=vi(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(gi(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=fi(t);return new ti(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=si.fromString(t);Hr(ua(n));var r=new Fl(n.get(1),n.get(3)),i=new Ii(n.popFirst(5));return r.isEqual(e)||Kr("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();function yd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var vd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(Lr.c)(e,t),e.prototype.convertBytes=function(t){return new mf(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new nf(this.firestore,null,e)},e}(pd),gd=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=Df(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=md(t,this._firestore),i=yd(r.converter,e,n),o=Af(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,Uo.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=md(t,this._firestore);return o="string"==typeof(e=Object(O.h)(e))||e instanceof gf?Lf(this._dataReader,"WriteBatch.update",s._key,e,n,r):Pf(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,Uo.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=md(t,this._firestore);return this._mutations=this._mutations.concat(new es(e._key,Uo.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new Vr(Fr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function md(t,e){if((t=Object(O.h)(t)).firestore!==e)throw new Vr(Fr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var bd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(Lr.c)(e,t),e.prototype.convertBytes=function(t){return new mf(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new nf(this.firestore,null,e)},e}(pd);function wd(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Jl(t,nf);var o=Jl(t.firestore,ff),s=Df(o);return Ed(o,[("string"==typeof(e=Object(O.h)(e))||e instanceof gf?Lf(s,"updateDoc",t._key,e,n,r):Pf(s,"updateDoc",t._key,e)).toMutation(t._key,Uo.exists(!0))])}function Id(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=Object(O.h)(t);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||lf(i[a])||(s=i[a],a++);var u,c,h,l={includeMetadataChanges:s.includeMetadataChanges};if(lf(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof nf)c=Jl(t.firestore,ff),h=ao(t._key.path),u={next:function(e){i[a]&&i[a](Td(c,t,e))},error:i[a+1],complete:i[a+2]};else{var d=Jl(t,rf);c=Jl(d.firestore,ff),h=d._query;var p=new bd(c);u={next:function(t){i[a]&&i[a](new Zf(c,p,d,t))},error:i[a+1],complete:i[a+2]},nd(t._query)}return function(t,e,n,r){var i=this,o=new El(r),s=new xh(e,o,n);return t.asyncQueue.enqueueAndForget(function(){return Object(Lr.b)(i,void 0,void 0,function(){var e;return Object(Lr.d)(this,function(n){switch(n.label){case 0:return e=Dh,[4,Rl(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})}),function(){o.Wo(),t.asyncQueue.enqueueAndForget(function(){return Object(Lr.b)(i,void 0,void 0,function(){var e;return Object(Lr.d)(this,function(n){switch(n.label){case 0:return e=Ah,[4,Rl(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})})}}(df(c),h,l,u)}function Ed(t,e){return function(t,e){var n=this,r=new xa;return t.asyncQueue.enqueueAndForget(function(){return Object(Lr.b)(n,void 0,void 0,function(){var n;return Object(Lr.d)(this,function(i){switch(i.label){case 0:return n=Gh,[4,jl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(df(t),e)}function Td(t,e,n){var r=n.docs.get(e._key),i=new bd(t);return new $f(t,i,e._key,r,new Xf(n.hasPendingWrites,n.fromCache),e.converter)}var _d=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return Object(Lr.c)(e,t),e.prototype.get=function(e){var n=this,r=md(e,this._firestore),i=new bd(this._firestore);return t.prototype.get.call(this,e).then(function(t){return new $f(n._firestore,i,r._key,t._document,new Xf(!1,!1),r.converter)})},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=Df(t)}return t.prototype.get=function(t){var e=this,n=md(t,this._firestore),r=new vd(this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return Qr();var i=t[0];if(i.isFoundDocument())return new Hf(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new Hf(e._firestore,r,n._key,null,n.converter);throw Qr()})},t.prototype.set=function(t,e,n){var r=md(t,this._firestore),i=yd(r.converter,e,n),o=Af(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=md(t,this._firestore);return o="string"==typeof(e=Object(O.h)(e))||e instanceof gf?Lf(this._dataReader,"Transaction.update",s._key,e,n,r):Pf(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=md(t,this._firestore);return this._transaction.delete(e._key),this},t}());function Od(){if("undefined"==typeof Uint8Array)throw new Vr(Fr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Sd(){if("undefined"==typeof atob)throw new Vr(Fr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Dd=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return Sd(),new t(mf.fromBase64String(e))},t.fromUint8Array=function(e){return Od(),new t(mf.fromUint8Array(e))},t.prototype.toBase64=function(){return Sd(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return Od(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),Ad=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){vf(t=Jl(t,ff));var n=df(t),r=t._freezeSettings(),i=new Il;return yf(n,i,new bl(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){vf(t=Jl(t,ff));var e=df(t),n=t._freezeSettings(),r=new Il;return yf(e,r,new wl(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new Vr(Fr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new xa;return t._queue.enqueueAndForgetEvenWhileRestricted(function(){return Object(Lr.b)(e,void 0,void 0,function(){var e;return Object(Lr.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(Lr.b)(this,void 0,void 0,function(){return Object(Lr.d)(this,function(e){switch(e.label){case 0:return Pa.yt()?[4,Pa.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(Qu(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t._delegate)},t}(),Nd=function(){function t(t,e,n){var r=this;this._delegate=e,this.Xc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof Fl||(this.Zc=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||Gr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var i=(t=Jl(t,ef))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==e&&Gr("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:e+":"+n,ssl:!1})),r.mockUserToken){var o=Object(O.d)(r.mockUserToken),s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new Vr(Fr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new Bl(new Ul(o,new Tc(s)))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue(function(){return Object(Lr.b)(e,void 0,void 0,function(){var e,n;return Object(Lr.d)(this,function(r){switch(r.label){case 0:return[4,kl(t)];case 1:return e=r.sent(),[4,xl(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=Wr(t);return e.Or.delete(0),Yc(e)}(n))]}})})})}(df(Jl(this._delegate,ff)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue(function(){return Object(Lr.b)(e,void 0,void 0,function(){var e,n;return Object(Lr.d)(this,function(r){switch(r.label){case 0:return[4,kl(t)];case 1:return e=r.sent(),[4,xl(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return Object(Lr.b)(this,void 0,void 0,function(){var e;return Object(Lr.d)(this,function(n){switch(n.label){case 0:return(e=Wr(t)).Or.add(0),[4,Xc(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}})})}(n))]}})})})}(df(Jl(this._delegate,ff)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Wl("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Xc.enableMultiTabIndexedDbPersistence(this):this.Xc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Xc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.Zc&&(this.Zc._removeServiceInstance("firestore"),this.Zc._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new xa;return t.asyncQueue.enqueueAndForget(function(){return Object(Lr.b)(e,void 0,void 0,function(){var e;return Object(Lr.d)(this,function(r){switch(r.label){case 0:return e=Xh,[4,jl(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(df(Jl(this._delegate,ff)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new El(e);return t.asyncQueue.enqueueAndForget(function(){return Object(Lr.b)(n,void 0,void 0,function(){var e;return Object(Lr.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){Wr(t).Gr.add(e),e.next()},[4,Rl(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})}),function(){r.Wo(),t.asyncQueue.enqueueAndForget(function(){return Object(Lr.b)(n,void 0,void 0,function(){var e;return Object(Lr.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){Wr(t).Gr.delete(e)},[4,Rl(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})})}}(df(t=Jl(t,ff)),lf(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.Zc)throw new Vr(Fr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Zc},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Kd(this,sf(this._delegate,t))}catch(t){throw Pd(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new Rd(this,af(this._delegate,t))}catch(t){throw Pd(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new Ud(this,function(t,e){if(t=Jl(t,ef),Ql("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Vr(Fr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new rf(t,null,function(t){return new oo(si.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw Pd(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new xa;return t.asyncQueue.enqueueAndForget(function(){return Object(Lr.b)(n,void 0,void 0,function(){var n;return Object(Lr.d)(this,function(i){switch(i.label){case 0:return[4,function(t){return Nl(t).then(function(t){return t.datastore})}(t)];case 1:return n=i.sent(),new _l(t.asyncQueue,n,e,r).run(),[2]}})})}),r.promise}(df(t),function(n){return e(new _d(t,n))})}(this._delegate,function(n){return t(new Cd(e,n))})},t.prototype.batch=function(){var t=this;return df(this._delegate),new xd(new gd(this._delegate,function(e){return Ed(t._delegate,e)}))},t.prototype.loadBundle=function(t){throw new Vr(Fr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new Vr(Fr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),kd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(Lr.c)(e,t),e.prototype.convertBytes=function(t){return new Dd(new mf(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return Rd.tu(e,this.firestore,null)},e}(pd),Cd=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new kd(t)}return t.prototype.get=function(t){var e=this,n=Gd(t);return this._delegate.get(n).then(function(t){return new Fd(e._firestore,new $f(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))})},t.prototype.set=function(t,e,n){var r=Gd(t);return n?(Hl("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Gd(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Object(Lr.f)([s,e,n],i)),this},t.prototype.delete=function(t){var e=Gd(t);return this._delegate.delete(e),this},t}(),xd=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=Gd(t);return n?(Hl("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Gd(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Object(Lr.f)([s,e,n],i)),this},t.prototype.delete=function(t){var e=Gd(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),jd=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new Jf(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Vd(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.eu=function(e,n){var r=t.nu,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new kd(e),n),i.set(n,o)),o},t}();jd.nu=new WeakMap;var Rd=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new kd(t)}return t.su=function(e,n,r){if(e.length%2!=0)throw new Vr(Fr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new nf(n._delegate,r,new Ii(e)))},t.tu=function(e,n,r){return new t(n,new nf(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Kd(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Kd(this.firestore,sf(this._delegate,t))}catch(t){throw Pd(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=Object(O.h)(t))instanceof nf&&uf(this._delegate,t)},t.prototype.set=function(t,e){e=Hl("DocumentReference.set",e);try{return function(t,e,n){t=Jl(t,nf);var r=Jl(t.firestore,ff),i=yd(t.converter,e,n);return Ed(r,[Af(Df(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,Uo.none())])}(this._delegate,t,e)}catch(t){throw Pd(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?wd(this._delegate,t):wd.apply(void 0,Object(Lr.f)([this._delegate,t,e],n))}catch(t){throw Pd(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return Ed(Jl((t=this._delegate).firestore,ff),[new es(t._key,Uo.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Ld(e),i=Md(e,function(e){return new Fd(t.firestore,new $f(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))});return Id(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Jl(t,nf);var e=Jl(t.firestore,ff),n=df(e),r=new bd(e);return function(t,e){var n=this,r=new xa;return t.asyncQueue.enqueueAndForget(function(){return Object(Lr.b)(n,void 0,void 0,function(){var n;return Object(Lr.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(Lr.b)(this,void 0,void 0,function(){var r,i;return Object(Lr.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=Wr(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Mn.mn(t,e)})}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new Vr(Fr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=Ih(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}})})},[4,Cl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t._key).then(function(n){return new $f(e,r,t._key,n,new Xf(null!==n&&n.hasLocalMutations,!0),t.converter)})}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Jl(t,nf);var e=Jl(t.firestore,ff);return Pl(df(e),t._key,{source:"server"}).then(function(n){return Td(e,t,n)})}(this._delegate):function(t){t=Jl(t,nf);var e=Jl(t.firestore,ff);return Pl(df(e),t._key).then(function(n){return Td(e,t,n)})}(this._delegate)).then(function(t){return new Fd(e.firestore,new $f(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))})},t.prototype.withConverter=function(e){return new t(this.firestore,this._delegate.withConverter(e?jd.eu(this.firestore,e):null))},t}();function Pd(t,e,n){return t.message=t.message.replace(e,n),t}function Ld(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!lf(r))return r}return{}}function Md(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=lf(t[0])?t[0]:lf(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Fd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new Rd(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return ed(this._delegate,t._delegate)},t}(),Vd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Lr.c)(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(Fd),Ud=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new kd(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,id(this._delegate,function(t,e,n){var r=e,i=Yf("where",t);return new od(i,r,n)}(e,n,r)))}catch(e){throw Pd(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,id(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=Yf("orderBy",t);return new sd(r,n)}(e,n)))}catch(e){throw Pd(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,id(this._delegate,function(t){return Zl("limit",t),new ad("limit",t,"F")}(e)))}catch(e){throw Pd(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,id(this._delegate,function(t){return Zl("limitToLast",t),new ad("limitToLast",t,"L")}(e)))}catch(e){throw Pd(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,id(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ud("startAt",t,!0)}).apply(void 0,e)))}catch(e){throw Pd(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,id(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ud("startAfter",t,!1)}).apply(void 0,e)))}catch(e){throw Pd(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,id(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new cd("endBefore",t,!0)}).apply(void 0,e)))}catch(e){throw Pd(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,id(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new cd("endAt",t,!1)}).apply(void 0,e)))}catch(e){throw Pd(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return cf(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Jl(t,rf);var e=Jl(t.firestore,ff),n=df(e),r=new bd(e);return function(t,e){var n=this,r=new xa;return t.asyncQueue.enqueueAndForget(function(){return Object(Lr.b)(n,void 0,void 0,function(){var n;return Object(Lr.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(Lr.b)(this,void 0,void 0,function(){var r,i,o,s,a;return Object(Lr.d)(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,ac(t,e,!0)];case 1:return a=u.sent(),r=new Mh(e,a.Bn),i=r._o(a.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=u.sent(),a=Ih(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}})})},[4,Cl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t._query).then(function(n){return new Zf(e,r,t,n)})}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Jl(t,rf);var e=Jl(t.firestore,ff),n=df(e),r=new bd(e);return Ll(n,t._query,{source:"server"}).then(function(n){return new Zf(e,r,t,n)})}(this._delegate):function(t){t=Jl(t,rf);var e=Jl(t.firestore,ff),n=df(e),r=new bd(e);return nd(t._query),Ll(n,t._query).then(function(n){return new Zf(e,r,t,n)})}(this._delegate)).then(function(t){return new Bd(e.firestore,new Zf(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))})},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Ld(e),i=Md(e,function(e){return new Bd(t.firestore,new Zf(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))});return Id(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,this._delegate.withConverter(e?jd.eu(this.firestore,e):null))},t}(),qd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new Vd(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),Bd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new Ud(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map(function(e){return new Vd(t._firestore,e)})},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map(function(t){return new qd(e._firestore,t)})},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach(function(r){t.call(e,new Vd(n._firestore,r))})},t.prototype.isEqual=function(t){return ed(this._delegate,t._delegate)},t}(),Kd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return Object(Lr.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new Rd(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Rd(this.firestore,void 0===t?af(this._delegate):af(this._delegate,t))}catch(t){throw Pd(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Jl(t.firestore,ff),r=af(t),i=yd(t.converter,e);return Ed(n,[Af(Df(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,Uo.exists(!1))]).then(function(){return r})}(this._delegate,t).then(function(t){return new Rd(e.firestore,t)})},e.prototype.isEqual=function(t){return uf(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,this._delegate.withConverter(t?jd.eu(this.firestore,t):null))},e}(Ud);function Gd(t){return Jl(t,nf)}var zd,Qd=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(gf.bind.apply(gf,Object(Lr.f)([void 0],t)))}return t.documentId=function(){return new t(ui.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=Object(O.h)(t))instanceof gf&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),Hd=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new Cf("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new Nf("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new xf("arrayUnion",t)}).apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new jf("arrayRemove",t)}).apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new Rf("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),Wd=n("/6Yf"),Yd={Firestore:Nd,GeoPoint:wf,Timestamp:ti,Blob:Dd,Transaction:Cd,WriteBatch:xd,DocumentReference:Rd,DocumentSnapshot:Fd,Query:Ud,QueryDocumentSnapshot:Vd,QuerySnapshot:Bd,CollectionReference:Kd,FieldPath:Qd,FieldValue:Hd,setLogLevel:function(t){Ur.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new Wd.a("firestore",function(t){return function(t,e){return new Nd(t,new ff(t,e),new Ad)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},Yd)))})(zd=_.a),zd.registerVersion("@firebase/firestore","2.3.6");var Xd=n("UbJi");function $d(t,e){return function(t,e=l.b){return new f.a(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{null!=r&&r()}})}(t,e)}function Jd(t,e){return $d(t,e).pipe(Object(g.a)(t=>({payload:t,type:"query"})))}function Zd(t,e){return Jd(t,e).pipe(Object(y.a)(void 0),Object(v.a)(),Object(g.a)(([t,e])=>{const n=e.payload.docChanges(),r=n.map(t=>({type:t.type,payload:t}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(e.payload.metadata)&&e.payload.docs.forEach((e,i)=>{const o=n.find(t=>t.doc.ref.isEqual(e.ref)),s=null==t?void 0:t.payload.docs.find(t=>t.ref.isEqual(e.ref));o&&JSON.stringify(o.doc.metadata)===JSON.stringify(e.metadata)||!o&&s&&JSON.stringify(s.metadata)===JSON.stringify(e.metadata)||r.push({type:"modified",payload:{oldIndex:i,newIndex:i,type:"modified",doc:e}})}),r}))}function tp(t,e,n){return Zd(t,n).pipe(Object(m.a)((t,n)=>function(t,e,n){return e.forEach(e=>{n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":if(!t[e.newIndex]||!t[e.newIndex].doc.ref.isEqual(e.doc.ref))return ep(t,e.newIndex,0,e);break;case"modified":if(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}return ep(t,e.newIndex,1,e)}break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return ep(t,e.oldIndex,1)}return t}(t,e))}),t}(t,n.map(t=>t.payload),e),[]),Object(b.a)(),Object(g.a)(t=>t.map(t=>({type:t.type,payload:t}))))}function ep(t,e,n,...r){const i=t.slice();return i.splice(e,n,...r),i}function np(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}class rp{constructor(t,e,n){this.ref=t,this.query=e,this.afs=n}stateChanges(t){let e=Zd(this.query,this.afs.schedulers.outsideAngular);return t&&t.length>0&&(e=e.pipe(Object(g.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)))),e.pipe(Object(y.a)(void 0),Object(v.a)(),Object(w.a)(([t,e])=>e.length>0||!t),Object(g.a)(([t,e])=>e),this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(m.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=np(t);return tp(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return Jd(this.query,this.afs.schedulers.outsideAngular).pipe(Object(g.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(d.a)(this.query.get(t)).pipe(Object(I.b)(this.afs.schedulers.insideAngular))}add(t){return this.ref.add(t)}doc(t){return new ip(this.ref.doc(t),this.afs)}}class ip{constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const n=this.ref.collection(t),{ref:r,query:i}=hp(n,e);return new rp(r,i,this.afs)}snapshotChanges(){return $d(this.ref,this.afs.schedulers.outsideAngular).pipe(Object(y.a)(void 0),Object(v.a)(),Object(g.a)(([t,e])=>e.exists?(null==t?void 0:t.exists)?{payload:e,type:"modified"}:{payload:e,type:"added"}:{payload:e,type:"removed"})).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return this.snapshotChanges().pipe(Object(g.a)(({payload:e})=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data()))}get(t){return Object(d.a)(this.ref.get(t)).pipe(Object(I.b)(this.afs.schedulers.insideAngular))}}class op{constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?Zd(this.query,this.afs.schedulers.outsideAngular).pipe(Object(g.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)),Object(w.a)(t=>t.length>0),this.afs.keepUnstableUntilFirst):Zd(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(m.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=np(t);return tp(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return Jd(this.query,this.afs.schedulers.outsideAngular).pipe(Object(g.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign({[t.idField]:e.id},e.data()):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(d.a)(this.query.get(t)).pipe(Object(I.b)(this.afs.schedulers.insideAngular))}}const sp=new i.s("angularfire2.enableFirestorePersistence"),ap=new i.s("angularfire2.firestore.persistenceSettings"),up=new i.s("angularfire2.firestore.settings"),cp=new i.s("angularfire2.firestore.use-emulator");function hp(t,e=(t=>t)){return{query:e(t),ref:t}}let lp=(()=>{class t{constructor(t,e,n,i,o,s,a,u,c){this.schedulers=new E.d(s),this.keepUnstableUntilFirst=Object(E.h)(this.schedulers);const h=Object(E.g)(t,s,e);!T.a.auth&&c&&Object(E.j)();const l=u;[this.firestore,this.persistenceEnabled$]=Object(E.f)(`${h.name}.firestore`,"AngularFirestore",h,()=>{const t=s.runOutsideAngular(()=>h.firestore());if(i&&t.settings(i),l&&t.useEmulator(...l),n&&!Object(r.u)(o)){const e=()=>{try{return Object(d.a)(t.enablePersistence(a||void 0).then(()=>!0,()=>!1))}catch(zd){return"undefined"!=typeof console&&console.warn(zd),Object(p.a)(!1)}};return[t,s.runOutsideAngular(e)]}return[t,Object(p.a)(!1)]},[i,l,n])}collection(t,e){let n;n="string"==typeof t?this.firestore.collection(t):t;const{ref:r,query:i}=hp(n,e),o=this.schedulers.ngZone.run(()=>r);return new rp(o,i,this)}collectionGroup(t,e){const n=e||(t=>t),r=this.firestore.collectionGroup(t);return new op(n(r),this)}doc(t){let e;e="string"==typeof t?this.firestore.doc(t):t;const n=this.schedulers.ngZone.run(()=>e);return new ip(n,this)}createId(){return this.firestore.collection("_").doc().id}}return t.\u0275fac=function(e){return new(e||t)(i.Zb(E.c),i.Zb(E.b,8),i.Zb(sp,8),i.Zb(up,8),i.Zb(i.D),i.Zb(i.B),i.Zb(ap,8),i.Zb(cp,8),i.Zb(Xd.b,8))},t.\u0275prov=i.Lb({factory:function(){return new t(i.Zb(E.c),i.Zb(E.b,8),i.Zb(sp,8),i.Zb(up,8),i.Zb(i.D),i.Zb(i.B),i.Zb(ap,8),i.Zb(cp,8),i.Zb(Xd.b,8))},token:t,providedIn:"any"}),t})();var fp=n("kmnG"),dp=n("qFsG"),pp=n("3Pt+");let yp=(()=>{class t{constructor(t,e,n,r,i){this.dialogRef=t,this.data=e,this.api=n,this.db=r,this.auth=i,this.userData={}}ngOnInit(){this.auth.user.subscribe(t=>{this.userData=t})}saveData(){if(this.loading=!0,null==this.data.id){let t=(new Date).getTime().toString();this.data.uid=this.userData.uid,this.db.collection("employees").doc(t).set(this.data).then(t=>{this.dialogRef.close(this.data),this.loading=!1}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak Dapat Menyimpan Data")})}else this.db.collection("employees/").doc(this.data.id).update(this.data).then(t=>{this.dialogRef.close(this.data),this.loading=!1}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak Dapat Mengupdate Data")})}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(c.f),i.Pb(c.a),i.Pb(h.a),i.Pb(lp),i.Pb(Xd.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-employee-detail"]],decls:36,vars:9,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["appearance","outline",2,"width","100%"],["matInput","",3,"ngModel","ngModelChange"],["mat-dialog-action","","align","end"],["mat-button","","mat-dialog-close",""],["mat-flat-button","",3,"disabled","click"]],template:function(t,e){1&t&&(i.Vb(0,"h3",0),i.zc(1," Detail\n"),i.Ub(),i.Vb(2,"div",1),i.Vb(3,"mat-form-field",2),i.Vb(4,"mat-label"),i.zc(5,"Name"),i.Ub(),i.Vb(6,"input",3),i.cc("ngModelChange",function(t){return e.data.name=t}),i.Ub(),i.Ub(),i.Vb(7,"mat-form-field",2),i.Vb(8,"mat-label"),i.zc(9,"Address"),i.Ub(),i.Vb(10,"input",3),i.cc("ngModelChange",function(t){return e.data.address=t}),i.Ub(),i.Ub(),i.Vb(11,"mat-form-field",2),i.Vb(12,"mat-label"),i.zc(13,"Age"),i.Ub(),i.Vb(14,"input",3),i.cc("ngModelChange",function(t){return e.data.age=t}),i.Ub(),i.Ub(),i.Vb(15,"mat-form-field",2),i.Vb(16,"mat-label"),i.zc(17,"Religion"),i.Ub(),i.Vb(18,"input",3),i.cc("ngModelChange",function(t){return e.data.religion=t}),i.Ub(),i.Ub(),i.Vb(19,"mat-form-field",2),i.Vb(20,"mat-label"),i.zc(21,"Birthday"),i.Ub(),i.Vb(22,"input",3),i.cc("ngModelChange",function(t){return e.data.birthday=t}),i.Ub(),i.Ub(),i.Vb(23,"mat-form-field",2),i.Vb(24,"mat-label"),i.zc(25,"Gender"),i.Ub(),i.Vb(26,"input",3),i.cc("ngModelChange",function(t){return e.data.gender=t}),i.Ub(),i.Ub(),i.Vb(27,"mat-form-field",2),i.Vb(28,"mat-label"),i.zc(29,"Phone"),i.Ub(),i.Vb(30,"input",3),i.cc("ngModelChange",function(t){return e.data.phone=t}),i.Ub(),i.Ub(),i.Ub(),i.Vb(31,"div",4),i.Vb(32,"button",5),i.zc(33,"Batal"),i.Ub(),i.Vb(34,"button",6),i.cc("click",function(){return e.saveData()}),i.zc(35),i.Ub(),i.Ub()),2&t&&(i.Eb(6),i.lc("ngModel",e.data.name),i.Eb(4),i.lc("ngModel",e.data.address),i.Eb(4),i.lc("ngModel",e.data.age),i.Eb(4),i.lc("ngModel",e.data.religion),i.Eb(4),i.lc("ngModel",e.data.birthday),i.Eb(4),i.lc("ngModel",e.data.gender),i.Eb(4),i.lc("ngModel",e.data.phone),i.Eb(4),i.lc("disabled",e.loading),i.Eb(1),i.Ac(e.loading?"Menyimpan..":"Simpan"))},directives:[c.g,c.d,fp.b,fp.e,dp.b,pp.c,pp.j,pp.l,s.a,c.c],styles:[""]}),t})();var vp=n("Xa2L"),gp=n("Wp6s");function mp(t,e){1&t&&(i.Vb(0,"div",2),i.Qb(1,"mat-spinner"),i.Ub())}function bp(t,e){if(1&t){const t=i.Wb();i.Vb(0,"tr"),i.Vb(1,"td"),i.zc(2),i.Ub(),i.Vb(3,"td"),i.zc(4),i.Ub(),i.Vb(5,"td"),i.zc(6),i.Ub(),i.Vb(7,"td"),i.zc(8),i.Ub(),i.Vb(9,"td"),i.zc(10),i.Ub(),i.Vb(11,"td"),i.zc(12),i.Ub(),i.Vb(13,"td"),i.zc(14),i.Ub(),i.Vb(15,"td"),i.zc(16),i.Ub(),i.Vb(17,"td",7),i.Vb(18,"button",9),i.cc("click",function(){i.sc(t);const n=e.$implicit,r=e.index;return i.gc(2).EmployeeDetail(n,r)}),i.zc(19,"Edit"),i.Ub(),i.Vb(20,"button",10),i.cc("click",function(){i.sc(t);const n=e.$implicit,r=e.index;return i.gc(2).DeleteEmployee(n.id,r)}),i.zc(21),i.Ub(),i.Ub(),i.Ub()}if(2&t){const t=e.$implicit,n=e.index,r=i.gc(2);i.Eb(2),i.Ac(n+1),i.Eb(2),i.Ac(t.name),i.Eb(2),i.Ac(t.address),i.Eb(2),i.Ac(t.age),i.Eb(2),i.Ac(t.religion),i.Eb(2),i.Ac(t.birthday),i.Eb(2),i.Ac(t.gender),i.Eb(2),i.Ac(t.phone),i.Eb(4),i.lc("disabled",r.loadingDelete[n]),i.Eb(1),i.Ac(r.loadingDelete[n]?"Menghapus..":"Delete")}}function wp(t,e){if(1&t){const t=i.Wb();i.Vb(0,"mat-card"),i.Vb(1,"mat-card-header"),i.Vb(2,"mat-card-title"),i.zc(3),i.Ub(),i.Ub(),i.Vb(4,"mat-card-content"),i.Vb(5,"div",3),i.Qb(6,"span",4),i.Vb(7,"button",5),i.cc("click",function(){return i.sc(t),i.gc().EmployeeDetail({},-1)}),i.zc(8,"Tambah"),i.Ub(),i.Ub(),i.Qb(9,"br"),i.Vb(10,"table",6),i.Vb(11,"thead"),i.Vb(12,"th"),i.zc(13,"No"),i.Ub(),i.Vb(14,"th"),i.zc(15,"Name"),i.Ub(),i.Vb(16,"th"),i.zc(17,"Address"),i.Ub(),i.Vb(18,"th"),i.zc(19,"Age"),i.Ub(),i.Vb(20,"th"),i.zc(21,"Religion"),i.Ub(),i.Vb(22,"th"),i.zc(23,"Birthday"),i.Ub(),i.Vb(24,"th"),i.zc(25,"Gender"),i.Ub(),i.Vb(26,"th"),i.zc(27,"Phone"),i.Ub(),i.Qb(28,"th",7),i.Ub(),i.Vb(29,"tbody"),i.yc(30,bp,22,10,"tr",8),i.Ub(),i.Ub(),i.Ub(),i.Ub()}if(2&t){const t=i.gc();i.Eb(3),i.Ac(t.title),i.Eb(27),i.lc("ngForOf",t.employees)}}let Ip=(()=>{class t{constructor(t,e,n,r){this.dialog=t,this.api=e,this.auth=n,this.db=r,this.employees={},this.userData={},this.loadingDelete={}}ngOnInit(){this.title="Employees",this.auth.user.subscribe(t=>{this.userData=t,this.getEmployees()})}getEmployees(){this.loading=!0,this.db.collection("employees",t=>t.where("uid","==",this.userData.uid)).valueChanges({idField:"id"}).subscribe(t=>{console.log(t),this.employees=t,this.loading=!1},t=>{this.loading=!1})}EmployeeDetail(t,e){this.dialog.open(yp,{width:"400px",data:t}).afterClosed().subscribe(t=>{})}DeleteEmployee(t,e){confirm("Delete item?")&&this.db.collection("employees").doc(t).delete().then(t=>{this.employees.splice(e,1),this.loadingDelete[e]=!1}).catch(t=>{this.loadingDelete[e]=!1,alert("Tidak dapat menghapus data")})}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(c.b),i.Pb(h.a),i.Pb(Xd.a),i.Pb(lp))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-employee"]],decls:2,vars:2,consts:[["style","height: 300px;","class","uk-flex uk-flex-center uk-flex-middle",4,"ngIf"],[4,"ngIf"],[1,"uk-flex","uk-flex-center","uk-flex-middle",2,"height","300px"],[1,"uk-flex"],[1,"uk-width-expand"],["mat-flat-button","","color","primary",3,"click"],[1,"uk-table","uk-table-middle","uk-table-divider"],["align","right"],[4,"ngFor","ngForOf"],["mat-button","","color","primary",3,"click"],["mat-button","","color","accent",3,"disabled","click"]],template:function(t,e){1&t&&(i.yc(0,mp,2,0,"div",0),i.yc(1,wp,31,2,"mat-card",1)),2&t&&(i.lc("ngIf",e.loading),i.Eb(1),i.lc("ngIf",!e.loading))},directives:[r.k,vp.b,gp.a,gp.c,gp.e,gp.b,s.a,r.j],styles:[""]}),t})(),Ep=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Jb({type:t,selectors:[["app-dashboard"]],decls:2,vars:0,consts:[[2,"text-align","center","margin-top","20%","color","orange"]],template:function(t,e){1&t&&(i.Vb(0,"h1",0),i.zc(1,"========== WELCOME TO MY WEB =========="),i.Ub())},styles:[""]}),t})();var Tp=n("hctd");const _p=[{path:"",component:u,children:[{path:"employee",component:Ip},{path:"dashboard",component:Ep},{path:"",pathMatch:"full",redirectTo:"/admin/dashboard"}]}];let Op=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.Nb({type:t}),t.\u0275inj=i.Mb({imports:[[r.c,o.c.forChild(_p),Tp.a,pp.f]]}),t})()}}]);