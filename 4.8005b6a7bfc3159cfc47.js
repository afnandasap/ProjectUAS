(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{jkDv:function(t,e,n){"use strict";n.r(e),n.d(e,"AdminModule",function(){return _p});var r=n("ofXK"),i=n("fXoL"),o=n("tyNb"),s=n("/t3+"),a=n("bTqV");let u=(()=>{class t{constructor(t){this.router=t,this.loading=!0}ngOnInit(){}logout(){confirm("Keluar aplikasi?")&&(localStorage.removeItem("appToken"),this.router.navigate(["/login"]))}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(o.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-admin"]],decls:11,vars:0,consts:[["mat-button","",2,"margin-left","10px","background-color","rgb(255, 15, 15)","color","rgb(255, 255, 255)",3,"click"],["mat-button","","routerLink","/admin/employee",2,"background-color","rgb(243, 243, 243)","color","rgb(0, 0, 0)"],["mat-button","","routerLink","/admin/image",2,"background-color","rgb(243, 243, 243)","color","rgb(0, 0, 0)"],["src","https://i.pinimg.com/originals/81/9e/ac/819eac6d9f79c1978c4a5c630707424f.jpg","width","30","height","30",2,"border-radius","50%","margin-left","82%"]],template:function(t,e){1&t&&(i.Tb(0),i.Vb(1,"p"),i.Vb(2,"mat-toolbar"),i.Vb(3,"button",0),i.cc("click",function(){return e.logout()}),i.zc(4,"LOGOUT"),i.Ub(),i.Vb(5,"button",1),i.zc(6,"DAFTAR HARGA"),i.Ub(),i.Vb(7,"button",2),i.zc(8,"PRODUK"),i.Ub(),i.Qb(9,"img",3),i.Ub(),i.Ub(),i.Qb(10,"router-outlet"),i.Sb())},directives:[s.a,a.a,o.b,o.d],styles:[""]}),t})();var c=n("hctd"),h=n("3Pt+"),l=n("NFeN");let f=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Jb({type:t,selectors:[["app-image"]],decls:79,vars:0,consts:[[1,"card",2,"width","18rem","margin-left","80px"],["src","https://i.pinimg.com/originals/f0/e8/13/f0e813e312a5a26ab5f2970d191998f6.jpg","alt","...",1,"card-img-top"],[1,"card-body"],[1,"card-title",2,"font-size","20px","text-align","center"],[1,"card-text",2,"text-align","justify","text-indent","0.2in","font-size","15px"],["href","https://www.instagram.com/ai.vektorjogja/",1,"btn","btn-primary"],["src","https://i.pinimg.com/originals/0d/25/31/0d2531e23fe3a937b20c4ce82299eefe.jpg","alt","...",1,"card-img-top"],["src","https://i.pinimg.com/originals/08/85/5e/08855ed2e7bc378037e115ae766914db.jpg","alt","...",1,"card-img-top"],["src","https://i.pinimg.com/originals/e9/cf/9c/e9cf9c85e0be469403fad1c63af254ec.jpg","alt","...",1,"card-img-top"],["src","https://i.pinimg.com/originals/8f/62/fb/8f62fb48000c47c36e19a7ca5c55a5c4.jpg","alt","...",1,"card-img-top"],["src","https://i.pinimg.com/originals/f4/d9/ef/f4d9ef28efc341dfa99fca1fe161aa58.jpg","alt","...",1,"card-img-top"],["src","https://i.pinimg.com/originals/6c/cc/9d/6ccc9d3a45d9458533400796a4851eae.jpg","alt","...",1,"card-img-top"]],template:function(t,e){1&t&&(i.Qb(0,"br"),i.Qb(1,"br"),i.Vb(2,"div",0),i.Qb(3,"img",1),i.Vb(4,"div",2),i.Vb(5,"h5",3),i.zc(6,"Vektor Art"),i.Ub(),i.Vb(7,"p",4),i.zc(8,"Sebuah karya seni yang dibuat dengan setulus hati, sehingga menciptakan karya yang luar biasa"),i.Ub(),i.Vb(9,"mat-icon"),i.zc(10,"shopping_cart"),i.Ub(),i.Vb(11,"a",5),i.zc(12,"Go Order"),i.Ub(),i.Ub(),i.Ub(),i.Vb(13,"div",0),i.Qb(14,"img",6),i.Vb(15,"div",2),i.Vb(16,"h5",3),i.zc(17,"Vektor Art"),i.Ub(),i.Vb(18,"p",4),i.zc(19,"Sebuah karya seni yang dibuat dengan setulus hati, sehingga menciptakan karya yang luar biasa"),i.Ub(),i.Vb(20,"mat-icon"),i.zc(21,"shopping_cart"),i.Ub(),i.Vb(22,"a",5),i.zc(23,"Go Order"),i.Ub(),i.Ub(),i.Ub(),i.Vb(24,"div",0),i.Qb(25,"img",7),i.Vb(26,"div",2),i.Vb(27,"h5",3),i.zc(28,"Vektor Art"),i.Ub(),i.Vb(29,"p",4),i.zc(30,"Sebuah karya seni yang dibuat dengan setulus hati, sehingga menciptakan karya yang luar biasa"),i.Ub(),i.Vb(31,"mat-icon"),i.zc(32,"shopping_cart"),i.Ub(),i.Vb(33,"a",5),i.zc(34,"Go Order"),i.Ub(),i.Ub(),i.Ub(),i.Vb(35,"div",0),i.Qb(36,"img",8),i.Vb(37,"div",2),i.Vb(38,"h5",3),i.zc(39,"Vektor Art"),i.Ub(),i.Vb(40,"p",4),i.zc(41,"Sebuah karya seni yang dibuat dengan setulus hati, sehingga menciptakan karya yang luar biasa"),i.Ub(),i.Vb(42,"mat-icon"),i.zc(43,"shopping_cart"),i.Ub(),i.Vb(44,"a",5),i.zc(45,"Go Order"),i.Ub(),i.Ub(),i.Ub(),i.Vb(46,"div",0),i.Qb(47,"img",9),i.Vb(48,"div",2),i.Vb(49,"h5",3),i.zc(50,"Vektor Art"),i.Ub(),i.Vb(51,"p",4),i.zc(52,"Sebuah karya seni yang dibuat dengan setulus hati, sehingga menciptakan karya yang luar biasa"),i.Ub(),i.Vb(53,"mat-icon"),i.zc(54,"shopping_cart"),i.Ub(),i.Vb(55,"a",5),i.zc(56,"Go Order"),i.Ub(),i.Ub(),i.Ub(),i.Vb(57,"div",0),i.Qb(58,"img",10),i.Vb(59,"div",2),i.Vb(60,"h5",3),i.zc(61,"Vektor Art"),i.Ub(),i.Vb(62,"p",4),i.zc(63,"Sebuah karya seni yang dibuat dengan setulus hati, sehingga menciptakan karya yang luar biasa"),i.Ub(),i.Vb(64,"mat-icon"),i.zc(65,"shopping_cart"),i.Ub(),i.Vb(66,"a",5),i.zc(67,"Go Order"),i.Ub(),i.Ub(),i.Ub(),i.Vb(68,"div",0),i.Qb(69,"img",11),i.Vb(70,"div",2),i.Vb(71,"h5",3),i.zc(72,"Vektor Art"),i.Ub(),i.Vb(73,"p",4),i.zc(74,"Sebuah karya seni yang dibuat dengan setulus hati, sehingga menciptakan karya yang luar biasa"),i.Ub(),i.Vb(75,"mat-icon"),i.zc(76,"shopping_cart"),i.Ub(),i.Vb(77,"a",5),i.zc(78,"Go Order"),i.Ub(),i.Ub(),i.Ub())},directives:[l.a],styles:[".card[_ngcontent-%COMP%]{display:inline-block}"]}),t})();var d=n("0IaG"),p=n("D0XW"),y=n("HDdC"),g=n("Cfvw"),m=n("LRne"),v=n("JX91"),b=n("Zy1z"),w=n("lJxs"),I=n("Kqap"),E=n("/uUt"),T=n("pLZG"),_=n("pxpQ"),O=n("spgP"),S=n("Jgta"),D=n("zIRd"),A=n("qOnz"),N=n("q/0M"),k=function(t,e){return(k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function x(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var C,j="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},R=R||{},P=j||self;function L(){}function V(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function U(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var M="closure_uid_"+(1e9*Math.random()>>>0),F=0;function q(t,e,n){return t.call.apply(t.bind,arguments)}function B(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function K(t,e,n){return(K=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?q:B).apply(null,arguments)}function z(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function G(){return Date.now()}function Q(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Pb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function H(){this.j=this.j,this.i=this.i}H.prototype.j=!1,H.prototype.ka=function(){!this.j&&(this.j=!0,this.H(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,M)&&t[M]||(t[M]=++F)}(this)},H.prototype.H=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var W=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Y=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function X(t){return Array.prototype.concat.apply([],arguments)}function $(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function J(t){return/^[\s\xa0]*$/.test(t)}var Z,tt=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function et(t,e){return-1!=t.indexOf(e)}function nt(t,e){return t<e?-1:t>e?1:0}t:{var rt=P.navigator;if(rt){var it=rt.userAgent;if(it){Z=it;break t}}Z=""}function ot(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function st(t){var e={};for(var n in t)e[n]=t[n];return e}var at="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ut(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<at.length;o++)n=at[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ct(t){return ct[" "](t),t}ct[" "]=L;var ht,lt,ft=et(Z,"Opera"),dt=et(Z,"Trident")||et(Z,"MSIE"),pt=et(Z,"Edge"),yt=pt||dt,gt=et(Z,"Gecko")&&!(et(Z.toLowerCase(),"webkit")&&!et(Z,"Edge"))&&!(et(Z,"Trident")||et(Z,"MSIE"))&&!et(Z,"Edge"),mt=et(Z.toLowerCase(),"webkit")&&!et(Z,"Edge");function vt(){var t=P.document;return t?t.documentMode:void 0}t:{var bt="",wt=(lt=Z,gt?/rv:([^\);]+)(\)|;)/.exec(lt):pt?/Edge\/([\d\.]+)/.exec(lt):dt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(lt):mt?/WebKit\/(\S+)/.exec(lt):ft?/(?:Version)[ \/]?(\S+)/.exec(lt):void 0);if(wt&&(bt=wt?wt[1]:""),dt){var It=vt();if(null!=It&&It>parseFloat(bt)){ht=String(It);break t}}ht=bt}var Et={};function Tt(t){return function(t,e){var n=Et;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,function(){for(var e=0,n=tt(String(ht)).split("."),r=tt(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=nt(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||nt(0==s[2].length,0==a[2].length)||nt(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e})}var _t=P.document&&dt&&(vt()||parseInt(ht,10))||void 0,Ot=!dt||9<=Number(_t),St=dt&&!Tt("9"),Dt=function(){if(!P.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{P.addEventListener("test",L,e),P.removeEventListener("test",L,e)}catch(n){}return t}();function At(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Nt(t,e){if(At.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(gt){t:{try{ct(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:kt[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}At.prototype.b=function(){this.defaultPrevented=!0},Q(Nt,At);var kt={2:"touch",3:"pen",4:"mouse"};Nt.prototype.b=function(){Nt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,St)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var xt="closure_listenable_"+(1e6*Math.random()|0),Ct=0;function jt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.da=i,this.key=++Ct,this.Y=this.Z=!1}function Rt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function Pt(t){this.src=t,this.a={},this.b=0}function Lt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=W(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Rt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Vt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.da==r)return i}return-1}Pt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Vt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new jt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Ut="closure_lm_"+(1e6*Math.random()|0),Mt={};function Ft(t,e,n,r,i){if(r&&r.once)return Bt(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ft(t,e[o],n,r,i);return null}return n=Xt(n),t&&t[xt]?t.wa(e,n,U(r)?!!r.capture:!!r,i):qt(t,e,n,!1,r,i)}function qt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=U(i)?!!i.capture:!!i;if(s&&!Ot)return null;var a=Wt(t);if(a||(t[Ut]=a=new Pt(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=Ht,e=Ot?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Dt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Gt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Bt(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Bt(t,e[o],n,r,i);return null}return n=Xt(n),t&&t[xt]?t.xa(e,n,U(r)?!!r.capture:!!r,i):qt(t,e,n,!0,r,i)}function Kt(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Kt(t,e[o],n,r,i);else r=U(r)?!!r.capture:!!r,n=Xt(n),t&&t[xt]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=Vt(o=t.a[e],n,r,i))&&(Rt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=Wt(t))&&(e=t.a[e.toString()],t=-1,e&&(t=Vt(e,n,r,i)),(n=-1<t?e[t]:null)&&zt(n))}function zt(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[xt])Lt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Gt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Wt(e))?(Lt(n,t),0==n.b&&(n.src=null,e[Ut]=null)):Rt(t)}}}function Gt(t){return t in Mt?Mt[t]:Mt[t]="on"+t}function Qt(t,e){var n=t.listener,r=t.da||t.src;return t.Z&&zt(t),n.call(r,e)}function Ht(t,e){if(t.Y)return!0;if(!Ot){if(!e)t:{e=["window","event"];for(var n=P,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Qt(t,e=new Nt(e,this))}return Qt(t,new Nt(e,this))}function Wt(t){return(t=t[Ut])instanceof Pt?t:null}var Yt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Xt(t){return"function"==typeof t?t:(t[Yt]||(t[Yt]=function(e){return t.handleEvent(e)}),t[Yt])}function $t(){H.call(this),this.c=new Pt(this),this.J=this,this.D=null}function Jt(t,e){var n,r=t.D;if(r)for(n=[];r;r=r.D)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new At(e,t);else if(e instanceof At)e.target=e.target||t;else{var i=e;ut(e=new At(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=Zt(s,r,!0,e)&&i}if(i=Zt(s=e.a=t,r,!0,e)&&i,i=Zt(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Zt(s=e.a=n[o],r,!1,e)&&i}function Zt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var a=s.listener,u=s.da||s.src;s.Z&&Lt(t.c,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}Q($t,H),$t.prototype[xt]=!0,(C=$t.prototype).addEventListener=function(t,e,n,r){Ft(this,t,e,n,r)},C.removeEventListener=function(t,e,n,r){Kt(this,t,e,n,r)},C.H=function(){if($t.X.H.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Rt(n[r]);delete e.a[t],e.b--}}this.D=null},C.wa=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},C.xa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var te=P.JSON.stringify;function ee(){this.b=this.a=null}var ne,re=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())(function(){return new oe},function(t){t.reset()});function ie(){var t=ce,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function oe(){this.next=this.b=this.a=null}function se(t){P.setTimeout(function(){throw t},0)}function ae(t,e){ne||function(){var t=P.Promise.resolve(void 0);ne=function(){t.then(he)}}(),ue||(ne(),ue=!0),ce.add(t,e)}ee.prototype.add=function(t,e){var n=re.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},oe.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},oe.prototype.reset=function(){this.next=this.b=this.a=null};var ue=!1,ce=new ee;function he(){for(var t;t=ie();){try{t.a.call(t.b)}catch(n){se(n)}var e=re;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}ue=!1}function le(t,e){$t.call(this),this.b=t||1,this.a=e||P,this.f=K(this.eb,this),this.g=G()}function fe(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function de(t,e,n){if("function"==typeof t)n&&(t=K(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=K(t.handleEvent,t)}return 2147483647<Number(e)?-1:P.setTimeout(t,e||0)}function pe(t){t.a=de(function(){t.a=null,t.c&&(t.c=!1,pe(t))},t.h);var e=t.b;t.b=null,t.g.apply(null,e)}Q(le,$t),(C=le.prototype).aa=!1,C.M=null,C.eb=function(){if(this.aa){var t=G()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Jt(this,"tick"),this.aa&&(fe(this),this.start()))}},C.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=G())},C.H=function(){le.X.H.call(this),fe(this),delete this.a};var ye=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}k(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:pe(this)},e.prototype.H=function(){t.prototype.H.call(this),this.a&&(P.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(H);function ge(t){H.call(this),this.b=t,this.a={}}Q(ge,H);var me=[];function ve(t,e,n,r){Array.isArray(n)||(n&&(me[0]=n.toString()),n=me);for(var i=0;i<n.length;i++){var o=Ft(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function be(t){ot(t.a,function(t,e){this.a.hasOwnProperty(e)&&zt(t)},t),t.a={}}function we(){this.a=!0}function Ie(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return te(n)}catch(a){return e}}(t,n)+(r?" "+r:"")})}ge.prototype.H=function(){ge.X.H.call(this),be(this)},ge.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},we.prototype.info=function(){};var Ee={},Te=null;function _e(){return Te=Te||new $t}function Oe(t){At.call(this,Ee.Ga,t)}function Se(t){var e=_e();Jt(e,new Oe(e,t))}function De(t,e){At.call(this,Ee.STAT_EVENT,t),this.stat=e}function Ae(t){var e=_e();Jt(e,new De(e,t))}function Ne(t){At.call(this,Ee.Ha,t)}function ke(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return P.setTimeout(function(){t()},e)}Ee.Ga="serverreachability",Q(Oe,At),Ee.STAT_EVENT="statevent",Q(De,At),Ee.Ha="timingevent",Q(Ne,At);var xe={NO_ERROR:0,fb:1,sb:2,rb:3,mb:4,qb:5,tb:6,Ea:7,TIMEOUT:8,wb:9},Ce={kb:"complete",Gb:"success",Fa:"error",Ea:"abort",yb:"ready",zb:"readystatechange",TIMEOUT:"timeout",ub:"incrementaldata",xb:"progress",nb:"downloadprogress",Ob:"uploadprogress"};function je(){}function Re(){}je.prototype.b=null;var Pe,Le={OPEN:"a",jb:"b",Fa:"c",vb:"d"};function Ve(){At.call(this,"d")}function Ue(){At.call(this,"c")}function Me(){}function Fe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ge(this),this.P=qe,this.R=new le(t=yt?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.G=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}Q(Ve,At),Q(Ue,At),Q(Me,je),Me.prototype.a=function(){return new XMLHttpRequest},Me.prototype.c=function(){return{}},Pe=new Me;var qe=45e3,Be={},Ke={};function ze(t,e,n){t.G=1,t.i=dn(an(e)),t.j=n,t.I=!0,Ge(t,null)}function Ge(t,e){t.u=G(),We(t),t.l=an(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),Sn(n.b,"t",r),t.D=0,t.a=wr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ye(K(t.Da,t,t.a),t.O)),ve(t.J,t.a,"readystatechange",t.bb),e=t.B?st(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),Se(1),function(t,e,n,r,i,o){t.info(function(){if(t.a)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&"type"==l[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.c,t.m,t.l,t.f,t.S,t.j)}function Qe(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=He(t,n);if(i==Ke){4==e&&(t.h=4,Ae(14),r=!1),Ie(t.c,t.f,null,"[Incomplete Response]");break}if(i==Be){t.h=4,Ae(15),Ie(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}Ie(t.c,t.f,i,null),Ze(t,i)}4==e&&0==n.length&&(t.h=1,Ae(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),fr(e),e.F=!0,Ae(11))):(Ie(t.c,t.f,n,"[Invalid Chunked Response]"),Je(t),$e(t))}function He(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?Ke:(n=Number(e.substring(n,r)),isNaN(n)?Be:(r+=1)+n>e.length?Ke:(e=e.substr(r,n),t.D=r+n,e))}function We(t){t.T=G()+t.P,Ye(t,t.P)}function Ye(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ke(K(t.$a,t),e)}function Xe(t){t.o&&(P.clearTimeout(t.o),t.o=null)}function $e(t){0==t.g.v||t.A||yr(t.g,t)}function Je(t){Xe(t);var e=t.F;e&&"function"==typeof e.ka&&e.ka(),t.F=null,fe(t.R),be(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ka())}function Ze(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||jn(n.b,t)))if(n.I=t.N,!t.C&&jn(n.b,t)&&3==n.v){try{var r=n.la.a.parse(e)}catch(_d){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;pr(n),rr(n)}lr(n),Ae(18)}}else n.pa=i[1],0<n.pa-n.P&&37500>i[2]&&n.G&&0==n.o&&!n.m&&(n.m=ke(K(n.Xa,n),6e3));if(1>=Cn(n.b)&&n.fa){try{n.fa()}catch(_d){}n.fa=void 0}}else mr(n,11)}else if((t.C||n.a==t)&&pr(n),!J(e))for(e=r=n.la.a.parse(e),r=0;r<e.length;r++)if(n.P=(i=e[r])[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ha=i[2];var o=i[3];null!=o&&(n.ia=o,n.c.info("VER="+n.ia));var s=i[4];null!=s&&(n.qa=s,n.c.info("SVER="+n.qa));var a=i[5];if(null!=a&&"number"==typeof a&&0<a){var u=1.5*a;n.D=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=u.b;!l.a&&(et(h,"spdy")||et(h,"quic")||et(h,"h2"))&&(l.f=l.g,l.a=new Set,l.b&&(Rn(l,l.b),l.b=null))}if(u.A){var f=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.oa=f,fn(u.B,u.A,f))}}n.v=3,n.f&&n.f.ua(),n.U&&(n.N=G()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var d=t;if((u=n).ma=br(u,u.C?u.ha:null,u.ga),d.C){Pn(u.b,d);var p=d,y=u.D;y&&p.setTimeout(y),p.o&&(Xe(p),We(p)),u.a=d}else hr(u);0<n.g.length&&sr(n)}else"stop"!=i[0]&&"close"!=i[0]||mr(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?mr(n,7):nr(n):"noop"!=i[0]&&n.f&&n.f.ta(i),n.o=0);Se(4)}catch(_d){}}function tn(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(V(t)||"string"==typeof t)Y(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(V(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(V(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function en(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof en)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function nn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];rn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)rn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function rn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(C=Fe.prototype).setTimeout=function(t){this.P=t},C.bb=function(t){t=t.target;var e=this.F;e&&3==Jn(t)?e.f():this.Da(t)},C.Da=function(t){try{if(t==this.a)t:{var e=Jn(this.a),n=this.a.va(),r=this.a.W();if(!(3>e||3==e&&!yt&&!this.a.$())){this.A||4!=e||7==n||Se(8==n||0>=r?3:2),Xe(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,a=this.a;if((s=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!J(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.h=3,Ae(12),Je(this),$e(this);break t}Ie(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ze(this,u)}this.I?(Qe(this,e,o),yt&&this.b&&3==e&&(ve(this.J,this.R,"tick",this.ab),this.R.start())):(Ie(this.c,this.f,o,null),Ze(this,o)),4==e&&Je(this),this.b&&!this.A&&(4==e?yr(this.g,this):(this.b=!1,We(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Ae(12)):(this.h=0,Ae(13)),Je(this),$e(this)}}}catch(c){}},C.ab=function(){if(this.a){var t=Jn(this.a),e=this.a.$();this.D<e.length&&(Xe(this),Qe(this,t,e),this.b&&4!=t&&We(this))}},C.cancel=function(){this.A=!0,Je(this)},C.$a=function(){this.o=null;var t=G();0<=t-this.T?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.c,this.l),2!=this.G&&(Se(3),Ae(17)),Je(this),this.h=2,$e(this)):Ye(this,this.T-t)},(C=en.prototype).K=function(){nn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},C.L=function(){return nn(this),this.a.concat()},C.get=function(t,e){return rn(this.b,t)?this.b[t]:e},C.set=function(t,e){rn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},C.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var on=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function sn(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof sn){this.a=void 0!==e?e:t.a,un(this,t.f),this.j=t.j,cn(this,t.c),hn(this,t.h),this.g=t.g,e=t.b;var n=new En;n.c=e.c,e.a&&(n.a=new en(e.a),n.b=e.b),ln(this,n),this.i=t.i}else t&&(n=String(t).match(on))?(this.a=!!e,un(this,n[1]||"",!0),this.j=pn(n[2]||""),cn(this,n[3]||"",!0),hn(this,n[4]),this.g=pn(n[5]||"",!0),ln(this,n[6]||"",!0),this.i=pn(n[7]||"")):(this.a=!!e,this.b=new En(null,this.a))}function an(t){return new sn(t)}function un(t,e,n){t.f=n?pn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function cn(t,e,n){t.c=n?pn(e,!0):e}function hn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function ln(t,e,n){e instanceof En?(t.b=e,function(t,e){e&&!t.f&&(Tn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(_n(this,e),Sn(this,n,t))},t)),t.f=e}(t.b,t.a)):(n||(e=yn(e,wn)),t.b=new En(e,t.a))}function fn(t,e,n){t.b.set(e,n)}function dn(t){return fn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^G()).toString(36)),t}function pn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function yn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,gn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function gn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}sn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(yn(e,mn,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(yn(e,mn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(yn(n,"/"==n.charAt(0)?bn:vn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",yn(n,In)),t.join("")};var mn=/[#\/\?@]/g,vn=/[#\?:]/g,bn=/[#\?]/g,wn=/[#\?@]/g,In=/#/g;function En(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Tn(t){t.a||(t.a=new en,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function _n(t,e){Tn(t),e=Dn(t,e),rn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,rn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&nn(t)))}function On(t,e){return Tn(t),e=Dn(t,e),rn(t.a.b,e)}function Sn(t,e,n){_n(t,e),0<n.length&&(t.c=null,t.a.set(Dn(t,e),$(n)),t.b+=n.length)}function Dn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(C=En.prototype).add=function(t,e){Tn(this),this.c=null,t=Dn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},C.forEach=function(t,e){Tn(this),this.a.forEach(function(n,r){Y(n,function(n){t.call(e,n,r,this)},this)},this)},C.L=function(){Tn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},C.K=function(t){Tn(this);var e=[];if("string"==typeof t)On(this,t)&&(e=X(e,this.a.get(Dn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=X(e,t[n])}return e},C.set=function(t,e){return Tn(this),this.c=null,On(this,t=Dn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},C.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},C.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var An=function(){return function(t,e){this.b=t,this.a=e}}();function Nn(t){this.g=t||kn,t=P.PerformanceNavigationTiming?0<(t=P.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(P.ja&&P.ja.za&&P.ja.za()&&P.ja.za().Qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var kn=10;function xn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function Cn(t){return t.b?1:t.a?t.a.size:0}function jn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function Rn(t,e){t.a?t.a.add(e):t.b=e}function Pn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Ln(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=x(t.a.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.s)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return $(t.c)}function Vn(){}function Un(){this.a=new Vn}function Mn(t,e,n){var r=n||"";try{tn(t,function(t,n){var i=t;U(t)&&(i=te(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(Wd){throw e.push(r+"type="+encodeURIComponent("_badmap")),Wd}}function Fn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}Nn.prototype.cancel=function(){var t,e;if(this.c=Ln(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=x(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Vn.prototype.stringify=function(t){return P.JSON.stringify(t,void 0)},Vn.prototype.parse=function(t){return P.JSON.parse(t,void 0)};var qn=P.JSON.parse;function Bn(t){$t.call(this),this.headers=new en,this.l=t||null,this.b=!1,this.u=this.a=null,this.C="",this.h=0,this.f="",this.g=this.B=this.m=this.A=!1,this.s=0,this.o=null,this.I=Kn,this.F=this.G=!1}Q(Bn,$t);var Kn="",zn=/^https?$/i,Gn=["POST","PUT"];function Qn(t){return"content-type"==t.toLowerCase()}function Hn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Wn(t),Xn(t)}function Wn(t){t.A||(t.A=!0,Jt(t,"complete"),Jt(t,"error"))}function Yn(t){if(t.b&&void 0!==R&&(!t.u[1]||4!=Jn(t)||2!=t.W()))if(t.m&&4==Jn(t))de(t.Aa,0,t);else if(Jt(t,"readystatechange"),4==Jn(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.C).match(on)[1]||null;if(!o&&P.self&&P.self.location){var s=P.self.location.protocol;o=s.substr(0,s.length-1)}i=!zn.test(o?o.toLowerCase():"")}e=i}if(e)Jt(t,"complete"),Jt(t,"success");else{t.h=6;try{var a=2<Jn(t)?t.a.statusText:""}catch(n){a=""}t.f=a+" ["+t.W()+"]",Wn(t)}}finally{Xn(t)}}}function Xn(t,e){if(t.a){$n(t);var n=t.a,r=t.u[0]?L:null;t.a=null,t.u=null,e||Jt(t,"ready");try{n.onreadystatechange=r}catch(Wd){}}}function $n(t){t.a&&t.F&&(t.a.ontimeout=null),t.o&&(P.clearTimeout(t.o),t.o=null)}function Jn(t){return t.a?t.a.readyState:0}function Zn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return ot(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):fn(t,e,n))}function tr(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function er(t){this.qa=0,this.g=[],this.c=new we,this.ha=this.ma=this.B=this.ga=this.a=this.oa=this.A=this.V=this.i=this.O=this.l=null,this.Pa=this.R=0,this.Ma=tr("failFast",!1,t),this.G=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.pa=this.P=-1,this.T=this.o=this.u=0,this.Ia=tr("baseRetryDelayMs",5e3,t),this.Sa=tr("retryDelaySeedMs",1e4,t),this.Na=tr("forwardChannelMaxRetries",2,t),this.na=tr("forwardChannelRequestTimeoutMs",2e4,t),this.Oa=t&&t.xmlHttpFactory||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Nn(t&&t.concurrentRequestLimit),this.la=new Un,this.ea=t&&t.fastHandshake||!1,this.Ja=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.ea&&this.S&&t&&t.detectBufferingProxy||!1,this.fa=void 0,this.N=0,this.F=!1,this.s=null,(this.La=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function nr(t){if(ir(t),3==t.v){var e=t.R++,n=an(t.B);fn(n,"SID",t.J),fn(n,"RID",e),fn(n,"TYPE","terminate"),ur(t,n),(e=new Fe(t,t.c,e,void 0)).G=2,e.i=dn(an(n)),n=!1,P.navigator&&P.navigator.sendBeacon&&(n=P.navigator.sendBeacon(e.i.toString(),"")),!n&&P.Image&&((new Image).src=e.i,n=!0),n||(e.a=wr(e.g,null),e.a.ba(e.i)),e.u=G(),We(e)}vr(t)}function rr(t){t.a&&(fr(t),t.a.cancel(),t.a=null)}function ir(t){rr(t),t.j&&(P.clearTimeout(t.j),t.j=null),pr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&P.clearTimeout(t.h),t.h=null)}function or(t,e){t.g.push(new An(t.Pa++,e)),3==t.v&&sr(t)}function sr(t){xn(t.b)||t.h||(t.h=!0,ae(t.Ca,t),t.u=0)}function ar(t,e){var n;n=e?e.f:t.R++;var r=an(t.B);fn(r,"SID",t.J),fn(r,"RID",n),fn(r,"AID",t.P),ur(t,r),t.i&&t.l&&Zn(r,t.i,t.l),n=new Fe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=cr(t,n,1e3),n.setTimeout(Math.round(.5*t.na)+Math.round(.5*t.na*Math.random())),Rn(t.b,n),ze(n,r,e)}function ur(t,e){t.f&&tn({},function(t,n){fn(e,n,t)})}function cr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?K(t.f.Ka,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].b)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),a=!1;else try{Mn(h,s,"req"+c+"_")}catch(ri){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function hr(t){t.a||t.j||(t.T=1,ae(t.Ba,t),t.o=0)}function lr(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=ke(K(t.Ba,t),gr(t,t.o)),t.o++,0))}function fr(t){null!=t.s&&(P.clearTimeout(t.s),t.s=null)}function dr(t){t.a=new Fe(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=an(t.ma);fn(e,"RID","rpc"),fn(e,"SID",t.J),fn(e,"CI",t.G?"0":"1"),fn(e,"AID",t.P),ur(t,e),fn(e,"TYPE","xmlhttp"),t.i&&t.l&&Zn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ha,n.G=1,n.i=dn(an(e)),n.j=null,n.I=!0,Ge(n,t)}function pr(t){null!=t.m&&(P.clearTimeout(t.m),t.m=null)}function yr(t,e){var n=null;if(t.a==e){pr(t),fr(t),t.a=null;var r=2}else{if(!jn(t.b,e))return;n=e.s,Pn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=G()-e.u;var i=t.u;Jt(r=_e(),new Ne(r,n,e,i)),sr(t)}else hr(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(Cn(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.Ma?0:t.Na)||(t.h=ke(K(t.Ca,t,e),gr(t,t.u)),t.u++,0)))}(t,e)||2==r&&lr(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:mr(t,5);break;case 4:mr(t,10);break;case 3:mr(t,6);break;default:mr(t,2)}}function gr(t,e){var n=t.Ia+Math.floor(Math.random()*t.Sa);return t.f||(n*=2),n*e}function mr(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=K(t.cb,t);n||(n=new sn("//www.google.com/images/cleardot.gif"),P.location&&"http"==P.location.protocol||un(n,"https"),dn(n)),function(t,e){var n=new we;if(P.Image){var r=new Image;r.onload=z(Fn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=z(Fn,n,r,"TestLoadImage: error",!1,e),r.onabort=z(Fn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=z(Fn,n,r,"TestLoadImage: timeout",!1,e),P.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else Ae(2);t.v=0,t.f&&t.f.sa(e),vr(t),ir(t)}function vr(t){t.v=0,t.I=-1,t.f&&(0==Ln(t.b).length&&0==t.g.length||(t.b.c.length=0,$(t.g),t.g.length=0),t.f.ra())}function br(t,e,n){var r=function(t){return t instanceof sn?an(t):new sn(t,void 0)}(n);if(""!=r.c)e&&cn(r,e+"."+r.c),hn(r,r.h);else{var i=P.location;r=function(t,e,n,r){var i=new sn(null,void 0);return t&&un(i,t),e&&cn(i,e),n&&hn(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&ot(t.V,function(t,e){fn(r,e,t)}),n=t.oa,(e=t.A)&&n&&fn(r,e,n),fn(r,"VER",t.ia),ur(t,r),r}function wr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Bn(t.Oa)).G=t.C,e}function Ir(){}function Er(){if(dt&&!(10<=Number(_t)))throw Error("Environmental error: no available transport.")}function Tr(t,e){$t.call(this),this.a=new er(e),this.g=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!J(t)&&(this.a.i=t),this.o=e&&e.supportsCrossDomainXhr||!1,this.m=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!J(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new Sr(this)}function _r(t){Ve.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Or(){Ue.call(this),this.status=1}function Sr(t){this.a=t}function Dr(t){this.f=t}function Ar(t){$t.call(this),this.u=t,this.h=void 0,this.readyState=Nr,this.status=0,this.responseType=this.responseText=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.o="",this.a=!1,this.m=this.f=this.g=null}(C=Bn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.C+"; newUri="+t);e=e?e.toUpperCase():"GET",this.C=t,this.f="",this.h=0,this.A=!1,this.b=!0,this.a=this.l?this.l.a():Pe.a(),this.u=function(t){return t.b||(t.b=t.c())}(this.l?this.l:Pe),this.a.onreadystatechange=K(this.Aa,this);try{this.B=!0,this.a.open(e,String(t),!0),this.B=!1}catch(o){return void Hn(this,o)}t=n||"";var i=new en(this.headers);r&&tn(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=Qn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=P.FormData&&t instanceof P.FormData,!(0<=W(Gn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.G&&(this.a.withCredentials=this.G);try{$n(this),0<this.s&&((this.F=function(t){return dt&&Tt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.s,this.a.ontimeout=K(this.ya,this)):this.o=de(this.ya,this.s,this)),this.m=!0,this.a.send(t),this.m=!1}catch(o){Hn(this,o)}},C.ya=function(){void 0!==R&&this.a&&(this.f="Timed out after "+this.s+"ms, aborting",this.h=8,Jt(this,"timeout"),this.abort(8))},C.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Jt(this,"complete"),Jt(this,"abort"),Xn(this))},C.H=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Xn(this,!0)),Bn.X.H.call(this)},C.Aa=function(){this.j||(this.B||this.m||this.g?Yn(this):this.Za())},C.Za=function(){Yn(this)},C.W=function(){try{return 2<Jn(this)?this.a.status:-1}catch(lt){return-1}},C.$=function(){try{return this.a?this.a.responseText:""}catch(lt){return""}},C.Qa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),qn(e)}},C.va=function(){return this.h},C.Ra=function(){return"string"==typeof this.f?this.f:String(this.f)},(C=er.prototype).ia=8,C.v=1,C.Ca=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Fe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?ut(r=st(r),this.O):r=this.O),null===this.i&&(n.B=r),this.ea)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=cr(this,n,e),fn(i=an(this.B),"RID",t),fn(i,"CVER",22),this.A&&fn(i,"X-HTTP-Session-Id",this.A),ur(this,i),this.i&&r&&Zn(i,this.i,r),Rn(this.b,n),this.Ja&&fn(i,"TYPE","init"),this.ea?(fn(i,"$req",e),fn(i,"SID","null"),n.U=!0,ze(n,i,null)):ze(n,i,e),this.v=2}}else 3==this.v&&(t?ar(this,t):0==this.g.length||xn(this.b)||ar(this))},C.Ba=function(){if(this.j=null,dr(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=ke(K(this.Ya,this),t)}},C.Ya=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.F=!0,Ae(10),rr(this),dr(this))},C.Xa=function(){null!=this.m&&(this.m=null,rr(this),lr(this),Ae(19))},C.cb=function(t){t?(this.c.info("Successfully pinged google.com"),Ae(2)):(this.c.info("Failed to ping google.com"),Ae(1))},(C=Ir.prototype).ua=function(){},C.ta=function(){},C.sa=function(){},C.ra=function(){},C.Ka=function(){},Er.prototype.a=function(t,e){return new Tr(t,e)},Q(Tr,$t),Tr.prototype.h=function(){this.a.f=this.f,this.o&&(this.a.C=!0);var t=this.a,e=this.g,n=this.b||void 0;Ae(0),t.ga=e,t.V=n||{},t.G=t.S,t.B=br(t,null,t.ga),sr(t)},Tr.prototype.close=function(){nr(this.a)},Tr.prototype.l=function(t){if("string"==typeof t){var e={};e.__data__=t,or(this.a,e)}else this.m?((e={}).__data__=te(t),or(this.a,e)):or(this.a,t)},Tr.prototype.H=function(){this.a.f=null,delete this.f,nr(this.a),delete this.a,Tr.X.H.call(this)},Q(_r,Ve),Q(Or,Ue),Q(Sr,Ir),Sr.prototype.ua=function(){Jt(this.a,"a")},Sr.prototype.ta=function(t){Jt(this.a,new _r(t))},Sr.prototype.sa=function(t){Jt(this.a,new Or(t))},Sr.prototype.ra=function(){Jt(this.a,"b")},Q(Dr,je),Dr.prototype.a=function(){return new Ar(this.f)},Dr.prototype.c=function(t){return function(){return t}}({}),Q(Ar,$t);var Nr=0;function kr(t){t.f.read().then(t.Ta.bind(t)).catch(t.ca.bind(t))}function xr(t){t.readyState=4,t.g=null,t.f=null,t.m=null,Cr(t)}function Cr(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(C=Ar.prototype).open=function(t,e){if(this.readyState!=Nr)throw this.abort(),Error("Error reopening a connection");this.s=t,this.o=e,this.readyState=1,Cr(this)},C.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.l,method:this.s,credentials:this.h,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.o,e)).then(this.Wa.bind(this),this.ca.bind(this))},C.abort=function(){this.responseText="",this.l=new Headers,this.status=0,this.f&&this.f.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,xr(this)),this.readyState=Nr},C.Wa=function(t){this.a&&(this.g=t,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=t.headers,this.readyState=2,Cr(this)),this.a&&(this.readyState=3,Cr(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.Ua.bind(this),this.ca.bind(this)):void 0!==P.ReadableStream&&"body"in t?(this.responseText="",this.f=t.body.getReader(),this.m=new TextDecoder,kr(this)):t.text().then(this.Va.bind(this),this.ca.bind(this)))))},C.Ta=function(t){if(this.a){var e=this.m.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.responseText+=e),t.done?xr(this):Cr(this),3==this.readyState&&kr(this)}},C.Va=function(t){this.a&&(this.responseText=t,xr(this))},C.Ua=function(){this.a&&xr(this)},C.ca=function(){this.a&&xr(this)},C.setRequestHeader=function(t,e){this.l.append(t,e)},C.getResponseHeader=function(t){return this.b&&this.b.get(t.toLowerCase())||""},C.getAllResponseHeaders=function(){if(!this.b)return"";for(var t=[],e=this.b.entries(),n=e.next();!n.done;)t.push((n=n.value)[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Ar.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(t){this.h=t?"include":"same-origin"}}),Er.prototype.createWebChannel=Er.prototype.a,Tr.prototype.send=Tr.prototype.l,Tr.prototype.open=Tr.prototype.h,Tr.prototype.close=Tr.prototype.close,xe.NO_ERROR=0,xe.TIMEOUT=8,xe.HTTP_ERROR=6,Ce.COMPLETE="complete",Re.EventType=Le,Le.OPEN="a",Le.CLOSE="b",Le.ERROR="c",Le.MESSAGE="d",$t.prototype.listen=$t.prototype.wa,Bn.prototype.listenOnce=Bn.prototype.xa,Bn.prototype.getLastError=Bn.prototype.Ra,Bn.prototype.getLastErrorCode=Bn.prototype.va,Bn.prototype.getStatus=Bn.prototype.W,Bn.prototype.getResponseJson=Bn.prototype.Qa,Bn.prototype.getResponseText=Bn.prototype.$,Bn.prototype.send=Bn.prototype.ba;var jr=xe,Rr=Ce,Pr=Ee,Lr=Dr,Vr=Re,Ur=Bn,Mr=n("mrSG"),Fr=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();Fr.o=-1;var qr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Br=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(Mr.c)(e,t),e}(Error),Kr=new N.b("@firebase/firestore");function zr(){return Kr.logLevel}function Gr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Kr.logLevel<=N.a.DEBUG){var r=e.map(Wr);Kr.debug.apply(Kr,Object(Mr.f)(["Firestore (8.6.7): "+t],r))}}function Qr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Kr.logLevel<=N.a.ERROR){var r=e.map(Wr);Kr.error.apply(Kr,Object(Mr.f)(["Firestore (8.6.7): "+t],r))}}function Hr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Kr.logLevel<=N.a.WARN){var r=e.map(Wr);Kr.warn.apply(Kr,Object(Mr.f)(["Firestore (8.6.7): "+t],r))}}function Wr(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(Wd){return t}}function Yr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.6.7) INTERNAL ASSERTION FAILED: "+t;throw Qr(e),new Error(e)}function Xr(t,e){t||Yr()}function $r(t,e){return t}function Jr(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Zr=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Jr(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function ti(t,e){return t<e?-1:t>e?1:0}function ei(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function ni(t){return t+"\0"}var ri=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Br(qr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Br(qr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Br(qr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Br(qr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?ti(this.nanoseconds,t.nanoseconds):ti(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),ii=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new ri(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();function oi(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function si(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ai(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var ui=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Yr(),void 0===n?n=t.length-e:n>t.length-e&&Yr(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return this.construct(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),ci=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Mr.c)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Br(qr.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.emptyPath=function(){return new e([])},e}(ui),hi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,li=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Mr.c)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return hi.test(t)},e.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Br(qr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new Br(qr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Br(qr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new Br(qr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(ui),fi=function(){function t(t){this.fields=t,t.sort(li.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return ei(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),di=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.binaryString)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return ti(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();di.EMPTY_BYTE_STRING=new di("");var pi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yi(t){if(Xr(!!t),"string"==typeof t){var e=0,n=pi.exec(t);if(Xr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:gi(t.seconds),nanos:gi(t.nanos)}}function gi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function mi(t){return"string"==typeof t?di.fromBase64String(t):di.fromUint8Array(t)}function vi(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function bi(t){var e=t.mapValue.fields.__previous_value__;return vi(e)?bi(e):e}function wi(t){var e=yi(t.mapValue.fields.__local_write_time__.timestampValue);return new ri(e.seconds,e.nanos)}function Ii(t){return null==t}function Ei(t){return 0===t&&1/t==-1/0}function Ti(t){return"number"==typeof t&&Number.isInteger(t)&&!Ei(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var _i=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(ci.fromString(e))},t.fromName=function(e){return new t(ci.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===ci.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return ci.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new ci(e.slice()))},t}();function Oi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?vi(t)?4:10:Yr()}function Si(t,e){var n=Oi(t);if(n!==Oi(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return wi(t).isEqual(wi(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=yi(t.timestampValue),r=yi(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return mi(t.bytesValue).isEqual(mi(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return gi(t.geoPointValue.latitude)===gi(e.geoPointValue.latitude)&&gi(t.geoPointValue.longitude)===gi(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return gi(t.integerValue)===gi(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=gi(t.doubleValue),r=gi(e.doubleValue);return n===r?Ei(n)===Ei(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return ei(t.arrayValue.values||[],e.arrayValue.values||[],Si);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(oi(n)!==oi(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Si(n[i],r[i])))return!1;return!0}(t,e);default:return Yr()}}function Di(t,e){return void 0!==(t.values||[]).find(function(t){return Si(t,e)})}function Ai(t,e){var n=Oi(t),r=Oi(e);if(n!==r)return ti(n,r);switch(n){case 0:return 0;case 1:return ti(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=gi(t.integerValue||t.doubleValue),r=gi(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Ni(t.timestampValue,e.timestampValue);case 4:return Ni(wi(t),wi(e));case 5:return ti(t.stringValue,e.stringValue);case 6:return function(t,e){var n=mi(t),r=mi(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=ti(n[i],r[i]);if(0!==o)return o}return ti(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=ti(gi(t.latitude),gi(e.latitude));return 0!==n?n:ti(gi(t.longitude),gi(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Ai(n[i],r[i]);if(o)return o}return ti(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=ti(r[s],o[s]);if(0!==a)return a;var u=Ai(n[r[s]],i[o[s]]);if(0!==u)return u}return ti(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Yr()}}function Ni(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ti(t,e);var n=yi(t),r=yi(e),i=ti(n.seconds,r.seconds);return 0!==i?i:ti(n.nanos,r.nanos)}function ki(t){return xi(t)}function xi(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=yi(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?mi(t.bytesValue).toBase64():"referenceValue"in t?_i.fromName(t.referenceValue).toString():"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=xi(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+xi(t.fields[o])}return e+"}"}(t.mapValue):Yr();var e}function Ci(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function ji(t){return!!t&&"integerValue"in t}function Ri(t){return!!t&&"arrayValue"in t}function Pi(t){return!!t&&"nullValue"in t}function Li(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Vi(t){return!!t&&"mapValue"in t}function Ui(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue)return{timestampValue:Object.assign({},yi(t.timestampValue))};if(t.mapValue){var e={mapValue:{fields:{}}};return si(t.mapValue.fields,function(t,n){return e.mapValue.fields[t]=Ui(n)}),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Ui(t.arrayValue.values[r]);return n}return Object.assign({},t)}var Mi=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!Vi(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ui(e)},t.prototype.setAll=function(t){var e=this,n=li.emptyPath(),r={},i=[];t.forEach(function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=Ui(t):i.push(o.lastSegment())});var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());Vi(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return Si(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];Vi(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){si(e,function(e,n){return t[e]=n});for(var r=0,i=n;r<i.length;r++)delete t[i[r]]},t.prototype.clone=function(){return new t(Ui(this.value))},t}();function Fi(t){var e=[];return si(t.fields,function(t,n){var r=new li([t]);if(Vi(n)){var i=Fi(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)}),new fi(e)}var qi=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,ii.min(),Mi.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,Mi.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,Mi.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=Mi.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=Mi.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),Bi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};function Ki(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Bi(t,e,n,r,i,o,s)}function zi(t){var e=$r(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.canonicalString()+t.op.toString()+ki(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return function(t){return t.field.canonicalString()+t.dir}(t)}).join(","),Ii(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=ro(e.startAt)),e.endAt&&(n+="|ub:",n+=ro(e.endAt)),e.h=n}return e.h}function Gi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!oo(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!Si(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ao(t.startAt,e.startAt)&&ao(t.endAt,e.endAt)}function Qi(t){return _i.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Hi=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(Mr.c)(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new Wi(t,n,r):"array-contains"===n?new Ji(t,r):"in"===n?new Zi(t,r):"not-in"===n?new to(t,r):"array-contains-any"===n?new eo(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new Yi(t,n):new Xi(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(Ai(e,this.value)):null!==e&&Oi(this.value)===Oi(e)&&this.m(Ai(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Yr()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),Wi=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=_i.fromName(r.referenceValue),i}return Object(Mr.c)(e,t),e.prototype.matches=function(t){var e=_i.comparator(t.key,this.key);return this.m(e)},e}(Hi),Yi=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=$i(0,n),r}return Object(Mr.c)(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(Hi),Xi=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=$i(0,n),r}return Object(Mr.c)(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(Hi);function $i(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return _i.fromName(t.referenceValue)})}var Ji=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(Mr.c)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return Ri(e)&&Di(e.arrayValue,this.value)},e}(Hi),Zi=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(Mr.c)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&Di(this.value.arrayValue,e)},e}(Hi),to=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(Mr.c)(e,t),e.prototype.matches=function(t){if(Di(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!Di(this.value.arrayValue,e)},e}(Hi),eo=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(Mr.c)(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!Ri(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Di(e.value.arrayValue,t)})},e}(Hi),no=function(t,e){this.position=t,this.before=e};function ro(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return ki(t)}).join(",")}var io=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function oo(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function so(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?_i.comparator(_i.fromName(s.referenceValue),n.key):Ai(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ao(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Si(t.position[n],e.position[n]))return!1;return!0}var uo=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null};function co(t,e,n,r,i,o,s,a){return new uo(t,e,n,r,i,o,s,a)}function ho(t){return new uo(t)}function lo(t){return!Ii(t.limit)&&"F"===t.limitType}function fo(t){return!Ii(t.limit)&&"L"===t.limitType}function po(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function yo(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function go(t){return null!==t.collectionGroup}function mo(t){var e=$r(t);if(null===e.p){e.p=[];var n=yo(e),r=po(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new io(n)),e.p.push(new io(li.keyField(),"asc"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var a=s[o];e.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new io(li.keyField(),u))}}}return e.p}function vo(t){var e=$r(t);if(!e.T)if("F"===e.limitType)e.T=Ki(e.path,e.collectionGroup,mo(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=mo(e);r<i.length;r++){var o=i[r];n.push(new io(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new no(e.endAt.position,!e.endAt.before):null,a=e.startAt?new no(e.startAt.position,!e.startAt.before):null;e.T=Ki(e.path,e.collectionGroup,n,e.filters,e.limit,s,a)}return e.T}function bo(t,e,n){return new uo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function wo(t,e){return Gi(vo(t),vo(e))&&t.limitType===e.limitType}function Io(t){return zi(vo(t))+"|lt:"+t.limitType}function Eo(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.canonicalString()+" "+e.op+" "+ki(e.value);var e}).join(", ")+"]"),Ii(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+ro(t.startAt)),t.endAt&&(e+=", endAt: "+ro(t.endAt)),"Target("+e+")"}(vo(t))+"; limitType="+t.limitType+")"}function To(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):_i.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!so(t.startAt,mo(t),e)||t.endAt&&so(t.endAt,mo(t),e))}(t,e)}function _o(t){return function(e,n){for(var r=!1,i=0,o=mo(t);i<o.length;i++){var s=o[i],a=Oo(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function Oo(t,e,n){var r=t.field.isKeyField()?_i.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?Ai(r,i):Yr()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Yr()}}function So(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ei(e)?"-0":e}}function Do(t){return{integerValue:""+t}}function Ao(t,e){return Ti(e)?Do(e):So(t,e)}var No=function(){this._=void 0};function ko(t,e,n){return t instanceof jo?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Ro?Po(t,e):t instanceof Lo?Vo(t,e):function(t,e){var n=Co(t,e),r=Mo(n)+Mo(t.A);return ji(n)&&ji(t.A)?Do(r):So(t.R,r)}(t,e)}function xo(t,e,n){return t instanceof Ro?Po(t,e):t instanceof Lo?Vo(t,e):n}function Co(t,e){return t instanceof Uo?ji(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var jo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Mr.c)(e,t),e}(No),Ro=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(Mr.c)(e,t),e}(No);function Po(t,e){for(var n=Fo(e),r=function(t){n.some(function(e){return Si(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Lo=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(Mr.c)(e,t),e}(No);function Vo(t,e){for(var n=Fo(e),r=function(t){n=n.filter(function(e){return!Si(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Uo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return Object(Mr.c)(e,t),e}(No);function Mo(t){return gi(t.integerValue||t.doubleValue)}function Fo(t){return Ri(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var qo=function(t,e){this.field=t,this.transform=e},Bo=function(t,e){this.version=t,this.transformResults=e},Ko=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function zo(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var Go=function(){};function Qo(t,e,n){t instanceof $o?function(t,e,n){var r=t.value.clone(),i=ts(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof Jo?function(t,e,n){if(zo(t.precondition,e)){var r=ts(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(Zo(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Ho(t,e,n){t instanceof $o?function(t,e,n){if(zo(t.precondition,e)){var r=t.value.clone(),i=es(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(Xo(e),r).setHasLocalMutations()}}(t,e,n):t instanceof Jo?function(t,e,n){if(zo(t.precondition,e)){var r=es(t.fieldTransforms,n,e),i=e.data;i.setAll(Zo(t)),i.setAll(r),e.convertToFoundDocument(Xo(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){zo(t.precondition,e)&&e.convertToNoDocument(ii.min())}(t,e)}function Wo(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=Co(o.transform,s||null);null!=a&&(null==n&&(n=Mi.empty()),n.set(o.field,a))}return n||null}function Yo(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&ei(t,e,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Ro&&e instanceof Ro||t instanceof Lo&&e instanceof Lo?ei(t.elements,e.elements,Si):t instanceof Uo&&e instanceof Uo?Si(t.A,e.A):t instanceof jo&&e instanceof jo}(t.transform,e.transform)}(t,e)})}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Xo(t){return t.isFoundDocument()?t.version:ii.min()}var $o=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return Object(Mr.c)(e,t),e}(Go),Jo=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return Object(Mr.c)(e,t),e}(Go);function Zo(t){var e=new Map;return t.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}}),e}function ts(t,e,n){var r=new Map;Xr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,xo(s,a,n[i]))}return r}function es(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=n.data.field(s.field);r.set(s.field,ko(a,u,e))}return r}var ns,rs,is=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return Object(Mr.c)(e,t),e}(Go),os=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return Object(Mr.c)(e,t),e}(Go),ss=function(t){this.count=t};function as(t){switch(t){case qr.OK:return Yr();case qr.CANCELLED:case qr.UNKNOWN:case qr.DEADLINE_EXCEEDED:case qr.RESOURCE_EXHAUSTED:case qr.INTERNAL:case qr.UNAVAILABLE:case qr.UNAUTHENTICATED:return!1;case qr.INVALID_ARGUMENT:case qr.NOT_FOUND:case qr.ALREADY_EXISTS:case qr.PERMISSION_DENIED:case qr.FAILED_PRECONDITION:case qr.ABORTED:case qr.OUT_OF_RANGE:case qr.UNIMPLEMENTED:case qr.DATA_LOSS:return!0;default:return Yr()}}function us(t){if(void 0===t)return Qr("GRPC error has no .code"),qr.UNKNOWN;switch(t){case ns.OK:return qr.OK;case ns.CANCELLED:return qr.CANCELLED;case ns.UNKNOWN:return qr.UNKNOWN;case ns.DEADLINE_EXCEEDED:return qr.DEADLINE_EXCEEDED;case ns.RESOURCE_EXHAUSTED:return qr.RESOURCE_EXHAUSTED;case ns.INTERNAL:return qr.INTERNAL;case ns.UNAVAILABLE:return qr.UNAVAILABLE;case ns.UNAUTHENTICATED:return qr.UNAUTHENTICATED;case ns.INVALID_ARGUMENT:return qr.INVALID_ARGUMENT;case ns.NOT_FOUND:return qr.NOT_FOUND;case ns.ALREADY_EXISTS:return qr.ALREADY_EXISTS;case ns.PERMISSION_DENIED:return qr.PERMISSION_DENIED;case ns.FAILED_PRECONDITION:return qr.FAILED_PRECONDITION;case ns.ABORTED:return qr.ABORTED;case ns.OUT_OF_RANGE:return qr.OUT_OF_RANGE;case ns.UNIMPLEMENTED:return qr.UNIMPLEMENTED;case ns.DATA_LOSS:return qr.DATA_LOSS;default:return Yr()}}(rs=ns||(ns={}))[rs.OK=0]="OK",rs[rs.CANCELLED=1]="CANCELLED",rs[rs.UNKNOWN=2]="UNKNOWN",rs[rs.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",rs[rs.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",rs[rs.NOT_FOUND=5]="NOT_FOUND",rs[rs.ALREADY_EXISTS=6]="ALREADY_EXISTS",rs[rs.PERMISSION_DENIED=7]="PERMISSION_DENIED",rs[rs.UNAUTHENTICATED=16]="UNAUTHENTICATED",rs[rs.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",rs[rs.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",rs[rs.ABORTED=10]="ABORTED",rs[rs.OUT_OF_RANGE=11]="OUT_OF_RANGE",rs[rs.UNIMPLEMENTED=12]="UNIMPLEMENTED",rs[rs.INTERNAL=13]="INTERNAL",rs[rs.UNAVAILABLE=14]="UNAVAILABLE",rs[rs.DATA_LOSS=15]="DATA_LOSS";var cs=function(){function t(t,e){this.comparator=t,this.root=e||ls.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ls.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ls.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.inorderTraversal(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new hs(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new hs(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new hs(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new hs(this.root,t,this.comparator,!0)},t}(),hs=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),ls=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Yr();if(this.right.isRed())throw Yr();var t=this.left.check();if(t!==this.right.check())throw Yr();return t+(this.isRed()?0:1)},t}();ls.EMPTY=null,ls.RED=!0,ls.BLACK=!1,ls.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Yr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Yr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Yr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Yr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Yr()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new ls(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());var fs=function(){function t(t){this.comparator=t,this.data=new cs(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new ds(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new ds(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),ds=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),ps=new cs(_i.comparator);function ys(){return ps}var gs=new cs(_i.comparator);function ms(){return gs}var vs=new cs(_i.comparator);function bs(){return vs}var ws=new fs(_i.comparator);function Is(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ws,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Es=new fs(ti);function Ts(){return Es}var _s=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,Os.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(ii.min(),r,Ts(),ys(),Is())},t}(),Os=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(di.EMPTY_BYTE_STRING,n,Is(),Is(),Is())},t}(),Ss=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},Ds=function(t,e){this.targetId=t,this.V=e},As=function(t,e,n,r){void 0===n&&(n=di.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Ns=function(){function t(){this.S=0,this.D=Cs(),this.C=di.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=Is(),e=Is(),n=Is();return this.D.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Yr()}}),new Os(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=Cs()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),ks=function(){function t(t){this.W=t,this.G=new Map,this.H=ys(),this.J=xs(),this.Y=new fs(ti)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.tt(r=o[i],t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:Yr()}})},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach(function(t,r){n.st(r)&&e(r)})},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(Qi(i))if(0===n){var o=new _i(i.path);this.tt(e,o,qi.newNoDocument(o,ii.min()))}else Xr(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach(function(r,i){var o=e.ot(i);if(o){if(r.current&&Qi(o.target)){var s=new _i(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,qi.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}});var r=Is();this.J.forEach(function(t,n){var i=!0;n.forEachWhile(function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(t))});var i=new _s(t,n,this.Y,this.H,r);return this.H=ys(),this.J=xs(),this.Y=new fs(ti),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new Ns,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new fs(ti),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||Gr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new Ns),this.W.getRemoteKeysForTarget(t).forEach(function(n){e.tt(t,n,null)})},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function xs(){return new cs(_i.comparator)}function Cs(){return new cs(_i.comparator)}var js={asc:"ASCENDING",desc:"DESCENDING"},Rs={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ps=function(t,e){this.databaseId=t,this.I=e};function Ls(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Vs(t,e){return t.I?e.toBase64():e.toUint8Array()}function Us(t,e){return Ls(t,e.toTimestamp())}function Ms(t){return Xr(!!t),ii.fromTimestamp(function(t){var e=yi(t);return new ri(e.seconds,e.nanos)}(t))}function Fs(t,e){return function(t){return new ci(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function qs(t){var e=ci.fromString(t);return Xr(la(e)),e}function Bs(t,e){return Fs(t.databaseId,e.path)}function Ks(t,e){var n=qs(e);if(n.get(1)!==t.databaseId.projectId)throw new Br(qr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Br(qr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new _i(Hs(n))}function zs(t,e){return Fs(t.databaseId,e)}function Gs(t){var e=qs(t);return 4===e.length?ci.emptyPath():Hs(e)}function Qs(t){return new ci(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Hs(t){return Xr(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Ws(t,e,n){return{name:Bs(t,e),fields:n.value.mapValue.fields}}function Ys(t,e,n){var r=Ks(t,e.name),i=Ms(e.updateTime),o=new Mi({mapValue:{fields:e.fields}}),s=qi.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}function Xs(t,e){var n;if(e instanceof $o)n={update:Ws(t,e.key,e.value)};else if(e instanceof is)n={delete:Bs(t,e.key)};else if(e instanceof Jo)n={update:Ws(t,e.key,e.data),updateMask:ha(e.fieldMask)};else{if(!(e instanceof os))return Yr();n={verify:Bs(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof jo)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ro)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Lo)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Uo)return{fieldPath:e.field.canonicalString(),increment:n.A};throw Yr()}(0,t)})),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Us(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Yr()}(t,e.precondition)),n}function $s(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Ko.updateTime(Ms(t.updateTime)):void 0!==t.exists?Ko.exists(t.exists):Ko.none()}(e.currentDocument):Ko.none(),r=e.updateTransforms?e.updateTransforms.map(function(e){return function(t,e){var n=null;"setToServerValue"in e?(Xr("REQUEST_TIME"===e.setToServerValue),n=new jo):"appendMissingElements"in e?n=new Ro(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new Lo(e.removeAllFromArray.values||[]):"increment"in e?n=new Uo(t,e.increment):Yr();var r=li.fromServerFormat(e.fieldPath);return new qo(r,n)}(t,e)}):[];if(e.update){var i=Ks(t,e.update.name),o=new Mi({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){return new fi((t.fieldPaths||[]).map(function(t){return li.fromServerFormat(t)}))}(e.updateMask);return new Jo(i,o,s,n,r)}return new $o(i,o,n,r)}if(e.delete){var a=Ks(t,e.delete);return new is(a,n)}if(e.verify){var u=Ks(t,e.verify);return new os(u,n)}return Yr()}function Js(t,e){return{documents:[zs(t,e.path)]}}function Zs(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=zs(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=zs(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(Li(t.value))return{unaryFilter:{field:sa(t.field),op:"IS_NAN"}};if(Pi(t.value))return{unaryFilter:{field:sa(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Li(t.value))return{unaryFilter:{field:sa(t.field),op:"IS_NOT_NAN"}};if(Pi(t.value))return{unaryFilter:{field:sa(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:sa(t.field),op:oa(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:sa(t.field),direction:ia(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.I||Ii(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=na(e.startAt)),e.endAt&&(n.structuredQuery.endAt=na(e.endAt)),n}function ta(t){var e=Gs(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Xr(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=ea(n.where));var a=[];n.orderBy&&(a=n.orderBy.map(function(t){return function(t){return new io(aa(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var u=null;n.limit&&(u=function(t){var e;return Ii(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=ra(n.startAt));var h=null;return n.endAt&&(h=ra(n.endAt)),co(e,i,a,s,u,"F",c,h)}function ea(t){return t?void 0!==t.unaryFilter?[ca(t)]:void 0!==t.fieldFilter?[ua(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return ea(t)}).reduce(function(t,e){return t.concat(e)}):Yr():[]}function na(t){return{before:t.before,values:t.position}}function ra(t){return new no(t.values||[],!!t.before)}function ia(t){return js[t]}function oa(t){return Rs[t]}function sa(t){return{fieldPath:t.canonicalString()}}function aa(t){return li.fromServerFormat(t.fieldPath)}function ua(t){return Hi.create(aa(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Yr()}}(t.fieldFilter.op),t.fieldFilter.value)}function ca(t){switch(t.unaryFilter.op){case"IS_NAN":var e=aa(t.unaryFilter.field);return Hi.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=aa(t.unaryFilter.field);return Hi.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=aa(t.unaryFilter.field);return Hi.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=aa(t.unaryFilter.field);return Hi.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Yr()}}function ha(t){var e=[];return t.fields.forEach(function(t){return e.push(t.canonicalString())}),{fieldPaths:e}}function la(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function fa(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=pa(e)),e=da(t.get(n),e);return pa(e)}function da(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function pa(t){return t+"\x01\x01"}function ya(t){var e=t.length;if(Xr(e>=2),2===e)return Xr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),ci.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&Yr(),t.charAt(s+1)){case"\x01":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Yr()}o=s+2}return new ci(r)}var ga=function(t,e){this.seconds=t,this.nanoseconds=e},ma=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};ma.store="owner",ma.key="owner";var va=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};va.store="mutationQueues",va.keyPath="userId";var ba=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};ba.store="mutations",ba.keyPath="batchId",ba.userMutationsIndex="userMutationsIndex",ba.userMutationsKeyPath=["userId","batchId"];var wa=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,fa(e)]},t.key=function(t,e,n){return[t,fa(e),n]},t}();wa.store="documentMutations",wa.PLACEHOLDER=new wa;var Ia=function(t,e){this.path=t,this.readTime=e},Ea=function(t,e){this.path=t,this.version=e},Ta=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Ta.store="remoteDocuments",Ta.readTimeIndex="readTimeIndex",Ta.readTimeIndexPath="readTime",Ta.collectionReadTimeIndex="collectionReadTimeIndex",Ta.collectionReadTimeIndexPath=["parentPath","readTime"];var _a=function(t){this.byteSize=t};_a.store="remoteDocumentGlobal",_a.key="remoteDocumentGlobalKey";var Oa=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Oa.store="targets",Oa.keyPath="targetId",Oa.queryTargetsIndexName="queryTargetsIndex",Oa.queryTargetsKeyPath=["canonicalId","targetId"];var Sa=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Sa.store="targetDocuments",Sa.keyPath=["targetId","path"],Sa.documentTargetsIndex="documentTargetsIndex",Sa.documentTargetsKeyPath=["path","targetId"];var Da=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Da.key="targetGlobalKey",Da.store="targetGlobal";var Aa=function(t,e){this.collectionId=t,this.parent=e};Aa.store="collectionParents",Aa.keyPath=["collectionId","parent"];var Na=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Na.store="clientMetadata",Na.keyPath="clientId";var ka=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};ka.store="bundles",ka.keyPath="bundleId";var xa=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};xa.store="namedQueries",xa.keyPath="name";var Ca=Object(Mr.f)(Object(Mr.f)([],Object(Mr.f)(Object(Mr.f)([],Object(Mr.f)(Object(Mr.f)([],Object(Mr.f)(Object(Mr.f)([],[va.store,ba.store,wa.store,Ta.store,Oa.store,ma.store,Da.store,Sa.store]),[Na.store])),[_a.store])),[Aa.store])),[ka.store,xa.store]),ja="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ra=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach(function(t){return t()})},t}(),Pa=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},La=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&Yr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}})},t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.waitFor=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.waitFor(r)},t}(),Va=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new Pa,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new Fa(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=Ga(e.target.error);n.ft.reject(new Fa(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Fa(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(Gr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Ba(e)},t}(),Ua=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(Object(A.i)())&&Qr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Gr("SimpleDb","Removing database:",t),Ka(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=Object(A.i)(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return Object(Mr.b)(this,void 0,void 0,function(){var e,n=this;return Object(Mr.d)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(Gr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new Fa(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new Br(qr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new Fa(t,n))},i.onupgradeneeded=function(t){Gr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.wt.Rt(t.target.result,i.transaction,t.oldVersion,n.version).next(function(){Gr("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}})})},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(Mr.b)(this,void 0,void 0,function(){var i,o,s,a,u;return Object(Mr.d)(this,function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,h;return Object(Mr.d)(this,function(l){switch(l.label){case 0:++o,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,a.At(t)];case 2:return a.db=l.sent(),e=Va.open(a.db,t,i?"readonly":"readwrite",n),s=r(e).catch(function(t){return e.abort(t),La.reject(t)}).toPromise(),u={},s.catch(function(){}),[4,e.dt];case 3:return[2,(u.value=(l.sent(),s),u)];case 4:return Gr("SimpleDb","Transaction failed with error:",(c=l.sent()).message,"Retrying:",h="FirebaseError"!==c.name&&o<3),a.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Ma=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return Ka(this.Pt.delete())},t}(),Fa=function(t){function e(e,n){var r=this;return(r=t.call(this,qr.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(Mr.c)(e,t),e}(Br);function qa(t){return"IndexedDbTransactionError"===t.name}var Ba=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Gr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Gr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Ka(n)},t.prototype.add=function(t){return Gr("SimpleDb","ADD",this.store.name,t,t),Ka(this.store.add(t))},t.prototype.get=function(t){var e=this;return Ka(this.store.get(t)).next(function(n){return void 0===n&&(n=null),Gr("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return Gr("SimpleDb","DELETE",this.store.name,t),Ka(this.store.delete(t))},t.prototype.count=function(){return Gr("SimpleDb","COUNT",this.store.name),Ka(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.Ft=function(t,e){Gr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,function(t,e,n){return n.delete()})},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new La(function(n,r){e.onerror=function(t){var e=Ga(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.xt=function(t,e){var n=[];return new La(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Ma(i),s=e(i.primaryKey,i.value,o);if(s instanceof La){var a=s.catch(function(t){return o.done(),La.reject(t)});n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}}).next(function(){return La.waitFor(n)})},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Ka(t){return new La(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=Ga(t.target.error);n(e)}})}var za=!1;function Ga(t){var e=Ua._t(Object(A.i)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Br("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return za||(za=!0,setTimeout(function(){throw r},0)),r}}return t}var Qa=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return Object(Mr.c)(e,t),e}(Ra);function Ha(t,e){var n=$r(t);return Ua.It(n.Mt,e)}var Wa=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&Qo(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&Ho(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&Ho(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach(function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(ii.min())})},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Is())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&ei(this.mutations,t.mutations,function(t,e){return Yo(t,e)})&&ei(this.baseMutations,t.baseMutations,function(t,e){return Yo(t,e)})},t}(),Ya=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){Xr(e.mutations.length===r.length);for(var i=bs(),o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Xa=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=ii.min()),void 0===o&&(o=ii.min()),void 0===s&&(s=di.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),$a=function(t){this.Lt=t};function Ja(t,e){if(e.document)return Ys(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=_i.fromSegments(e.noDocument.path),r=ru(e.noDocument.readTime),i=qi.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=_i.fromSegments(e.unknownDocument.path);return r=ru(e.unknownDocument.version),qi.newUnknownDocument(o,r)}return Yr()}function Za(t,e,n){var r=tu(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:Bs(t,e.key),fields:e.data.value.mapValue.fields,updateTime:Ls(t,e.version.toTimestamp())}}(t.Lt,e),s=e.hasCommittedMutations;return new Ta(null,null,o,s,r,i)}if(e.isNoDocument()){var a=e.key.path.toArray(),u=nu(e.version);return s=e.hasCommittedMutations,new Ta(null,new Ia(a,u),null,s,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),h=nu(e.version);return new Ta(new Ea(c,h),null,null,!0,r,i)}return Yr()}function tu(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function eu(t){var e=new ri(t[0],t[1]);return ii.fromTimestamp(e)}function nu(t){var e=t.toTimestamp();return new ga(e.seconds,e.nanoseconds)}function ru(t){var e=new ri(t.seconds,t.nanoseconds);return ii.fromTimestamp(e)}function iu(t,e){for(var n=(e.baseMutations||[]).map(function(e){return $s(t.Lt,e)}),r=0;r<e.mutations.length-1;++r)r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform&&(e.mutations[r].updateTransforms=e.mutations[r+1].transform.fieldTransforms,e.mutations.splice(r+1,1),++r);var i=e.mutations.map(function(e){return $s(t.Lt,e)}),o=ri.fromMillis(e.localWriteTimeMs);return new Wa(e.batchId,o,n,i)}function ou(t){var e,n,r=ru(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?ru(t.lastLimboFreeSnapshotVersion):ii.min();return void 0!==t.query.documents?(Xr(1===(n=t.query).documents.length),e=vo(ho(Gs(n.documents[0])))):e=function(t){return vo(ta(t))}(t.query),new Xa(e,t.targetId,0,t.lastListenSequenceNumber,r,i,di.fromBase64String(t.resumeToken))}function su(t,e){var n,r=nu(e.snapshotVersion),i=nu(e.lastLimboFreeSnapshotVersion);n=Qi(e.target)?Js(t.Lt,e.target):Zs(t.Lt,e.target);var o=e.resumeToken.toBase64();return new Oa(e.targetId,zi(e.target),r,o,e.sequenceNumber,i,n)}function au(t){var e=ta({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?bo(e,e.limit,"L"):e}var uu=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return cu(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:ru(e.createTime),version:e.version};var e})},t.prototype.saveBundleMetadata=function(t,e){return cu(t).put({bundleId:(n=e).id,createTime:nu(Ms(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return hu(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:au(e.bundledQuery),readTime:ru(e.readTime)};var e})},t.prototype.saveNamedQuery=function(t,e){return hu(t).put(function(t){return{name:t.name,readTime:nu(Ms(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function cu(t){return Ha(t,ka.store)}function hu(t){return Ha(t,xa.store)}var lu=function(){function t(){this.Bt=new fu}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),La.resolve()},t.prototype.getCollectionParents=function(t,e){return La.resolve(this.Bt.getEntries(e))},t}(),fu=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new fs(ci.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new fs(ci.comparator)).toArray()},t}(),du=function(){function t(){this.qt=new fu}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener(function(){n.qt.add(e)});var o={collectionId:r,parent:fa(i)};return pu(t).put(o)}return La.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[ni(e),""],!1,!0);return pu(t).Nt(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(ya(o.parent))}return n})},t}();function pu(t){return Ha(t,Aa.store)}var yu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},gu=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();function mu(t,e,n){var r=t.store(ba.store),i=t.store(wa.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},function(t,e,n){return a++,n.delete()});o.push(u.next(function(){Xr(1===a)}));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],d=wa.key(e,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return La.waitFor(o).next(function(){return c})}function vu(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Yr();e=t.noDocument}return JSON.stringify(e).length}gu.DEFAULT_COLLECTION_PERCENTILE=10,gu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,gu.DEFAULT=new gu(41943040,gu.DEFAULT_COLLECTION_PERCENTILE,gu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),gu.DISABLED=new gu(-1,0,0);var bu=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Qt={}}return t.Kt=function(e,n,r,i){return Xr(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Iu(t).$t({index:ba.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=Eu(t),s=Iu(t);return s.add({}).next(function(a){Xr("number"==typeof a);for(var u=new Wa(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return Xs(t.Lt,e)}),i=n.mutations.map(function(e){return Xs(t.Lt,e)});return new ba(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),h=[],l=new fs(function(t,e){return ti(t.canonicalString(),e.canonicalString())}),f=0,d=r;f<d.length;f++){var p=d[f],y=wa.key(i.userId,p.key.path,a);l=l.add(p.key.path.popLast()),h.push(s.put(c)),h.push(o.put(y,wa.PLACEHOLDER))}return l.forEach(function(e){h.push(i.Ut.addToCollectionParentIndex(t,e))}),t.addOnCommittedListener(function(){i.Qt[a]=u.keys()}),La.waitFor(h).next(function(){return u})})},t.prototype.lookupMutationBatch=function(t,e){var n=this;return Iu(t).get(e).next(function(t){return t?(Xr(t.userId===n.userId),iu(n.R,t)):null})},t.prototype.jt=function(t,e){var n=this;return this.Qt[e]?La.resolve(this.Qt[e]):this.lookupMutationBatch(t,e).next(function(t){if(t){var r=t.keys();return n.Qt[e]=r,r}return null})},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Iu(t).$t({index:ba.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(Xr(e.batchId>=r),o=iu(n.R,e)),i.done()}).next(function(){return o})},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Iu(t).$t({index:ba.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Iu(t).Nt(ba.userMutationsIndex,n).next(function(t){return t.map(function(t){return iu(e.R,t)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=wa.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Eu(t).$t({range:i},function(r,i,s){var a=r[0],u=r[2],c=ya(r[1]);if(a===n.userId&&e.path.isEqual(c))return Iu(t).get(u).next(function(t){if(!t)throw Yr();Xr(t.userId===n.userId),o.push(iu(n.R,t))});s.done()}).next(function(){return o})},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new fs(ti),i=[];return e.forEach(function(e){var o=wa.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=Eu(t).$t({range:s},function(t,i,o){var s=t[0],a=t[2],u=ya(t[1]);s===n.userId&&e.path.isEqual(u)?r=r.add(a):o.done()});i.push(a)}),La.waitFor(i).next(function(){return n.Wt(t,r)})},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=wa.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new fs(ti);return Eu(t).$t({range:s},function(t,e,o){var s=t[0],u=t[2],c=ya(t[1]);s===n.userId&&r.isPrefixOf(c)?c.length===i&&(a=a.add(u)):o.done()}).next(function(){return n.Wt(t,a)})},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(Iu(t).get(e).next(function(t){if(null===t)throw Yr();Xr(t.userId===n.userId),r.push(iu(n.R,t))}))}),La.waitFor(i).next(function(){return r})},t.prototype.removeMutationBatch=function(t,e){var n=this;return mu(t.Mt,this.userId,e).next(function(r){return t.addOnCommittedListener(function(){n.Gt(e.batchId)}),La.forEach(r,function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)})})},t.prototype.Gt=function(t){delete this.Qt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next(function(n){if(!n)return La.resolve();var r=IDBKeyRange.lowerBound(wa.prefixForUser(e.userId)),i=[];return Eu(t).$t({range:r},function(t,n,r){if(t[0]===e.userId){var o=ya(t[1]);i.push(o)}else r.done()}).next(function(){Xr(0===i.length)})})},t.prototype.containsKey=function(t,e){return wu(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return Tu(t).get(this.userId).next(function(t){return t||new va(e.userId,-1,"")})},t}();function wu(t,e,n){var r=wa.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Eu(t).$t({range:o,kt:!0},function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()}).next(function(){return s})}function Iu(t){return Ha(t,ba.store)}function Eu(t){return Ha(t,wa.store)}function Tu(t){return Ha(t,va.store)}var _u=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),Ou=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next(function(n){var r=new _u(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next(function(){return n.highestTargetId})})},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next(function(t){return ii.fromTimestamp(new ri(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)})},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next(function(){return n.Xt(t).next(function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)})})},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){return Su(t).delete(e.targetId)}).next(function(){return n.Xt(t)}).next(function(e){return Xr(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)})},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Su(t).$t(function(s,a){var u=ou(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))}).next(function(){return La.waitFor(o)}).next(function(){return i})},t.prototype.forEachTarget=function(t,e){return Su(t).$t(function(t,n){var r=ou(n);e(r)})},t.prototype.Xt=function(t){return Du(t).get(Da.key).next(function(t){return Xr(null!==t),t})},t.prototype.Zt=function(t,e){return Du(t).put(Da.key,e)},t.prototype.te=function(t,e){return Su(t).put(su(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next(function(t){return t.targetCount})},t.prototype.getTargetData=function(t,e){var n=zi(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Su(t).$t({range:r,index:Oa.queryTargetsIndexName},function(t,n,r){var o=ou(n);Gi(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Au(t);return e.forEach(function(e){var s=fa(e.path);i.push(o.put(new Sa(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))}),La.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Au(t);return La.forEach(e,function(e){var o=fa(e.path);return La.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])})},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Au(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Au(t),i=Is();return r.$t({range:n,kt:!0},function(t,e,n){var r=ya(t[1]),o=new _i(r);i=i.add(o)}).next(function(){return i})},t.prototype.containsKey=function(t,e){var n=fa(e.path),r=IDBKeyRange.bound([n],[ni(n)],!1,!0),i=0;return Au(t).$t({index:Sa.documentTargetsIndex,kt:!0,range:r},function(t,e,n){0!==t[0]&&(i++,n.done())}).next(function(){return i>0})},t.prototype.lt=function(t,e){return Su(t).get(e).next(function(t){return t?ou(t):null})},t}();function Su(t){return Ha(t,Oa.store)}function Du(t){return Ha(t,Da.store)}function Au(t){return Ha(t,Sa.store)}function Nu(t){return Object(Mr.b)(this,void 0,void 0,function(){return Object(Mr.d)(this,function(e){if(t.code!==qr.FAILED_PRECONDITION||t.message!==ja)throw t;return Gr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function ku(t,e){var n=t[1],r=e[1],i=ti(t[0],e[0]);return 0===i?ti(n,r):i}var xu=function(){function t(t){this.ne=t,this.buffer=new fs(ku),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();ku(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Cu=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;Gr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,function(){return Object(Mr.b)(e,void 0,void 0,function(){var e;return Object(Mr.d)(this,function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return qa(e=n.sent())?(Gr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Nu(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}})})})},t}(),ju=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return La.resolve(Fr.o);var r=new xu(e);return this.ae.forEachTarget(t,function(t){return r.re(t.sequenceNumber)}).next(function(){return n.ae.le(t,function(t){return r.re(t)})}).next(function(){return r.maxValue})},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Gr("LruGarbageCollector","Garbage collection skipped; disabled"),La.resolve(yu)):this.getCacheSize(t).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(Gr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),yu):n.fe(t,e)})},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,a,u,c=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(function(e){return e>c.params.maximumSequenceNumbersToCollect?(Gr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)}).next(function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)}).next(function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)}).next(function(t){return u=Date.now(),zr()<=N.a.DEBUG&&Gr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-h)+"ms"),La.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})})},t}(),Ru=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new ju(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.de=function(t){var e=0;return this.le(t,function(t){e++}).next(function(){return e})},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,function(t,n){return e(n)})},t.prototype.addReference=function(t,e,n){return Pu(t,n)},t.prototype.removeReference=function(t,e,n){return Pu(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return Pu(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return Tu(t).Ot(function(r){return wu(t,r,e).next(function(t){return t&&(n=!0),La.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,function(s,a){if(a<=e){var u=n._e(t,s).next(function(e){if(!e)return o++,r.getEntry(t,s).next(function(){return r.removeEntry(s),Au(t).delete([0,fa(s.path)])})});i.push(u)}}).next(function(){return La.waitFor(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Pu(t,e)},t.prototype.we=function(t,e){var n,r=Au(t),i=Fr.o;return r.$t({index:Sa.documentTargetsIndex},function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==Fr.o&&e(new _i(ya(n)),i),i=s,n=o):i=Fr.o}).next(function(){i!==Fr.o&&e(new _i(ya(n)),i)})},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function Pu(t,e){return Au(t).put(function(t,e){return new Sa(0,fa(t.path),e)}(e,t.currentSequenceNumber))}var Lu=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.equalsFn(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){si(this.inner,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}})},t.prototype.isEmpty=function(){return ai(this.inner)},t}(),Vu=function(){function t(){this.changes=new Lu(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:ii.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:qi.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?La.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),Uu=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return qu(t).put(Bu(e),n)},t.prototype.removeEntry=function(t,e){var n=qu(t),r=Bu(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.me(t,r)})},t.prototype.getEntry=function(t,e){var n=this;return qu(t).get(Bu(e)).next(function(t){return n.ye(e,t)})},t.prototype.ge=function(t,e){var n=this;return qu(t).get(Bu(e)).next(function(t){return{document:n.ye(e,t),size:vu(t)}})},t.prototype.getEntries=function(t,e){var n=this,r=ys();return this.pe(t,e,function(t,e){var i=n.ye(t,e);r=r.insert(t,i)}).next(function(){return r})},t.prototype.Ee=function(t,e){var n=this,r=ys(),i=new cs(_i.comparator);return this.pe(t,e,function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,vu(e))}).next(function(){return{documents:r,Te:i}})},t.prototype.pe=function(t,e,n){if(e.isEmpty())return La.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return qu(t).$t({range:r},function(t,e,r){for(var s=_i.fromSegments(t);o&&_i.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()}).next(function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null})},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=ys(),o=e.path.length+1,s={};if(n.isEqual(ii.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=tu(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=Ta.collectionReadTimeIndex}return qu(t).$t(s,function(t,n,s){if(t.length===o){var a=Ja(r.R,n);e.path.isPrefixOf(a.key.path)?To(e,a)&&(i=i.insert(a.key,a)):s.done()}}).next(function(){return i})},t.prototype.newChangeBuffer=function(t){return new Mu(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Fu(t).get(_a.key).next(function(t){return Xr(!!t),t})},t.prototype.me=function(t,e){return Fu(t).put(_a.key,e)},t.prototype.ye=function(t,e){if(e){var n=Ja(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(ii.min()))return n}return qi.newInvalidDocument(t)},t}(),Mu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new Lu(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return Object(Mr.c)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new fs(function(t,e){return ti(t.canonicalString(),e.canonicalString())});return this.changes.forEach(function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=Za(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=vu(u);r+=c-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var h=Za(e.Ie.R,qi.newNoDocument(o,ii.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,h))}else n.push(e.Ie.removeEntry(t,o))}),i.forEach(function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))}),n.push(this.Ie.updateMetadata(t,r)),La.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next(function(t){return n.Ae.set(e,t.size),t.document})},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next(function(t){var e=t.documents;return t.Te.forEach(function(t,e){n.Ae.set(t,e)}),e})},e}(Vu);function Fu(t){return Ha(t,_a.store)}function qu(t){return Ha(t,Ta.store)}function Bu(t){return t.path.toArray()}var Ku=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;Xr(n<r&&n>=0&&r<=11);var o=new Va("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(ma.store)}(t),function(t){t.createObjectStore(va.store,{keyPath:va.keyPath}),t.createObjectStore(ba.store,{keyPath:ba.keyPath,autoIncrement:!0}).createIndex(ba.userMutationsIndex,ba.userMutationsKeyPath,{unique:!0}),t.createObjectStore(wa.store)}(t),zu(t),function(t){t.createObjectStore(Ta.store)}(t));var s=La.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Sa.store),t.deleteObjectStore(Oa.store),t.deleteObjectStore(Da.store)}(t),zu(t)),s=s.next(function(){return function(t){var e=t.store(Da.store),n=new Da(0,0,ii.min().toTimestamp(),0);return e.put(Da.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(ba.store).Nt().next(function(n){t.deleteObjectStore(ba.store),t.createObjectStore(ba.store,{keyPath:ba.keyPath,autoIncrement:!0}).createIndex(ba.userMutationsIndex,ba.userMutationsKeyPath,{unique:!0});var r=e.store(ba.store),i=n.map(function(t){return r.put(t)});return La.waitFor(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(Na.store,{keyPath:Na.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.Re(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(_a.store)}(t),i.be(o)})),n<7&&r>=7&&(s=s.next(function(){return i.ve(o)})),n<8&&r>=8&&(s=s.next(function(){return i.Pe(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Ta.store);e.createIndex(Ta.readTimeIndex,Ta.readTimeIndexPath,{unique:!1}),e.createIndex(Ta.collectionReadTimeIndex,Ta.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.Ve(o)})),n<11&&r>=11&&(s=s.next(function(){!function(t){t.createObjectStore(ka.store,{keyPath:ka.keyPath})}(t),function(t){t.createObjectStore(xa.store,{keyPath:xa.keyPath})}(t)})),s},t.prototype.be=function(t){var e=0;return t.store(Ta.store).$t(function(t,n){e+=vu(n)}).next(function(){var n=new _a(e);return t.store(_a.store).put(_a.key,n)})},t.prototype.Re=function(t){var e=this,n=t.store(va.store),r=t.store(ba.store);return n.Nt().next(function(n){return La.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(ba.userMutationsIndex,i).next(function(r){return La.forEach(r,function(r){Xr(r.userId===n.userId);var i=iu(e.R,r);return mu(t,n.userId,i).next(function(){})})})})})},t.prototype.ve=function(t){var e=t.store(Sa.store),n=t.store(Ta.store);return t.store(Da.store).get(Da.key).next(function(t){var r=[];return n.$t(function(n,i){var o=new ci(n),s=function(t){return[0,fa(t)]}(o);r.push(e.get(s).next(function(n){return n?La.resolve():function(n){return e.put(new Sa(0,fa(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return La.waitFor(r)})})},t.prototype.Pe=function(t,e){t.createObjectStore(Aa.store,{keyPath:Aa.keyPath});var n=e.store(Aa.store),r=new fu,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:fa(i)})}};return e.store(Ta.store).$t({kt:!0},function(t,e){var n=new ci(t);return i(n.popLast())}).next(function(){return e.store(wa.store).$t({kt:!0},function(t,e){var n=ya(t[1]);return i(n.popLast())})})},t.prototype.Ve=function(t){var e=this,n=t.store(Oa.store);return n.$t(function(t,r){var i=ou(r),o=su(e.R,i);return n.put(o)})},t}();function zu(t){t.createObjectStore(Sa.store,{keyPath:Sa.keyPath}).createIndex(Sa.documentTargetsIndex,Sa.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Oa.store,{keyPath:Oa.keyPath}).createIndex(Oa.queryTargetsIndexName,Oa.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Da.store)}var Gu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Qu=function(){function t(e,n,r,i,o,s,a,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=c,this.Ce=h,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new Br(qr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Ru(this,i),this.Le=n+"main",this.R=new $a(u),this.Be=new Ua(this.Le,11,new Ku(this.R)),this.qe=new Ou(this.referenceDelegate,this.R),this.Ut=new du,this.Ue=function(t,e){return new Uu(t,e)}(this.R,this.Ut),this.Qe=new uu,this.window&&this.window.localStorage?this.Ke=this.window.localStorage:(this.Ke=null,!1===h&&Qr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Br(qr.FAILED_PRECONDITION,Gu);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.qe.getHighestSequenceNumber(e)})}).then(function(e){t.Ne=new Fr(e,t.De)}).then(function(){t.xe=!0}).catch(function(e){return t.Be&&t.Be.close(),Promise.reject(e)})},t.prototype.He=function(t){var e=this;return this.Me=function(n){return Object(Mr.b)(e,void 0,void 0,function(){return Object(Mr.d)(this,function(e){return this.started?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt(function(n){return Object(Mr.b)(e,void 0,void 0,function(){return Object(Mr.d)(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget(function(){return Object(Mr.b)(e,void 0,void 0,function(){return Object(Mr.d)(this,function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Wu(e).put(new Na(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.Je(e).next(function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable(function(){return t.Me(!1)}))})}).next(function(){return t.Ye(e)}).next(function(n){return t.isPrimary&&!n?t.Xe(e).next(function(){return!1}):!!n&&t.Ze(e).next(function(){return!0})})}).catch(function(e){if(qa(e))return Gr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Gr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.Se.enqueueRetryable(function(){return t.Me(e)}),t.isPrimary=e})},t.prototype.Je=function(t){var e=this;return Hu(t).get(ma.key).next(function(t){return La.resolve(e.tn(t))})},t.prototype.en=function(t){return Wu(t).delete(this.clientId)},t.prototype.nn=function(){return Object(Mr.b)(this,void 0,void 0,function(){var t,e,n,r=this;return Object(Mr.d)(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var e=Ha(t,Na.store);return e.Nt().next(function(t){var n=r.rn(t,18e5),i=t.filter(function(t){return-1===n.indexOf(t)});return La.forEach(i,function(t){return e.delete(t.clientId)}).next(function(){return i})})}).catch(function(){return[]})]);case 1:if(t=i.sent(),this.Ke)for(e=0,n=t;e<n.length;e++)this.Ke.removeItem(this.on(n[e].clientId));i.label=2;case 2:return[2]}})})},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,function(){return t.je().then(function(){return t.nn()}).then(function(){return t.ze()})})},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?La.resolve(!0):Hu(t).get(ma.key).next(function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new Br(qr.FAILED_PRECONDITION,Gu);return!1}}return!(!e.networkEnabled||!e.inForeground)||Wu(t).Nt().next(function(t){return void 0===e.rn(t,5e3).find(function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))})})}).next(function(t){return e.isPrimary!==t&&Gr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.shutdown=function(){return Object(Mr.b)(this,void 0,void 0,function(){var t=this;return Object(Mr.d)(this,function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[ma.store,Na.store],function(e){var n=new Qa(e,Fr.o);return t.Xe(n).next(function(){return t.en(n)})})];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}})})},t.prototype.rn=function(t,e){var n=this;return t.filter(function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)})},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return Wu(e).Nt().next(function(e){return t.rn(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return bu.Kt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var r,i=this;return Gr("IndexedDbPersistence","Starting transaction:",t),this.Be.runTransaction(t,"readonly"===e?"readonly":"readwrite",Ca,function(o){return r=new Qa(o,i.Ne?i.Ne.next():Fr.o),"readwrite-primary"===e?i.Je(r).next(function(t){return!!t||i.Ye(r)}).next(function(e){if(!e)throw Qr("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.Se.enqueueRetryable(function(){return i.Me(!1)}),new Br(qr.FAILED_PRECONDITION,ja);return n(r)}).next(function(t){return i.Ze(r).next(function(){return t})}):i.dn(r).next(function(){return n(r)})}).then(function(t){return r.raiseOnCommittedEvent(),t})},t.prototype.dn=function(t){var e=this;return Hu(t).get(ma.key).next(function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Br(qr.FAILED_PRECONDITION,Gu)})},t.prototype.Ze=function(t){var e=new ma(this.clientId,this.allowTabSynchronization,Date.now());return Hu(t).put(ma.key,e)},t.yt=function(){return Ua.yt()},t.prototype.Xe=function(t){var e=this,n=Hu(t);return n.get(ma.key).next(function(t){return e.tn(t)?(Gr("IndexedDbPersistence","Releasing primary lease."),n.delete(ma.key)):La.resolve()})},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Qr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget(function(){return t.inForeground="visible"===t.document.visibilityState,t.je()})},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.un(),e.Se.enqueueAndForget(function(){return e.shutdown()})},this.window.addEventListener("pagehide",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("pagehide",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Ke)||void 0===e?void 0:e.getItem(this.on(t)));return Gr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Qr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Ke)try{this.Ke.setItem(this.on(this.clientId),String(Date.now()))}catch(t){Qr("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Ke)try{this.Ke.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Hu(t){return Ha(t,ma.store)}function Wu(t){return Ha(t,Na.store)}function Yu(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Xu=function(t,e){this.progress=t,this.wn=e},$u=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next(function(r){return n.yn(t,e,r)})},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next(function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t})},t.prototype.gn=function(t,e){t.forEach(function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)})},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next(function(e){return n.En(t,e).next(function(){return e})})},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next(function(t){return n.gn(e,t)})},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return _i.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):go(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new _i(e)).next(function(t){var e=ms();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e})},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=ms();return this.Ut.getCollectionParents(t,i).next(function(s){return La.forEach(s,function(s){var a=function(t,e){return new uo(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.An(t,a,n).next(function(t){t.forEach(function(t,e){o=o.insert(t,e)})})}).next(function(){return o})})},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next(function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)}).next(function(e){return o.Rn(t,i=e,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,h=r.get(c);null==h&&(h=qi.newInvalidDocument(c),r=r.insert(c,h)),Ho(u,h,o.localWriteTime),h.isFoundDocument()||(r=r.remove(c))}})}).next(function(){return r.forEach(function(t,n){To(e,n)||(r=r.remove(t))}),r})},t.prototype.Rn=function(t,e,n){for(var r=Is(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof Jo&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next(function(t){return t.forEach(function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))}),c})},t}(),Ju=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=Is(),i=Is(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Zu=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(ii.min())?this.Dn(t,e):this.Sn.pn(t,r).next(function(o){var s=i.Cn(e,o);return(lo(e)||fo(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(zr()<=N.a.DEBUG&&Gr("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Eo(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next(function(t){return s.forEach(function(e){t=t.insert(e.key,e)}),t}))})},t.prototype.Cn=function(t,e){var n=new fs(_o(t));return e.forEach(function(e,r){To(t,r)&&(n=n.add(r))}),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return zr()<=N.a.DEBUG&&Gr("QueryEngine","Using full collection scan to execute query:",Eo(e)),this.Sn.getDocumentsMatchingQuery(t,e,ii.min())},t}(),tc=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new cs(ti),this.kn=new Lu(function(t){return zi(t)},Gi),this.$n=ii.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new $u(this.On,this._n,this.persistence.getIndexManager()),this.Qe=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.collect(n,e.Fn)})},t}();function ec(t,e,n,r){return new tc(t,e,n,r)}function nc(t,e){return Object(Mr.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(Mr.d)(this,function(s){switch(s.label){case 0:return n=$r(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n._n.getAllMutationBatches(t).next(function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new $u(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)}).next(function(e){for(var n=[],r=[],s=Is(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++)s=s.add(l[h].key)}for(var f=0,d=e;f<d.length;f++){var p=d[f];r.push(p.batchId);for(var y=0,g=p.mutations;y<g.length;y++)s=s.add(g[y].key)}return i.pn(t,s).next(function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}})})})];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}})})}function rc(t,e){var n=$r(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=La.resolve();return o.forEach(function(t){s=s.next(function(){return r.getEntry(e,t)}).next(function(e){var o=n.docVersions.get(t);Xr(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))})}),s.next(function(){return t._n.removeMutationBatch(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n._n.performConsistencyCheck(t)}).next(function(){return n.Mn.pn(t,r)})})}function ic(t){var e=$r(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.qe.getLastRemoteSnapshotVersion(t)})}function oc(t,e){var n=$r(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.Fn;var s=[];e.targetChanges.forEach(function(e,o){var a=i.get(o);if(a){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next(function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)}));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=a.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return Xr(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,c,e)&&s.push(n.qe.updateTargetData(t,c))}}});var a=ys();if(e.documentUpdates.forEach(function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))}),s.push(sc(t,o,e.documentUpdates,r,void 0).next(function(t){a=t})),!r.isEqual(ii.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next(function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)});s.push(u)}return La.waitFor(s).next(function(){return o.apply(t)}).next(function(){return n.Mn.En(t,a)}).next(function(){return a})}).then(function(t){return n.Fn=i,t})}function sc(t,e,n,r,i){var o=Is();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var o=ys();return n.forEach(function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(ii.min())?(e.removeEntry(n,u),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):Gr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)}),o})}function ac(t,e){var n=$r(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)})}function uc(t,e){var n=$r(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.qe.getTargetData(t,e).next(function(i){return i?La.resolve(r=i):n.qe.allocateTargetId(t).next(function(i){return r=new Xa(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next(function(){return r})})})}).then(function(t){var r=n.Fn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t})}function cc(t,e,n){return Object(Mr.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Mr.d)(this,function(a){switch(a.label){case 0:r=$r(t),i=r.Fn.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.referenceDelegate.removeTarget(t,i)})];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!qa(s=a.sent()))throw s;return Gr("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}})})}function hc(t,e,n){var r=$r(t),i=ii.min(),o=Is();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=$r(t),i=r.kn.get(n);return void 0!==i?La.resolve(r.Fn.get(i)):r.qe.getTargetData(e,n)}(r,t,vo(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next(function(t){o=t})}).next(function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:ii.min(),n?o:Is())}).next(function(t){return{documents:t,Bn:o}})})}function lc(t,e){var n=$r(t),r=$r(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.lt(t,e).next(function(t){return t?t.target:null})})}function fc(t){var e=$r(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=$r(t),i=ys(),o=tu(n),s=qu(e),a=IDBKeyRange.lowerBound(o,!0);return s.$t({index:Ta.readTimeIndex,range:a},function(t,e){var n=Ja(r.R,e);i=i.insert(n.key,n),o=e.readTime}).next(function(){return{wn:i,readTime:eu(o)}})}(e.On,t,e.$n)}).then(function(t){var n=t.wn;return e.$n=t.readTime,n})}function dc(t){return Object(Mr.b)(this,void 0,void 0,function(){var e;return Object(Mr.d)(this,function(n){return[2,(e=$r(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=qu(t),n=ii.min();return e.$t({index:Ta.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=eu(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){e.$n=t})]})})}function pc(t,e,n,r){return Object(Mr.b)(this,void 0,void 0,function(){var i,o,s,a,u,c,h,l,f,d;return Object(Mr.d)(this,function(p){switch(p.label){case 0:for(i=$r(t),o=Is(),s=ys(),a=bs(),u=0,c=n;u<c.length;u++)l=e.qn((h=c[u]).metadata.name),h.document&&(o=o.add(l)),s=s.insert(l,e.Un(h)),a=a.insert(l,e.Qn(h.metadata.readTime));return f=i.On.newChangeBuffer({trackRemovals:!0}),[4,uc(i,function(t){return vo(ho(ci.fromString("__bundle__/docs/"+t)))}(r))];case 1:return d=p.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",function(t){return sc(t,f,s,ii.min(),a).next(function(e){return f.apply(t),e}).next(function(e){return i.qe.removeMatchingKeysForTargetId(t,d.targetId).next(function(){return i.qe.addMatchingKeys(t,o,d.targetId)}).next(function(){return i.Mn.En(t,e)}).next(function(){return e})})})]}})})}function yc(t,e,n){return void 0===n&&(n=Is()),Object(Mr.b)(this,void 0,void 0,function(){var r,i;return Object(Mr.d)(this,function(o){switch(o.label){case 0:return[4,uc(t,vo(au(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=$r(t)).persistence.runTransaction("Save named query","readwrite",function(t){var o=Ms(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Qe.saveNamedQuery(t,e);var s=r.withResumeToken(di.EMPTY_BYTE_STRING,o);return i.Fn=i.Fn.insert(s.targetId,s),i.qe.updateTargetData(t,s).next(function(){return i.qe.removeMatchingKeysForTargetId(t,r.targetId)}).next(function(){return i.qe.addMatchingKeys(t,n,r.targetId)}).next(function(){return i.Qe.saveNamedQuery(t,e)})})]}})})}var gc=function(){function t(t){this.R=t,this.Kn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return La.resolve(this.Kn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Kn.set(e.id,{id:(n=e).id,version:n.version,createTime:Ms(n.createTime)}),La.resolve()},t.prototype.getNamedQuery=function(t,e){return La.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:au(t.bundledQuery),readTime:Ms(t.readTime)}}(e)),La.resolve()},t}(),mc=function(){function t(){this.Wn=new fs(vc.Gn),this.zn=new fs(vc.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new vc(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},t.prototype.removeReference=function(t,e){this.Yn(new vc(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},t.prototype.Zn=function(t){var e=this,n=new _i(new ci([])),r=new vc(n,t),i=new vc(n,t+1),o=[];return this.zn.forEachInRange([r,i],function(t){e.Yn(t),o.push(t.key)}),o},t.prototype.ts=function(){var t=this;this.Wn.forEach(function(e){return t.Yn(e)})},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new _i(new ci([])),n=new vc(e,t),r=new vc(e,t+1),i=Is();return this.zn.forEachInRange([n,r],function(t){i=i.add(t.key)}),i},t.prototype.containsKey=function(t){var e=new vc(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),vc=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return _i.comparator(t.key,e.key)||ti(t.ns,e.ns)},t.Hn=function(t,e){return ti(t.ns,e.ns)||_i.comparator(t.key,e.key)},t}(),bc=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new fs(vc.Gn)}return t.prototype.checkEmpty=function(t){return La.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++;var o=new Wa(i,e,n,r);this._n.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.rs=this.rs.add(new vc(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return La.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return La.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this.cs(e+1),r=n<0?0:n;return La.resolve(this._n.length>r?this._n[r]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return La.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return La.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new vc(e,0),i=new vc(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],function(t){var e=n.os(t.ns);o.push(e)}),La.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new fs(ti);return e.forEach(function(t){var e=new vc(t,0),i=new vc(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],function(t){r=r.add(t.ns)})}),La.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;_i.isDocumentKey(i)||(i=i.child(""));var o=new vc(new _i(i),0),s=new fs(ti);return this.rs.forEachWhile(function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)},o),La.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.os(t);null!==r&&n.push(r)}),n},t.prototype.removeMutationBatch=function(t,e){var n=this;Xr(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return La.forEach(e.mutations,function(i){var o=new vc(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(function(){n.rs=r})},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new vc(e,0),r=this.rs.firstAfterOrEqual(n);return La.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return La.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),wc=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new cs(_i.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return La.resolve(n?n.document.clone():qi.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=ys();return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():qi.newInvalidDocument(t))}),La.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=ys(),i=new _i(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.value,u=a.document,c=a.readTime;if(!e.path.isPrefixOf(s.key.path))break;c.compareTo(n)<=0||To(e,u)&&(r=r.insert(u.key,u.clone()))}return La.resolve(r)},t.prototype.fs=function(t,e){return La.forEach(this.docs,function(t){return e(t)})},t.prototype.newChangeBuffer=function(t){return new Ic(this)},t.prototype.getSize=function(t){return La.resolve(this.size)},t}(),Ic=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return Object(Mr.c)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach(function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)}),La.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(Vu),Ec=function(){function t(t){this.persistence=t,this.ds=new Lu(function(t){return zi(t)},Gi),this.lastRemoteSnapshotVersion=ii.min(),this.highestTargetId=0,this.ws=0,this._s=new mc,this.targetCount=0,this.ys=_u.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach(function(t,n){return e(n)}),La.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return La.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return La.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),La.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),La.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new _u(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,La.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),La.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,La.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach(function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)}),La.waitFor(o).next(function(){return i})},t.prototype.getTargetCount=function(t){return La.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return La.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),La.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.markPotentiallyOrphaned(t,e))}),La.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),La.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return La.resolve(n)},t.prototype.containsKey=function(t,e){return La.resolve(this._s.containsKey(e))},t}(),Tc=function(){function t(t,e){var n=this;this.gs={},this.Ne=new Fr(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new Ec(this),this.Ut=new lu,this.Ue=function(t,e){return new wc(t,function(t){return n.referenceDelegate.ps(t)})}(this.Ut),this.R=new $a(e),this.Qe=new gc(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new bc(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var r=this;Gr("MemoryPersistence","Starting transaction:",t);var i=new _c(this.Ne.next());return this.referenceDelegate.Es(),n(i).next(function(t){return r.referenceDelegate.Ts(i).next(function(){return t})}).toPromise().then(function(t){return i.raiseOnCommittedEvent(),t})},t.prototype.Is=function(t,e){return La.or(Object.values(this.gs).map(function(n){return function(){return n.containsKey(t,e)}}))},t}(),_c=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return Object(Mr.c)(e,t),e}(Ra),Oc=function(){function t(t){this.persistence=t,this.As=new mc,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw Yr()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),La.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),La.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),La.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach(function(t){return n.vs.add(t.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(function(t){t.forEach(function(t){return n.vs.add(t.toString())})}).next(function(){return r.removeTargetData(t,e)})},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return La.forEach(this.vs,function(r){var i=_i.fromPath(r);return e.Ps(t,i).next(function(t){t||n.removeEntry(i)})}).next(function(){return e.Rs=null,n.apply(t)})},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next(function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())})},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return La.or([function(){return La.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),Sc=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();function Dc(t,e){return"firestore_clients_"+t+"_"+e}function Ac(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function Nc(t,e){return"firestore_targets_"+t+"_"+e}Sc.UNAUTHENTICATED=new Sc(null),Sc.GOOGLE_CREDENTIALS=new Sc("google-credentials-uid"),Sc.FIRST_PARTY=new Sc("first-party-uid");var kc=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new Br(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(Qr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),xc=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Br(i.error.code,i.error.message)),o?new t(e,i.state,r):(Qr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Cc=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Ts(),s=0;i&&s<r.activeTargetIds.length;++s)i=Ti(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(Qr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),jc=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Qr("SharedClientState","Failed to parse online state: "+e),null)},t}(),Rc=function(){function t(){this.activeTargetIds=Ts()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Pc=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new cs(ti),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=Dc(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new Rc),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Qs=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(Mr.b)(this,void 0,void 0,function(){var t,e,n,r,i,o,s,a,u,c,h=this;return Object(Mr.d)(this,function(l){switch(l.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=l.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(Dc(this.persistenceKey,r)))&&(o=Cc.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Ks(),(s=this.storage.getItem(this.Us))&&(a=this.js(s))&&this.Ws(a),u=0,c=this.$s;u<c.length;u++)this.Fs(c[u]);return this.$s=[],this.window.addEventListener("pagehide",function(){return h.shutdown()}),this.started=!0,[2]}})})},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(Nc(this.persistenceKey,t));if(n){var r=xc.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Ks(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Ks()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(Nc(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach(function(t){r.Hs(t)}),this.currentUser=t,n.forEach(function(t){r.addPendingMutation(t)})},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Gr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Gr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Gr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Gr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void Qr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable(function(){return Object(Mr.b)(e,void 0,void 0,function(){var t,e,r,i,o,s;return Object(Mr.d)(this,function(a){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(s=function(t){var e=Fr.o;if(null!=t)try{var n=JSON.parse(t);Xr("number"==typeof n),e=n}catch(t){Qr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Fr.o&&this.sequenceNumberHandler(s);else if(n.key===this.Qs)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Ks=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new kc(this.currentUser,t,e,n),i=Ac(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=Ac(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){this.storage.setItem(this.Us,JSON.stringify({clientId:this.Ns,onlineState:t}))},t.prototype.Ys=function(t,e,n){var r=Nc(this.persistenceKey,t),i=new xc(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Qs,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return Cc.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]);return kc.Vs(new Sc(void 0!==n[2]?n[2]:null),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return xc.Vs(r,e)},t.prototype.js=function(t){return jc.Vs(t)},t.prototype.ii=function(t){return Object(Mr.b)(this,void 0,void 0,function(){return Object(Mr.d)(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(Gr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),s=[],a=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||a.push(t)}),this.syncEngine.hi(s,a).then(function(){n.ks=r})},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=Ts();return t.forEach(function(t,n){e=e.unionWith(n.activeTargetIds)}),e},t}(),Lc=function(){function t(){this.li=new Rc,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new Rc,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),Vc=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),Uc=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){Gr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){Gr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Mc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Fc=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),qc=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return Object(Mr.c)(e,t),e.prototype.ki=function(t,e,n,r){return new Promise(function(i,o){var s=new Ur;s.listenOnce(Rr.COMPLETE,function(){try{switch(s.getLastErrorCode()){case jr.NO_ERROR:var e=s.getResponseJson();Gr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case jr.TIMEOUT:Gr("Connection",'RPC "'+t+'" timed out'),o(new Br(qr.DEADLINE_EXCEEDED,"Request time out"));break;case jr.HTTP_ERROR:var n=s.getStatus();if(Gr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(qr).indexOf(e)>=0?e:qr.UNKNOWN}(r.status);o(new Br(a,r.message))}else o(new Br(qr.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Br(qr.UNAVAILABLE,"Connection failed."));break;default:Yr()}}finally{Gr("Connection",'RPC "'+t+'" completed.')}});var a=JSON.stringify(r);s.send(e,"POST",a,n,15)})},e.prototype.Oi=function(t,e){var n=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new Er,i=_e(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new Lr({})),this.Fi(o.initMessageHeaders,e),Object(A.n)()||Object(A.p)()||Object(A.l)()||Object(A.m)()||Object(A.q)()||Object(A.k)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");Gr("Connection","Creating WebChannel: "+s,o);var a=r.createWebChannel(s,o),u=!1,c=!1,h=new Fc({Ei:function(t){c?Gr("Connection","Not sending because WebChannel is closed:",t):(u||(Gr("Connection","Opening WebChannel transport."),a.open(),u=!0),Gr("Connection","WebChannel sending:",t),a.send(t))},Ti:function(){return a.close()}}),l=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return l(a,Vr.EventType.OPEN,function(){c||Gr("Connection","WebChannel transport opened.")}),l(a,Vr.EventType.CLOSE,function(){c||(c=!0,Gr("Connection","WebChannel transport closed"),h.Vi())}),l(a,Vr.EventType.ERROR,function(t){c||(c=!0,Hr("Connection","WebChannel transport errored:",t),h.Vi(new Br(qr.UNAVAILABLE,"The operation could not be completed")))}),l(a,Vr.EventType.MESSAGE,function(t){var e;if(!c){var n=t.data[0];Xr(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){Gr("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=ns[t];if(void 0!==e)return us(e)}(i),s=r.message;void 0===o&&(o=qr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,h.Vi(new Br(o,s)),a.close()}else Gr("Connection","WebChannel received:",n),h.Si(n)}}),l(i,Pr.STAT_EVENT,function(t){10===t.stat?Gr("Connection","Detected buffering proxy"):11===t.stat&&Gr("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Pi()},0),h},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId,this.Di=(t.ssl?"https":"http")+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);Gr("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then(function(t){return Gr("RestConnection","Received: ",t),t},function(e){throw Hr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.6.7",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){return this.Di+"/v1/"+e+":"+Mc[t]},t}());function Bc(){return"undefined"!=typeof window?window:null}function Kc(){return"undefined"!=typeof document?document:null}function zc(t){return new Ps(t,!0)}var Gc=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Qi=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Ki=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Qi),i=Math.max(0,n-r);i>0&&Gr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,function(){return e.Qi=Date.now(),t()}),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),Qc=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Gc(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return Object(Mr.b)(this,void 0,void 0,function(){return Object(Mr.d)(this,function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,function(){return t.rr()}))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return Object(Mr.b)(this,void 0,void 0,function(){return Object(Mr.d)(this,function(t){return this.er()?[2,this.close(0)]:[2]})})},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return Object(Mr.b)(this,void 0,void 0,function(){return Object(Mr.d)(this,function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===qr.RESOURCE_EXHAUSTED?(Qr(e.toString()),Qr("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Ki()):e&&e.code===qr.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}})})},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then(function(e){t.Yi===n&&t.lr(e)},function(n){e(function(){var e=new Br(qr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)})})},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii(function(){n(function(){return e.state=2,e.listener.Ii()})}),this.stream.Ri(function(t){n(function(){return e.dr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji(function(){return Object(Mr.b)(t,void 0,void 0,function(){return Object(Mr.d)(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.dr=function(t){return Gr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget(function(){return e.Yi===t?n():(Gr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),Hc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return Object(Mr.c)(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Yr()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(Xr(void 0===e||"string"==typeof e),di.fromBase64String(e||"")):(Xr(void 0===e||e instanceof Uint8Array),di.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?qr.UNKNOWN:us(t.code);return new Br(e,t.message||"")}(a);n=new As(r,i,o,s||null)}else if("documentChange"in e){i=Ks(t,(r=e.documentChange).document.name),o=Ms(r.document.updateTime);var a=new Mi({mapValue:{fields:r.document.fields}}),u=(s=qi.newFoundDocument(i,o,a),r.targetIds||[]);n=new Ss(u,r.removedTargetIds||[],s.key,s)}else if("documentDelete"in e)i=Ks(t,(r=e.documentDelete).document),o=r.readTime?Ms(r.readTime):ii.min(),a=qi.newNoDocument(i,o),n=new Ss([],s=r.removedTargetIds||[],a.key,a);else if("documentRemove"in e)i=Ks(t,(r=e.documentRemove).document),n=new Ss([],o=r.removedTargetIds||[],i,null);else{if(!("filter"in e))return Yr();var c=e.filter;i=new ss(r=c.count||0),n=new Ds(o=c.targetId,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return ii.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?ii.min():e.readTime?Ms(e.readTime):ii.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=Qs(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=Qi(r)?{documents:Js(t,r)}:{query:Zs(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Vs(t,e.resumeToken):e.snapshotVersion.compareTo(ii.min())>0&&(n.readTime=Ls(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Yr()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=Qs(this.R),e.removeTarget=t,this.cr(e)},e}(Qc),Wc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return Object(Mr.c)(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(Xr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(Xr(void 0!==e),t.map(function(t){return function(t,e){var n=Ms(t.updateTime?t.updateTime:e);return n.isEqual(ii.min())&&(n=Ms(e)),new Bo(n,t.transformResults||[])}(t,e)})):[]}(t.writeResults,t.commitTime),n=Ms(t.commitTime);return this.listener.Tr(n,e)}return Xr(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=Qs(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Xs(e.R,t)})};this.cr(n)},e}(Qc),Yc=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return Object(Mr.c)(e,t),e.prototype.br=function(){if(this.Rr)throw new Br(qr.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.Ni(t,e,n,i)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===qr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Br(qr.UNKNOWN,t.toString())})},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.$i(t,e,n,i)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===qr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Br(qr.UNKNOWN,t.toString())})},e.prototype.terminate=function(){this.Rr=!0},e}(function(){}),Xc=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()}))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(Qr(e),this.Vr=!1):Gr("OnlineStateTracker",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),$c=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di(function(t){n.enqueueAndForget(function(){return Object(Mr.b)(o,void 0,void 0,function(){return Object(Mr.d)(this,function(t){switch(t.label){case 0:return sh(this)?(Gr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(Mr.b)(this,void 0,void 0,function(){var e;return Object(Mr.d)(this,function(n){switch(n.label){case 0:return(e=$r(t)).Or.add(4),[4,Zc(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,Jc(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Br=new Xc(n,r)};function Jc(t){return Object(Mr.b)(this,void 0,void 0,function(){var e,n;return Object(Mr.d)(this,function(r){switch(r.label){case 0:if(!sh(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Zc(t){return Object(Mr.b)(this,void 0,void 0,function(){var e,n;return Object(Mr.d)(this,function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function th(t,e){var n=$r(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),oh(n)?ih(n):Ih(n).er()&&nh(n,e))}function eh(t,e){var n=$r(t),r=Ih(n);n.$r.delete(e),r.er()&&rh(n,e),0===n.$r.size&&(r.er()?r.ir():sh(n)&&n.Br.set("Unknown"))}function nh(t,e){t.qr.U(e.targetId),Ih(t).mr(e)}function rh(t,e){t.qr.U(e),Ih(t).yr(e)}function ih(t){t.qr=new ks({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),Ih(t).start(),t.Br.Sr()}function oh(t){return sh(t)&&!Ih(t).tr()&&t.$r.size>0}function sh(t){return 0===$r(t).Or.size}function ah(t){t.qr=void 0}function uh(t){return Object(Mr.b)(this,void 0,void 0,function(){return Object(Mr.d)(this,function(e){return t.$r.forEach(function(e,n){nh(t,e)}),[2]})})}function ch(t,e){return Object(Mr.b)(this,void 0,void 0,function(){return Object(Mr.d)(this,function(n){return ah(t),oh(t)?(t.Br.Nr(e),ih(t)):t.Br.set("Unknown"),[2]})})}function hh(t,e,n){return Object(Mr.b)(this,void 0,void 0,function(){var r,i,o;return Object(Mr.d)(this,function(s){switch(s.label){case 0:if(t.Br.set("Online"),!(e instanceof As&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Object(Mr.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(Mr.d)(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.$r.has(o=i[r])?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.$r.delete(o),t.qr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),Gr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,lh(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Ss?t.qr.X(e):e instanceof Ds?t.qr.rt(e):t.qr.et(e),n.isEqual(ii.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,ic(t.localStore)];case 8:return i=s.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach(function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}}),n.targetMismatches.forEach(function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(di.EMPTY_BYTE_STRING,n.snapshotVersion)),rh(t,e);var r=new Xa(n.target,e,1,n.sequenceNumber);nh(t,r)}}),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return Gr("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,lh(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function lh(t,e,n){return Object(Mr.b)(this,void 0,void 0,function(){var r=this;return Object(Mr.d)(this,function(i){switch(i.label){case 0:if(!qa(e))throw e;return t.Or.add(1),[4,Zc(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return ic(t.localStore)}),t.asyncQueue.enqueueRetryable(function(){return Object(Mr.b)(r,void 0,void 0,function(){return Object(Mr.d)(this,function(e){switch(e.label){case 0:return Gr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,Jc(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function fh(t,e){return e().catch(function(n){return lh(t,n,e)})}function dh(t){return Object(Mr.b)(this,void 0,void 0,function(){var e,n,r,i,o;return Object(Mr.d)(this,function(s){switch(s.label){case 0:e=$r(t),n=Eh(e),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return sh(t)&&t.kr.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,ac(e.localStore,r)];case 3:return null===(i=s.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=Eh(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,lh(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return ph(e)&&yh(e),[2]}})})}function ph(t){return sh(t)&&!Eh(t).tr()&&t.kr.length>0}function yh(t){Eh(t).start()}function gh(t){return Object(Mr.b)(this,void 0,void 0,function(){return Object(Mr.d)(this,function(e){return Eh(t).Ar(),[2]})})}function mh(t){return Object(Mr.b)(this,void 0,void 0,function(){var e,n,r;return Object(Mr.d)(this,function(i){for(e=Eh(t),n=0,r=t.kr;n<r.length;n++)e.Er(r[n].mutations);return[2]})})}function vh(t,e,n){return Object(Mr.b)(this,void 0,void 0,function(){var r,i;return Object(Mr.d)(this,function(o){switch(o.label){case 0:return r=t.kr.shift(),i=Ya.from(r,e,n),[4,fh(t,function(){return t.remoteSyncer.applySuccessfulWrite(i)})];case 1:return o.sent(),[4,dh(t)];case 2:return o.sent(),[2]}})})}function bh(t,e){return Object(Mr.b)(this,void 0,void 0,function(){return Object(Mr.d)(this,function(n){switch(n.label){case 0:return e&&Eh(t).pr?[4,function(t,e){return Object(Mr.b)(this,void 0,void 0,function(){var n,r;return Object(Mr.d)(this,function(i){switch(i.label){case 0:return as(r=e.code)&&r!==qr.ABORTED?(n=t.kr.shift(),Eh(t).sr(),[4,fh(t,function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,dh(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return ph(t)&&yh(t),[2]}})})}function wh(t,e){return Object(Mr.b)(this,void 0,void 0,function(){var n;return Object(Mr.d)(this,function(r){switch(r.label){case 0:return n=$r(t),e?(n.Or.delete(2),[4,Jc(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,Zc(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function Ih(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=$r(t);return r.br(),new Hc(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:uh.bind(null,t),Ri:ch.bind(null,t),_r:hh.bind(null,t)}),t.Mr.push(function(n){return Object(Mr.b)(e,void 0,void 0,function(){return Object(Mr.d)(this,function(e){switch(e.label){case 0:return n?(t.Ur.sr(),oh(t)?ih(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),ah(t),e.label=3;case 3:return[2]}})})})),t.Ur}function Eh(t){var e=this;return t.Qr||(t.Qr=function(t,e,n){var r=$r(t);return r.br(),new Wc(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:gh.bind(null,t),Ri:bh.bind(null,t),Ir:mh.bind(null,t),Tr:vh.bind(null,t)}),t.Mr.push(function(n){return Object(Mr.b)(e,void 0,void 0,function(){return Object(Mr.d)(this,function(e){switch(e.label){case 0:return n?(t.Qr.sr(),[4,dh(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Qr.stop()];case 3:e.sent(),t.kr.length>0&&(Gr("RemoteStore","Stopping write stream with "+t.kr.length+" pending writes"),t.kr=[]),e.label=4;case 4:return[2]}})})})),t.Qr}var Th=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Pa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(t){})}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout(function(){return e.handleDelayElapsed()},t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Br(qr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget(function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then(function(e){return t.deferred.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function _h(t,e){if(Qr("AsyncQueue",e+": "+t),qa(t))return new Br(qr.UNAVAILABLE,e+": "+t);throw t}var Oh=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||_i.comparator(e.key,n.key)}:function(t,e){return _i.comparator(t.key,e.key)},this.keyedMap=ms(),this.sortedSet=new cs(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),Sh=function(){function t(){this.Kr=new cs(_i.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Kr.get(e);n?0!==t.type&&3===n.type?this.Kr=this.Kr.insert(e,t):3===t.type&&1!==n.type?this.Kr=this.Kr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Kr=this.Kr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Kr=this.Kr.remove(e):1===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):Yr():this.Kr=this.Kr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Kr.inorderTraversal(function(e,n){t.push(n)}),t},t}(),Dh=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,Oh.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&wo(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Ah=function(){this.Wr=void 0,this.listeners=[]},Nh=function(){this.queries=new Lu(function(t){return Io(t)},wo),this.onlineState="Unknown",this.Gr=new Set};function kh(t,e){return Object(Mr.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u;return Object(Mr.d)(this,function(c){switch(c.label){case 0:if(n=$r(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new Ah),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=c.sent(),[3,4];case 3:return a=c.sent(),u=_h(a,"Initialization of query '"+Eo(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&Rh(n),[2]}})})}function xh(t,e){return Object(Mr.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Mr.d)(this,function(a){return n=$r(t),i=!1,(o=n.queries.get(r=e.query))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]})})}function Ch(t,e){for(var n=$r(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=n.queries.get(s.query);if(a){for(var u=0,c=a.listeners;u<c.length;u++)c[u].Hr(s)&&(r=!0);a.Wr=s}}r&&Rh(n)}function jh(t,e,n){var r=$r(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Rh(t){t.Gr.forEach(function(t){t.next()})}var Ph=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Dh(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){return!t.fromCache||!(this.options.so&&"Offline"!==e||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){return t.docChanges.length>0||!!(t.syncStateChanged||this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=Dh.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),Lh=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.io=function(){return"metadata"in this.payload},t}(),Vh=function(){function t(t){this.R=t}return t.prototype.qn=function(t){return Ks(this.R,t)},t.prototype.Un=function(t){return t.metadata.exists?Ys(this.R,t.document,!1):qi.newNoDocument(this.qn(t.metadata.name),this.Qn(t.metadata.readTime))},t.prototype.Qn=function(t){return Ms(t)},t}();!function(){function t(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=function(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(t)}t.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.co=function(t){for(var e=new Map,n=new Vh(this.R),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.qn(o.metadata.name),a=0,u=o.metadata.queries;a<u.length;a++){var c=u[a],h=(e.get(c)||Is()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return Object(Mr.b)(this,void 0,void 0,function(){var t,e,n,r,i;return Object(Mr.d)(this,function(o){switch(o.label){case 0:return[4,pc(this.localStore,new Vh(this.R),this.documents,this.ro.id)];case 1:t=o.sent(),e=this.co(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?[4,yc(this.localStore,i=r[n],e.get(i.name))]:[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Xu(Object.assign({},this.progress),t))]}})})}}();var Uh=function(t){this.key=t},Mh=function(t){this.key=t},Fh=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=Is(),this.mutatedKeys=Is(),this.lo=_o(t),this.fo=new Oh(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new Sh,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=lo(this.query)&&i.size===this.query.limit?i.last():null,c=fo(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(function(t,e){var h=i.get(t),l=To(n.query,e)?e:null,f=!!h&&n.mutatedKeys.has(h.key),d=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),p=!1;h&&l?h.data.isEqual(l.data)?f!==d&&(r.track({type:3,doc:l}),p=!0):n.yo(h,l)||(r.track({type:2,doc:l}),p=!0,(u&&n.lo(l,u)>0||c&&n.lo(l,c)<0)&&(a=!0)):!h&&l?(r.track({type:0,doc:l}),p=!0):h&&!l&&(r.track({type:1,doc:h}),p=!0,(u||c)&&(a=!0)),p&&(l?(s=s.add(l),o=d?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),lo(this.query)||fo(this.query))for(;s.size>this.query.limit;){var h=lo(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Yr()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)}),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new Dh(this.query,t.fo,i,o,t.mutatedKeys,0===a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new Sh,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach(function(t){return e.uo=e.uo.add(t)}),t.modifiedDocuments.forEach(function(t){}),t.removedDocuments.forEach(function(t){return e.uo=e.uo.delete(t)}),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=Is(),this.fo.forEach(function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))});var n=[];return e.forEach(function(e){t.ho.has(e)||n.push(new Mh(e))}),this.ho.forEach(function(t){e.has(t)||n.push(new Uh(t))}),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=Is();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return Dh.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),qh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Bh=function(t){this.key=t,this.bo=!1},Kh=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new Lu(function(t){return Io(t)},wo),this.Vo=new Map,this.So=new Set,this.Do=new cs(_i.comparator),this.Co=new Map,this.No=new mc,this.xo={},this.Fo=new Map,this.ko=_u.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();function zh(t,e){return Object(Mr.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Mr.d)(this,function(a){switch(a.label){case 0:return n=bl(t),(i=n.Po.get(e))?(n.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.Ro(),[3,4]):[3,1];case 1:return[4,uc(n.localStore,vo(e))];case 2:return o=a.sent(),s=n.sharedClientState.addLocalQueryTarget(o.targetId),[4,Gh(n,e,o.targetId,"current"===s)];case 3:r=a.sent(),n.isPrimaryClient&&th(n.remoteStore,o),a.label=4;case 4:return[2,r]}})})}function Gh(t,e,n,r){return Object(Mr.b)(this,void 0,void 0,function(){var i,o,s,a,u,c;return Object(Mr.d)(this,function(h){switch(h.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return Object(Mr.b)(this,void 0,void 0,function(){var i,o,s;return Object(Mr.d)(this,function(a){switch(a.label){case 0:return(i=e.view._o(n)).Nn?[4,hc(t.localStore,e.query,!1).then(function(t){return e.view._o(t.documents,i)})]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(il(t,e.targetId,s.To),s.snapshot)]}})})}(t,e,n,r)},[4,hc(t.localStore,e,!0)];case 1:return i=h.sent(),o=new Fh(e,i.Bn),s=o._o(i.documents),a=Os.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(s,t.isPrimaryClient,a),il(t,n,u.To),c=new qh(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}})})}function Qh(t,e){return Object(Mr.b)(this,void 0,void 0,function(){var n,r,i;return Object(Mr.d)(this,function(o){switch(o.label){case 0:return n=$r(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter(function(t){return!wo(t,e)})),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,cc(n.localStore,r.targetId,!1).then(function(){n.sharedClientState.clearQueryState(r.targetId),eh(n.remoteStore,r.targetId),nl(n,r.targetId)}).catch(Nu)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return nl(n,r.targetId),[4,cc(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function Hh(t,e,n){return Object(Mr.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Mr.d)(this,function(a){switch(a.label){case 0:r=wl(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=$r(t),i=ri.now(),o=e.reduce(function(t,e){return t.add(e.key)},Is());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Mn.pn(t,o).next(function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],h=Wo(c,n.get(c.key));null!=h&&s.push(new Jo(c.key,h,Fi(h.value.mapValue),Ko.exists(!0)))}return r._n.addMutationBatch(t,i,s,e)})}).then(function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}})}(r.localStore,e)];case 2:return i=a.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new cs(ti)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,al(r,i.changes)];case 3:return a.sent(),[4,dh(r.remoteStore)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=_h(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function Wh(t,e){return Object(Mr.b)(this,void 0,void 0,function(){var n,r;return Object(Mr.d)(this,function(i){switch(i.label){case 0:n=$r(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,oc(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach(function(t,e){var r=n.Co.get(e);r&&(Xr(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?Xr(r.bo):t.removedDocuments.size>0&&(Xr(r.bo),r.bo=!1))}),[4,al(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Nu(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function Yh(t,e,n){var r=$r(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach(function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=$r(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)}),r&&Rh(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Xh(t,e,n){return Object(Mr.b)(this,void 0,void 0,function(){var r,i,o,s,a,u;return Object(Mr.d)(this,function(c){switch(c.label){case 0:return(r=$r(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(s=(s=new cs(_i.comparator)).insert(o,qi.newNoDocument(o,ii.min())),a=Is().add(o),u=new _s(ii.min(),new Map,new fs(ti),s,a),[4,Wh(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),sl(r),[3,4];case 2:return[4,cc(r.localStore,e,!1).then(function(){return nl(r,e,n)}).catch(Nu)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function $h(t,e){return Object(Mr.b)(this,void 0,void 0,function(){var n,r,i;return Object(Mr.d)(this,function(o){switch(o.label){case 0:n=$r(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,rc(n.localStore,e)];case 2:return i=o.sent(),el(n,r,null),tl(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,al(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Nu(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Jh(t,e,n){return Object(Mr.b)(this,void 0,void 0,function(){var r,i;return Object(Mr.d)(this,function(o){switch(o.label){case 0:r=$r(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=$r(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n._n.lookupMutationBatch(t,e).next(function(e){return Xr(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)}).next(function(){return n._n.performConsistencyCheck(t)}).next(function(){return n.Mn.pn(t,r)})})}(r.localStore,e)];case 2:return i=o.sent(),el(r,e,n),tl(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,al(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Nu(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Zh(t,e){return Object(Mr.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Mr.d)(this,function(a){switch(a.label){case 0:sh((n=$r(t)).remoteStore)||Gr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=$r(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e._n.getHighestUnacknowledgedBatchId(t)})}(n.localStore)];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return o=a.sent(),s=_h(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}})})}function tl(t,e){(t.Fo.get(e)||[]).forEach(function(t){t.resolve()}),t.Fo.delete(e)}function el(t,e,n){var r=$r(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function nl(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach(function(e){t.No.containsKey(e)||rl(t,e)})}function rl(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(eh(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),sl(t))}function il(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Uh?(t.No.addReference(o.key,e),ol(t,o)):o instanceof Mh?(Gr("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||rl(t,o.key)):Yr()}}function ol(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(Gr("SyncEngine","New document in limbo: "+n),t.So.add(r),sl(t))}function sl(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new _i(ci.fromString(e)),r=t.ko.next();t.Co.set(r,new Bh(n)),t.Do=t.Do.insert(n,r),th(t.remoteStore,new Xa(vo(ho(n.path)),r,2,Fr.o))}}function al(t,e,n){return Object(Mr.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Mr.d)(this,function(a){switch(a.label){case 0:return r=$r(t),i=[],o=[],s=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach(function(t,a){s.push(r.Oo(a,e,n).then(function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Ju.Pn(a.targetId,t);o.push(e)}}))}),[4,Promise.all(s)]);case 1:return a.sent(),r.vo._r(i),[4,function(t,e){return Object(Mr.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u,c;return Object(Mr.d)(this,function(h){switch(h.label){case 0:n=$r(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return La.forEach(e,function(e){return La.forEach(e.bn,function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)}).next(function(){return La.forEach(e.vn,function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)})})})})];case 2:return h.sent(),[3,4];case 3:if(!qa(r=h.sent()))throw r;return Gr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)a=(s=o[i]).targetId,s.fromCache||(u=n.Fn.get(a),c=u.withLastLimboFreeSnapshotVersion(u.snapshotVersion),n.Fn=n.Fn.insert(a,c));return[2]}})})}(r.localStore,o)];case 2:a.sent(),a.label=3;case 3:return[2]}})})}function ul(t,e){return Object(Mr.b)(this,void 0,void 0,function(){var n,r;return Object(Mr.d)(this,function(i){switch(i.label){case 0:return(n=$r(t)).currentUser.isEqual(e)?[3,3]:(Gr("SyncEngine","User change. New user:",e.toKey()),[4,nc(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fo.forEach(function(t){t.forEach(function(t){t.reject(new Br(qr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.Fo.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,al(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function cl(t,e){var n=$r(t),r=n.Co.get(e);if(r&&r.bo)return Is().add(r.key);var i=Is(),o=n.Vo.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=n.Po.get(a[s]);i=i.unionWith(u.view.wo)}return i}function hl(t,e){return Object(Mr.b)(this,void 0,void 0,function(){var n,r,i;return Object(Mr.d)(this,function(o){switch(o.label){case 0:return[4,hc((n=$r(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&il(n,e.targetId,i.To),i)]}})})}function ll(t){return Object(Mr.b)(this,void 0,void 0,function(){var e;return Object(Mr.d)(this,function(n){return[2,fc((e=$r(t)).localStore).then(function(t){return al(e,t)})]})})}function fl(t,e,n,r){return Object(Mr.b)(this,void 0,void 0,function(){var i,o;return Object(Mr.d)(this,function(s){switch(s.label){case 0:return[4,function(t,e){var n=$r(t),r=$r(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.jt(t,e).next(function(e){return e?n.Mn.pn(t,e):La.resolve(null)})})}((i=$r(t)).localStore,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,dh(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(el(i,e,r||null),tl(i,e),function(t,e){$r($r(t)._n).Gt(e)}(i.localStore,e)):Yr(),s.label=4;case 4:return[4,al(i,o)];case 5:return s.sent(),[3,7];case 6:Gr("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}function dl(t,e){return Object(Mr.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u;return Object(Mr.d)(this,function(c){switch(c.label){case 0:return bl(n=$r(t)),wl(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,pl(n,r.toArray())]);case 1:return i=c.sent(),n.$o=!0,[4,wh(n.remoteStore,!0)];case 2:for(c.sent(),o=0,s=i;o<s.length;o++)th(n.remoteStore,s[o]);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(a=[],u=Promise.resolve(),n.Vo.forEach(function(t,e){n.sharedClientState.isLocalQueryTarget(e)?a.push(e):u=u.then(function(){return nl(n,e),cc(n.localStore,e,!0)}),eh(n.remoteStore,e)}),[4,u]);case 4:return c.sent(),[4,pl(n,a)];case 5:return c.sent(),function(t){var e=$r(t);e.Co.forEach(function(t,n){eh(e.remoteStore,n)}),e.No.ts(),e.Co=new Map,e.Do=new cs(_i.comparator)}(n),n.$o=!1,[4,wh(n.remoteStore,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})}function pl(t,e,n){return Object(Mr.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u,c,h,l,f,d,p;return Object(Mr.d)(this,function(y){switch(y.label){case 0:n=$r(t),r=[],i=[],o=0,s=e,y.label=1;case 1:return o<s.length?(u=void 0,(c=n.Vo.get(a=s[o]))&&0!==c.length?[4,uc(n.localStore,vo(c[0]))]:[3,7]):[3,13];case 2:u=y.sent(),h=0,l=c,y.label=3;case 3:return h<l.length?(f=n.Po.get(l[h]),[4,hl(n,f)]):[3,6];case 4:(d=y.sent()).snapshot&&i.push(d.snapshot),y.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,lc(n.localStore,a)];case 8:return p=y.sent(),[4,uc(n.localStore,p)];case 9:return u=y.sent(),[4,Gh(n,yl(p),a,!1)];case 10:y.sent(),y.label=11;case 11:r.push(u),y.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}})})}function yl(t){return co(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function gl(t){var e=$r(t);return $r($r(e.localStore).persistence).fn()}function ml(t,e,n,r){return Object(Mr.b)(this,void 0,void 0,function(){var i,o,s;return Object(Mr.d)(this,function(a){switch(a.label){case 0:return(i=$r(t)).$o?(Gr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,fc(i.localStore)];case 3:return o=a.sent(),s=_s.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,al(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,cc(i.localStore,e,!0)];case 6:return a.sent(),nl(i,e,r),[3,8];case 7:Yr(),a.label=8;case 8:return[2]}})})}function vl(t,e,n){return Object(Mr.b)(this,void 0,void 0,function(){var r,i,o,s,a,u,c,h,l;return Object(Mr.d)(this,function(f){switch(f.label){case 0:if(!(r=bl(t)).$o)return[3,10];i=0,o=e,f.label=1;case 1:return i<o.length?r.Vo.has(s=o[i])?(Gr("SyncEngine","Adding an already active target "+s),[3,5]):[4,lc(r.localStore,s)]:[3,6];case 2:return a=f.sent(),[4,uc(r.localStore,a)];case 3:return u=f.sent(),[4,Gh(r,yl(a),u.targetId,!1)];case 4:f.sent(),th(r.remoteStore,u),f.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(Mr.d)(this,function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,cc(r.localStore,t,!1).then(function(){eh(r.remoteStore,t),nl(r,t)}).catch(Nu)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},h=0,l=n,f.label=7;case 7:return h<l.length?[5,c(l[h])]:[3,10];case 8:f.sent(),f.label=9;case 9:return h++,[3,7];case 10:return[2]}})})}function bl(t){var e=$r(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Wh.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=cl.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Xh.bind(null,e),e.vo._r=Ch.bind(null,e.eventManager),e.vo.Mo=jh.bind(null,e.eventManager),e}function wl(t){var e=$r(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=$h.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Jh.bind(null,e),e}var Il=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(Mr.b)(this,void 0,void 0,function(){return Object(Mr.d)(this,function(e){switch(e.label){case 0:return this.R=zc(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Qo(t),[2]}})})},t.prototype.Uo=function(t){return null},t.prototype.Qo=function(t){return ec(this.persistence,new Zu,t.initialUser,this.R)},t.prototype.qo=function(t){return new Tc(Oc.bs,this.R)},t.prototype.Bo=function(t){return new Lc},t.prototype.terminate=function(){return Object(Mr.b)(this,void 0,void 0,function(){return Object(Mr.d)(this,function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}})})},t}(),El=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Ko=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(Mr.c)(e,t),e.prototype.initialize=function(e){return Object(Mr.b)(this,void 0,void 0,function(){return Object(Mr.d)(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,dc(this.localStore)];case 2:return n.sent(),[4,this.Ko.initialize(this,e)];case 3:return n.sent(),[4,wl(this.Ko.syncEngine)];case 4:return n.sent(),[4,dh(this.Ko.remoteStore)];case 5:return n.sent(),[2]}})})},e.prototype.Qo=function(t){return ec(this.persistence,new Zu,t.initialUser,this.R)},e.prototype.Uo=function(t){return new Cu(this.persistence.referenceDelegate.garbageCollector,t.asyncQueue)},e.prototype.qo=function(t){var e=Yu(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?gu.withCacheSize(this.cacheSizeBytes):gu.DEFAULT;return new Qu(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,Bc(),Kc(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new Lc},e}(Il),Tl=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Ko=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(Mr.c)(e,t),e.prototype.initialize=function(e){return Object(Mr.b)(this,void 0,void 0,function(){var n,r=this;return Object(Mr.d)(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Ko.syncEngine,this.sharedClientState instanceof Pc?(this.sharedClientState.syncEngine={ui:fl.bind(null,n),ai:ml.bind(null,n),hi:vl.bind(null,n),fn:gl.bind(null,n),ci:ll.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He(function(t){return Object(Mr.b)(r,void 0,void 0,function(){return Object(Mr.d)(this,function(e){switch(e.label){case 0:return[4,dl(this.Ko.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.Bo=function(t){var e=Bc();if(!Pc.yt(e))throw new Br(qr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Yu(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new Pc(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(El),_l=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(Mr.b)(this,void 0,void 0,function(){var n=this;return Object(Mr.d)(this,function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return Yh(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=ul.bind(null,this.syncEngine),[4,wh(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.createEventManager=function(t){return new Nh},t.prototype.createDatastore=function(t){var e=zc(t.databaseInfo.databaseId),n=new qc(t.databaseInfo);return function(t,e,n){return new Yc(t,e,n)}(t.credentials,n,e)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return Yh(s.syncEngine,t,0)},o=Uc.yt()?new Uc:new Vc,new $c(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){var a=new Kh(t,e,n,r,i,o);return s&&(a.$o=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return Object(Mr.b)(this,void 0,void 0,function(){var e;return Object(Mr.d)(this,function(n){switch(n.label){case 0:return e=$r(t),Gr("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,Zc(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}})})}(this.remoteStore)},t}(),Ol=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),Sl=(function(){function t(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new Pa,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then(function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}t.prototype.close=function(){return this.Go.cancel()},t.prototype.getMetadata=function(){return Object(Mr.b)(this,void 0,void 0,function(){return Object(Mr.d)(this,function(t){return[2,this.metadata.promise]})})},t.prototype.Lo=function(){return Object(Mr.b)(this,void 0,void 0,function(){return Object(Mr.d)(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}})})},t.prototype.Ho=function(){return Object(Mr.b)(this,void 0,void 0,function(){var t,e,n,r;return Object(Mr.d)(this,function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(t=i.sent())?[2,null]:(e=this.zo.decode(t),n=Number(e),isNaN(n)&&this.Yo("length string ("+e+") is not valid number"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new Lh(JSON.parse(r),t.length+n)]}})})},t.prototype.Zo=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},t.prototype.Jo=function(){return Object(Mr.b)(this,void 0,void 0,function(){var t,e;return Object(Mr.d)(this,function(n){switch(n.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}})})},t.prototype.Xo=function(t){return Object(Mr.b)(this,void 0,void 0,function(){var e;return Object(Mr.d)(this,function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}})})},t.prototype.Yo=function(t){throw this.Go.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.tc=function(){return Object(Mr.b)(this,void 0,void 0,function(){var t,e;return Object(Mr.d)(this,function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}})})}}(),function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return Object(Mr.b)(this,void 0,void 0,function(){var e,n=this;return Object(Mr.d)(this,function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Br(qr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(Mr.b)(this,void 0,void 0,function(){var n,r,i,o,s,a;return Object(Mr.d)(this,function(u){switch(u.label){case 0:return n=$r(t),r=Qs(n.R)+"/documents",i={documents:e.map(function(t){return Bs(n.R,t)})},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){Xr(!!e.found);var n=Ks(t,e.found.name),r=Ms(e.found.updateTime),i=new Mi({mapValue:{fields:e.found.fields}});return qi.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){Xr(!!e.missing),Xr(!!e.readTime);var n=Ks(t,e.missing),r=Ms(e.readTime);return qi.newNoDocument(n,r)}(t,e):Yr()}(n.R,t);s.set(e.key.toString(),e)}),a=[],[2,(e.forEach(function(t){var e=s.get(t.toString());Xr(!!e),a.push(e)}),a)]}})})}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach(function(t){return n.recordVersion(t)}),e)]}})})},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new is(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return Object(Mr.b)(this,void 0,void 0,function(){var t,e=this;return Object(Mr.d)(this,function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=_i.fromPath(n);e.mutations.push(new os(r,e.precondition(r)))}),[4,function(t,e){return Object(Mr.b)(this,void 0,void 0,function(){var n,r,i;return Object(Mr.d)(this,function(o){switch(o.label){case 0:return n=$r(t),r=Qs(n.R)+"/documents",i={writes:e.map(function(t){return Xs(n.R,t)})},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}})})},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw Yr();e=ii.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Br(qr.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?Ko.updateTime(e):Ko.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(ii.min()))throw new Br(qr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ko.updateTime(e)}return Ko.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}()),Dl=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new Gc(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji(function(){return Object(Mr.b)(t,void 0,void 0,function(){var t,e,n=this;return Object(Mr.d)(this,function(r){return t=new Sl(this.datastore),(e=this.sc(t))&&e.then(function(e){n.asyncQueue.enqueueAndForget(function(){return t.commit().then(function(){n.deferred.resolve(e)}).catch(function(t){n.ic(t)})})}).catch(function(t){n.ic(t)}),[2]})})})},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!Ii(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget(function(){return e.nc(),Promise.resolve()})):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!as(e)}return!1},t}(),Al=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=Sc.UNAUTHENTICATED,this.clientId=Zr.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,function(t){return Object(Mr.b)(r,void 0,void 0,function(){return Object(Mr.d)(this,function(e){switch(e.label){case 0:return Gr("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}})})})}return t.prototype.getConfiguration=function(){return Object(Mr.b)(this,void 0,void 0,function(){return Object(Mr.d)(this,function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]})})},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Br(qr.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new Pa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(function(){return Object(Mr.b)(t,void 0,void 0,function(){var t,n;return Object(Mr.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=_h(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}();function Nl(t,e){return Object(Mr.b)(this,void 0,void 0,function(){var n,r,i=this;return Object(Mr.d)(this,function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),Gr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener(function(t){return Object(Mr.b)(i,void 0,void 0,function(){return Object(Mr.d)(this,function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,nc(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}})})}),e.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t.offlineComponents=e,[2]}})})}function kl(t,e){return Object(Mr.b)(this,void 0,void 0,function(){var n,r;return Object(Mr.d)(this,function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,xl(t)];case 1:return n=i.sent(),Gr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener(function(t){return function(t,e){return Object(Mr.b)(this,void 0,void 0,function(){var n,r;return Object(Mr.d)(this,function(i){switch(i.label){case 0:return(n=$r(t)).asyncQueue.verifyOperationInProgress(),Gr("RemoteStore","RemoteStore received new credentials"),r=sh(n),n.Or.add(3),[4,Zc(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,Jc(n)];case 3:return i.sent(),[2]}})})}(e.remoteStore,t)}),t.onlineComponents=e,[2]}})})}function xl(t){return Object(Mr.b)(this,void 0,void 0,function(){return Object(Mr.d)(this,function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(Gr("FirestoreClient","Using default OfflineComponentProvider"),[4,Nl(t,new Il)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}})})}function Cl(t){return Object(Mr.b)(this,void 0,void 0,function(){return Object(Mr.d)(this,function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(Gr("FirestoreClient","Using default OnlineComponentProvider"),[4,kl(t,new _l)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}})})}function jl(t){return xl(t).then(function(t){return t.persistence})}function Rl(t){return xl(t).then(function(t){return t.localStore})}function Pl(t){return Cl(t).then(function(t){return t.remoteStore})}function Ll(t){return Cl(t).then(function(t){return t.syncEngine})}function Vl(t){return Object(Mr.b)(this,void 0,void 0,function(){var e,n;return Object(Mr.d)(this,function(r){switch(r.label){case 0:return[4,Cl(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=zh.bind(null,e.syncEngine),n.onUnlisten=Qh.bind(null,e.syncEngine),n)]}})})}function Ul(t,e,n){var r=this;void 0===n&&(n={});var i=new Pa;return t.asyncQueue.enqueueAndForget(function(){return Object(Mr.b)(r,void 0,void 0,function(){var r;return Object(Mr.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Ol({next:function(o){e.enqueueAndForget(function(){return xh(t,s)});var a=o.docs.has(n);!a&&o.fromCache?i.reject(new Br(qr.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new Br(qr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Ph(ho(n.path),o,{includeMetadataChanges:!0,so:!0});return kh(t,s)},[4,Vl(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}})})}),i.promise}function Ml(t,e,n){var r=this;void 0===n&&(n={});var i=new Pa;return t.asyncQueue.enqueueAndForget(function(){return Object(Mr.b)(r,void 0,void 0,function(){var r;return Object(Mr.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Ol({next:function(n){e.enqueueAndForget(function(){return xh(t,s)}),n.fromCache&&"server"===r.source?i.reject(new Br(qr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Ph(n,o,{includeMetadataChanges:!0,so:!0});return kh(t,s)},[4,Vl(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}})})}),i.promise}var Fl=function(t,e,n,r,i,o,s,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},ql=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Bl=new Map,Kl=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},zl=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable(function(){return e(Sc.UNAUTHENTICATED)})},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Gl=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable(function(){return e(n.token.user)})},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Ql=function(){function t(t){var e=this;this.currentUser=Sc.UNAUTHENTICATED,this.oc=new Pa,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable(function(){return e.changeListener(e.currentUser)})};var n=function(t){Gr("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit(function(t){return n(t)}),setTimeout(function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(Gr("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}},0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.cc!==e?(Gr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Xr("string"==typeof n.accessToken),new Kl(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable(function(){return Object(Mr.b)(n,void 0,void 0,function(){return Object(Mr.d)(this,function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}})})})},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return Xr(null===t||"string"==typeof t),new Sc(t)},t}(),Hl=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=Sc.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),Wl=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new Hl(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable(function(){return e(Sc.FIRST_PARTY)})},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function Yl(t,e,n){if(!n)throw new Br(qr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Xl(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Br(qr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function $l(t,e,n,r){if(!0===e&&!0===r)throw new Br(qr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Jl(t){if(!_i.isDocumentKey(t))throw new Br(qr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Zl(t){if(_i.isDocumentKey(t))throw new Br(qr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function tf(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Yr()}function ef(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Br(qr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=tf(t);throw new Br(qr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function nf(t,e){if(e<=0)throw new Br(qr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var rf=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Br(qr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Br(qr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,$l("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),of=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new rf({}),this._settingsFrozen=!1,t instanceof ql?(this._databaseId=t,this._credentials=new zl):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Br(qr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ql(t.options.projectId)}(t),this._credentials=new Ql(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new Br(qr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new Br(qr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new rf(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new zl;switch(t.type){case"gapi":var e=t.client;return Xr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Wl(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Br(qr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return(t=Bl.get(this))&&(Gr("ComponentProvider","Removing Datastore"),Bl.delete(this),t.terminate()),Promise.resolve();var t},t}(),sf=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new uf(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),af=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),uf=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,ho(r))||this)._path=r,i.type="collection",i}return Object(Mr.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new sf(this.firestore,null,new _i(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(af);function cf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Object(A.h)(t),Yl("collection","path",e),t instanceof of)return Zl(n=ci.fromString.apply(ci,Object(Mr.f)([e],r))),new uf(t,null,n);if(!(t instanceof sf||t instanceof uf))throw new Br(qr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Zl(n=ci.fromString.apply(ci,Object(Mr.f)([t.path],r)).child(ci.fromString(e))),new uf(t.firestore,null,n)}function hf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Object(A.h)(t),1===arguments.length&&(e=Zr.u()),Yl("doc","path",e),t instanceof of)return Jl(n=ci.fromString.apply(ci,Object(Mr.f)([e],r))),new sf(t,null,new _i(n));if(!(t instanceof sf||t instanceof uf))throw new Br(qr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Jl(n=t._path.child(ci.fromString.apply(ci,Object(Mr.f)([e],r)))),new sf(t.firestore,t instanceof uf?t.converter:null,new _i(n))}function lf(t,e){return t=Object(A.h)(t),e=Object(A.h)(e),(t instanceof sf||t instanceof uf)&&(e instanceof sf||e instanceof uf)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function ff(t,e){return t=Object(A.h)(t),e=Object(A.h)(e),t instanceof af&&e instanceof af&&t.firestore===e.firestore&&wo(t._query,e._query)&&t.converter===e.converter}var df=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=[],this.Zi=new Gc(this,"async_queue_retry"),this.Tc=function(){var e=Kc();e&&Gr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=Kc();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Tc)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ic(),this.Ac(t)},t.prototype.enterRestrictedMode=function(){if(!this._c){this._c=!0;var t=Kc();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Tc)}},t.prototype.enqueue=function(t){return this.Ic(),this._c?new Promise(function(t){}):this.Ac(t)},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget(function(){return e.wc.push(t),e.Rc()})},t.prototype.Rc=function(){return Object(Mr.b)(this,void 0,void 0,function(){var t,e=this;return Object(Mr.d)(this,function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!qa(t=n.sent()))throw t;return Gr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji(function(){return e.Rc()}),n.label=5;case 5:return[2]}})})},t.prototype.Ac=function(t){var e=this,n=this.dc.then(function(){return e.gc=!0,t().catch(function(t){throw e.yc=t,e.gc=!1,Qr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.gc=!1,t})});return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ic(),this.Ec.indexOf(t)>-1&&(e=0);var i=Th.createAndSchedule(this,t,e,n,function(t){return r.bc(t)});return this.mc.push(i),i},t.prototype.Ic=function(){this.yc&&Yr()},t.prototype.verifyOperationInProgress=function(){},t.prototype.vc=function(){return Object(Mr.b)(this,void 0,void 0,function(){var t;return Object(Mr.d)(this,function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.Pc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Vc=function(t){var e=this;return this.vc().then(function(){e.mc.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs});for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.vc()})},t.prototype.Sc=function(t){this.Ec.push(t)},t.prototype.bc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function pf(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}!function(){function t(){this._progressObserver={},this._taskCompletionResolver=new Pa,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},t.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},t.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},t.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},t.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)}}();var yf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new df,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return Object(Mr.c)(e,t),e.prototype._terminate=function(){return this._firestoreClient||mf(this),this._firestoreClient.terminate()},e}(of);function gf(t){return t._firestoreClient||mf(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function mf(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new Fl(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Al(t._credentials,t._queue,r)}function vf(t,e,n){var r=this,i=new Pa;return t.asyncQueue.enqueue(function(){return Object(Mr.b)(r,void 0,void 0,function(){var r;return Object(Mr.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,Nl(t,n)];case 1:return o.sent(),[4,kl(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===qr.FAILED_PRECONDITION||t.code===qr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function bf(t){if(t._initialized||t._terminated)throw new Br(qr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var wf=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Br(qr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new li(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),If=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(di.fromBase64String(e))}catch(e){throw new Br(qr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(di.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),Ef=function(t){this._methodName=t},Tf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Br(qr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Br(qr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return ti(this._lat,t._lat)||ti(this._long,t._long)},t}(),_f=/^__.*__$/,Of=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new Jo(t,this.data,this.fieldMask,e,this.fieldTransforms):new $o(t,this.data,e,this.fieldTransforms)},t}(),Sf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new Jo(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();function Df(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Yr()}}var Af=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Dc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Cc",{get:function(){return this.settings.Cc},enumerable:!1,configurable:!0}),t.prototype.Nc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.xc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.kc(t),r},t.prototype.$c=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.Dc(),r},t.prototype.Oc=function(t){return this.Nc({path:void 0,Fc:!0})},t.prototype.Mc=function(t){return Wf(t,this.settings.methodName,this.settings.Lc||!1,this.path,this.settings.Bc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find(function(e){return t.isPrefixOf(e)})||void 0!==this.fieldTransforms.find(function(e){return t.isPrefixOf(e.field)})},t.prototype.Dc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.kc(this.path.get(t))},t.prototype.kc=function(t){if(0===t.length)throw this.Mc("Document fields must not be empty");if(Df(this.Cc)&&_f.test(t))throw this.Mc('Document fields cannot begin and end with "__"')},t}(),Nf=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||zc(t)}return t.prototype.qc=function(t,e,n,r){return void 0===r&&(r=!1),new Af({Cc:t,methodName:e,Bc:n,path:li.emptyPath(),Fc:!1,Lc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function kf(t){var e=t._freezeSettings(),n=zc(t._databaseId);return new Nf(t._databaseId,!!e.ignoreUndefinedProperties,n)}function xf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.qc(o.merge||o.mergeFields?2:0,e,n,i);zf("Data must be an object, but it was:",s,r);var a,u,c=Bf(r,s);if(o.merge)a=new fi(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var d=Gf(e,f[l],n);if(!s.contains(d))throw new Br(qr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Yf(h,d)||h.push(d)}a=new fi(h),u=s.fieldTransforms.filter(function(t){return a.covers(t.field)})}else a=null,u=s.fieldTransforms;return new Of(new Mi(c),a,u)}var Cf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Mr.c)(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Cc)throw t.Mc(1===t.Cc?this._methodName+"() can only appear at the top level of your update data":this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Ef);function jf(t,e,n){return new Af({Cc:3,Bc:e.settings.Bc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var Rf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Mr.c)(e,t),e.prototype._toFieldTransform=function(t){return new qo(t.path,new jo)},e.prototype.isEqual=function(t){return t instanceof e},e}(Ef),Pf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return Object(Mr.c)(e,t),e.prototype._toFieldTransform=function(t){var e=jf(this,t,!0),n=this.Uc.map(function(t){return qf(t,e)}),r=new Ro(n);return new qo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Ef),Lf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return Object(Mr.c)(e,t),e.prototype._toFieldTransform=function(t){var e=jf(this,t,!0),n=this.Uc.map(function(t){return qf(t,e)}),r=new Lo(n);return new qo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Ef),Vf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Qc=n,r}return Object(Mr.c)(e,t),e.prototype._toFieldTransform=function(t){var e=new Uo(t.R,Ao(t.R,this.Qc));return new qo(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Ef);function Uf(t,e,n,r){var i=t.qc(1,e,n);zf("Data must be an object, but it was:",i,r);var o=[],s=Mi.empty();si(r,function(t,r){var a=Hf(e,t,n);r=Object(A.h)(r);var u=i.$c(a);if(r instanceof Cf)o.push(a);else{var c=qf(r,u);null!=c&&(o.push(a),s.set(a,c))}});var a=new fi(o);return new Sf(s,a,i.fieldTransforms)}function Mf(t,e,n,r,i,o){var s=t.qc(1,e,n),a=[Gf(e,r,n)],u=[i];if(o.length%2!=0)throw new Br(qr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(Gf(e,o[c])),u.push(o[c+1]);for(var h=[],l=Mi.empty(),f=a.length-1;f>=0;--f)if(!Yf(h,a[f])){var d=a[f],p=u[f];p=Object(A.h)(p);var y=s.$c(d);if(p instanceof Cf)h.push(d);else{var g=qf(p,y);null!=g&&(h.push(d),l.set(d,g))}}var m=new fi(h);return new Sf(l,m,s.fieldTransforms)}function Ff(t,e,n,r){return void 0===r&&(r=!1),qf(n,t.qc(r?4:3,e))}function qf(t,e){if(Kf(t=Object(A.h)(t)))return zf("Unsupported field value:",e,t),Bf(t,e);if(t instanceof Ef)return function(t,e){if(!Df(e.Cc))throw e.Mc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Mc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&4!==e.Cc)throw e.Mc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=qf(o[i],e.Oc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=Object(A.h)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Ao(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ri.fromDate(t);return{timestampValue:Ls(e.R,n)}}if(t instanceof ri)return n=new ri(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Ls(e.R,n)};if(t instanceof Tf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof If)return{bytesValue:Vs(e.R,t._byteString)};if(t instanceof sf){var r=t.firestore._databaseId;if(!r.isEqual(n=e.databaseId))throw e.Mc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Fs(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Mc("Unsupported field value: "+tf(t))}(t,e)}function Bf(t,e){var n={};return ai(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):si(t,function(t,r){var i=qf(r,e.xc(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function Kf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ri||t instanceof Tf||t instanceof If||t instanceof sf||t instanceof Ef)}function zf(t,e,n){if(!Kf(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=tf(n);throw e.Mc("an object"===r?t+" a custom object":t+" "+r)}}function Gf(t,e,n){if((e=Object(A.h)(e))instanceof wf)return e._internalPath;if("string"==typeof e)return Hf(t,e);throw Wf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Qf=new RegExp("[~\\*/\\[\\]]");function Hf(t,e,n){if(e.search(Qf)>=0)throw Wf("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(wf.bind.apply(wf,Object(Mr.f)([void 0],e.split(".")))))._internalPath}catch(r){throw Wf("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Wf(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new Br(qr.INVALID_ARGUMENT,(a+=". ")+t+u)}function Yf(t,e){return t.some(function(t){return t.isEqual(e)})}var Xf=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new sf(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new $f(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(Jf("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),$f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Mr.c)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Xf);function Jf(t,e){return"string"==typeof e?Hf(t,e):e instanceof wf?e._internalPath:e._delegate._internalPath}var Zf=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),td=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return Object(Mr.c)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new ed(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(Jf("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(Xf),ed=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Mr.c)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(td),nd=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new Zf(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach(function(r){t.call(e,new ed(n._firestore,n._userDataWriter,r.key,r,new Zf(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Br(qr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map(function(e){return{type:"added",doc:new ed(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Zf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}})}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new ed(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Zf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:rd(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function rd(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Yr()}}function id(t,e){return t instanceof td&&e instanceof td?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof nd&&e instanceof nd&&t._firestore===e._firestore&&ff(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function od(t){if(fo(t)&&0===t.explicitOrderBy.length)throw new Br(qr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var sd=function(){};function ad(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var ud=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Kc=e,i.jc=n,i.Wc=r,i.type="where",i}return Object(Mr.c)(e,t),e.prototype._apply=function(t){var e=kf(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new Br(qr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){yd(s,o);for(var u=[],c=0,h=s;c<h.length;c++)u.push(pd(r,t,h[c]));a={arrayValue:{values:u}}}else a=pd(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||yd(s,o),a=Ff(n,"where",s,"in"===o||"not-in"===o);var l=Hi.create(i,o,a);return function(t,e){if(e.g()){var n=yo(t);if(null!==n&&!n.isEqual(e.field))throw new Br(qr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=po(t);null!==r&&gd(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new Br(qr.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(t._query,0,e,t.firestore._databaseId,this.Kc,this.jc,this.Wc);return new af(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new uo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(sd),cd=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Kc=e,r.Gc=n,r.type="orderBy",r}return Object(Mr.c)(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Br(qr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Br(qr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new io(e,n);return function(t,e){if(null===po(t)){var n=yo(t);null!==n&&gd(0,n,e.field)}}(t,r),r}(t._query,this.Kc,this.Gc);return new af(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new uo(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(sd),hd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.zc=n,i.Hc=r,i}return Object(Mr.c)(e,t),e.prototype._apply=function(t){return new af(t.firestore,t.converter,bo(t._query,this.zc,this.Hc))},e}(sd),ld=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return Object(Mr.c)(e,t),e.prototype._apply=function(t){var e=dd(t,this.type,this.Jc,this.Yc);return new af(t.firestore,t.converter,function(t,e){return new uo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(sd),fd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return Object(Mr.c)(e,t),e.prototype._apply=function(t){var e=dd(t,this.type,this.Jc,this.Yc);return new af(t.firestore,t.converter,function(t,e){return new uo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(sd);function dd(t,e,n,r){if(n[0]=Object(A.h)(n[0]),n[0]instanceof Xf)return function(t,e,n,r,i){if(!r)throw new Br(qr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=mo(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(Ci(e,r.key));else{var c=r.data.field(u.field);if(vi(c))throw new Br(qr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.canonicalString();throw new Br(qr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new no(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=kf(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new Br(qr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new Br(qr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!go(t)&&-1!==c.indexOf("/"))throw new Br(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ci.fromString(c));if(!_i.isDocumentKey(h))throw new Br(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new _i(h);a.push(Ci(e,l))}else{var f=Ff(n,r,c);a.push(f)}}return new no(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function pd(t,e,n){if("string"==typeof(n=Object(A.h)(n))){if(""===n)throw new Br(qr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!go(e)&&-1!==n.indexOf("/"))throw new Br(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ci.fromString(n));if(!_i.isDocumentKey(r))throw new Br(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Ci(t,new _i(r))}if(n instanceof sf)return Ci(t,n._key);throw new Br(qr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+tf(n)+".")}function yd(t,e){if(!Array.isArray(t)||0===t.length)throw new Br(qr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Br(qr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function gd(t,e,n){if(!n.isEqual(e))throw new Br(qr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}var md=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),Oi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return gi(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(mi(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Yr()}},t.prototype.convertObject=function(t,e){var n=this,r={};return si(t.fields,function(t,i){r[t]=n.convertValue(i,e)}),r},t.prototype.convertGeoPoint=function(t){return new Tf(gi(t.latitude),gi(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.convertValue(t,e)})},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=bi(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(wi(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=yi(t);return new ri(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=ci.fromString(t);Xr(la(n));var r=new ql(n.get(1),n.get(3)),i=new _i(n.popFirst(5));return r.isEqual(e)||Qr("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();function vd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var bd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(Mr.c)(e,t),e.prototype.convertBytes=function(t){return new If(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new sf(this.firestore,null,e)},e}(md),wd=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=kf(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=Id(t,this._firestore),i=vd(r.converter,e,n),o=xf(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,Ko.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=Id(t,this._firestore);return o="string"==typeof(e=Object(A.h)(e))||e instanceof wf?Mf(this._dataReader,"WriteBatch.update",s._key,e,n,r):Uf(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,Ko.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=Id(t,this._firestore);return this._mutations=this._mutations.concat(new is(e._key,Ko.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new Br(qr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function Id(t,e){if((t=Object(A.h)(t)).firestore!==e)throw new Br(qr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Ed=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(Mr.c)(e,t),e.prototype.convertBytes=function(t){return new If(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new sf(this.firestore,null,e)},e}(md);function Td(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=ef(t,sf);var o=ef(t.firestore,yf),s=kf(o);return Od(o,[("string"==typeof(e=Object(A.h)(e))||e instanceof wf?Mf(s,"updateDoc",t._key,e,n,r):Uf(s,"updateDoc",t._key,e)).toMutation(t._key,Ko.exists(!0))])}function _d(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=Object(A.h)(t);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||pf(i[a])||(s=i[a],a++);var u,c,h,l={includeMetadataChanges:s.includeMetadataChanges};if(pf(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof sf)c=ef(t.firestore,yf),h=ho(t._key.path),u={next:function(e){i[a]&&i[a](Sd(c,t,e))},error:i[a+1],complete:i[a+2]};else{var d=ef(t,af);c=ef(d.firestore,yf),h=d._query;var p=new Ed(c);u={next:function(t){i[a]&&i[a](new nd(c,p,d,t))},error:i[a+1],complete:i[a+2]},od(t._query)}return function(t,e,n,r){var i=this,o=new Ol(r),s=new Ph(e,o,n);return t.asyncQueue.enqueueAndForget(function(){return Object(Mr.b)(i,void 0,void 0,function(){var e;return Object(Mr.d)(this,function(n){switch(n.label){case 0:return e=kh,[4,Vl(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})}),function(){o.Wo(),t.asyncQueue.enqueueAndForget(function(){return Object(Mr.b)(i,void 0,void 0,function(){var e;return Object(Mr.d)(this,function(n){switch(n.label){case 0:return e=xh,[4,Vl(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})})}}(gf(c),h,l,u)}function Od(t,e){return function(t,e){var n=this,r=new Pa;return t.asyncQueue.enqueueAndForget(function(){return Object(Mr.b)(n,void 0,void 0,function(){var n;return Object(Mr.d)(this,function(i){switch(i.label){case 0:return n=Hh,[4,Ll(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(gf(t),e)}function Sd(t,e,n){var r=n.docs.get(e._key),i=new Ed(t);return new td(t,i,e._key,r,new Zf(n.hasPendingWrites,n.fromCache),e.converter)}var Dd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return Object(Mr.c)(e,t),e.prototype.get=function(e){var n=this,r=Id(e,this._firestore),i=new Ed(this._firestore);return t.prototype.get.call(this,e).then(function(t){return new td(n._firestore,i,r._key,t._document,new Zf(!1,!1),r.converter)})},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=kf(t)}return t.prototype.get=function(t){var e=this,n=Id(t,this._firestore),r=new bd(this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return Yr();var i=t[0];if(i.isFoundDocument())return new Xf(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new Xf(e._firestore,r,n._key,null,n.converter);throw Yr()})},t.prototype.set=function(t,e,n){var r=Id(t,this._firestore),i=vd(r.converter,e,n),o=xf(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=Id(t,this._firestore);return o="string"==typeof(e=Object(A.h)(e))||e instanceof wf?Mf(this._dataReader,"Transaction.update",s._key,e,n,r):Uf(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=Id(t,this._firestore);return this._transaction.delete(e._key),this},t}());function Ad(){if("undefined"==typeof Uint8Array)throw new Br(qr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Nd(){if("undefined"==typeof atob)throw new Br(qr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var kd=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return Nd(),new t(If.fromBase64String(e))},t.fromUint8Array=function(e){return Ad(),new t(If.fromUint8Array(e))},t.prototype.toBase64=function(){return Nd(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return Ad(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),xd=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){bf(t=ef(t,yf));var n=gf(t),r=t._freezeSettings(),i=new _l;return vf(n,i,new El(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){bf(t=ef(t,yf));var e=gf(t),n=t._freezeSettings(),r=new _l;return vf(e,r,new Tl(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new Br(qr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Pa;return t._queue.enqueueAndForgetEvenWhileRestricted(function(){return Object(Mr.b)(e,void 0,void 0,function(){var e;return Object(Mr.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(Mr.b)(this,void 0,void 0,function(){return Object(Mr.d)(this,function(e){switch(e.label){case 0:return Ua.yt()?[4,Ua.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(Yu(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t._delegate)},t}(),Cd=function(){function t(t,e,n){var r=this;this._delegate=e,this.Xc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof ql||(this.Zc=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||Hr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var i=(t=ef(t,of))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==e&&Hr("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:e+":"+n,ssl:!1})),r.mockUserToken){var o=Object(A.d)(r.mockUserToken),s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new Br(qr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new Gl(new Kl(o,new Sc(s)))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue(function(){return Object(Mr.b)(e,void 0,void 0,function(){var e,n;return Object(Mr.d)(this,function(r){switch(r.label){case 0:return[4,jl(t)];case 1:return e=r.sent(),[4,Pl(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=$r(t);return e.Or.delete(0),Jc(e)}(n))]}})})})}(gf(ef(this._delegate,yf)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue(function(){return Object(Mr.b)(e,void 0,void 0,function(){var e,n;return Object(Mr.d)(this,function(r){switch(r.label){case 0:return[4,jl(t)];case 1:return e=r.sent(),[4,Pl(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return Object(Mr.b)(this,void 0,void 0,function(){var e;return Object(Mr.d)(this,function(n){switch(n.label){case 0:return(e=$r(t)).Or.add(0),[4,Zc(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}})})}(n))]}})})})}(gf(ef(this._delegate,yf)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&$l("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Xc.enableMultiTabIndexedDbPersistence(this):this.Xc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Xc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.Zc&&(this.Zc._removeServiceInstance("firestore"),this.Zc._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Pa;return t.asyncQueue.enqueueAndForget(function(){return Object(Mr.b)(e,void 0,void 0,function(){var e;return Object(Mr.d)(this,function(r){switch(r.label){case 0:return e=Zh,[4,Ll(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(gf(ef(this._delegate,yf)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new Ol(e);return t.asyncQueue.enqueueAndForget(function(){return Object(Mr.b)(n,void 0,void 0,function(){var e;return Object(Mr.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){$r(t).Gr.add(e),e.next()},[4,Vl(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})}),function(){r.Wo(),t.asyncQueue.enqueueAndForget(function(){return Object(Mr.b)(n,void 0,void 0,function(){var e;return Object(Mr.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){$r(t).Gr.delete(e)},[4,Vl(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})})}}(gf(t=ef(t,yf)),pf(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.Zc)throw new Br(qr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Zc},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Qd(this,cf(this._delegate,t))}catch(t){throw Ud(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new Vd(this,hf(this._delegate,t))}catch(t){throw Ud(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new Kd(this,function(t,e){if(t=ef(t,of),Yl("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Br(qr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new af(t,null,function(t){return new uo(ci.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw Ud(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Pa;return t.asyncQueue.enqueueAndForget(function(){return Object(Mr.b)(n,void 0,void 0,function(){var n;return Object(Mr.d)(this,function(i){switch(i.label){case 0:return[4,function(t){return Cl(t).then(function(t){return t.datastore})}(t)];case 1:return n=i.sent(),new Dl(t.asyncQueue,n,e,r).run(),[2]}})})}),r.promise}(gf(t),function(n){return e(new Dd(t,n))})}(this._delegate,function(n){return t(new Rd(e,n))})},t.prototype.batch=function(){var t=this;return gf(this._delegate),new Pd(new wd(this._delegate,function(e){return Od(t._delegate,e)}))},t.prototype.loadBundle=function(t){throw new Br(qr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new Br(qr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),jd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(Mr.c)(e,t),e.prototype.convertBytes=function(t){return new kd(new If(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return Vd.tu(e,this.firestore,null)},e}(md),Rd=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new jd(t)}return t.prototype.get=function(t){var e=this,n=Hd(t);return this._delegate.get(n).then(function(t){return new qd(e._firestore,new td(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))})},t.prototype.set=function(t,e,n){var r=Hd(t);return n?(Xl("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Hd(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Object(Mr.f)([s,e,n],i)),this},t.prototype.delete=function(t){var e=Hd(t);return this._delegate.delete(e),this},t}(),Pd=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=Hd(t);return n?(Xl("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Hd(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Object(Mr.f)([s,e,n],i)),this},t.prototype.delete=function(t){var e=Hd(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),Ld=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new ed(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Bd(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.eu=function(e,n){var r=t.nu,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new jd(e),n),i.set(n,o)),o},t}();Ld.nu=new WeakMap;var Vd=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new jd(t)}return t.su=function(e,n,r){if(e.length%2!=0)throw new Br(qr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new sf(n._delegate,r,new _i(e)))},t.tu=function(e,n,r){return new t(n,new sf(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Qd(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Qd(this.firestore,cf(this._delegate,t))}catch(t){throw Ud(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=Object(A.h)(t))instanceof sf&&lf(this._delegate,t)},t.prototype.set=function(t,e){e=Xl("DocumentReference.set",e);try{return function(t,e,n){t=ef(t,sf);var r=ef(t.firestore,yf),i=vd(t.converter,e,n);return Od(r,[xf(kf(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,Ko.none())])}(this._delegate,t,e)}catch(t){throw Ud(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Td(this._delegate,t):Td.apply(void 0,Object(Mr.f)([this._delegate,t,e],n))}catch(t){throw Ud(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return Od(ef((t=this._delegate).firestore,yf),[new is(t._key,Ko.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Md(e),i=Fd(e,function(e){return new qd(t.firestore,new td(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))});return _d(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=ef(t,sf);var e=ef(t.firestore,yf),n=gf(e),r=new Ed(e);return function(t,e){var n=this,r=new Pa;return t.asyncQueue.enqueueAndForget(function(){return Object(Mr.b)(n,void 0,void 0,function(){var n;return Object(Mr.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(Mr.b)(this,void 0,void 0,function(){var r,i;return Object(Mr.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=$r(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Mn.mn(t,e)})}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new Br(qr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=_h(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}})})},[4,Rl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t._key).then(function(n){return new td(e,r,t._key,n,new Zf(null!==n&&n.hasLocalMutations,!0),t.converter)})}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=ef(t,sf);var e=ef(t.firestore,yf);return Ul(gf(e),t._key,{source:"server"}).then(function(n){return Sd(e,t,n)})}(this._delegate):function(t){t=ef(t,sf);var e=ef(t.firestore,yf);return Ul(gf(e),t._key).then(function(n){return Sd(e,t,n)})}(this._delegate)).then(function(t){return new qd(e.firestore,new td(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))})},t.prototype.withConverter=function(e){return new t(this.firestore,this._delegate.withConverter(e?Ld.eu(this.firestore,e):null))},t}();function Ud(t,e,n){return t.message=t.message.replace(e,n),t}function Md(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!pf(r))return r}return{}}function Fd(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=pf(t[0])?t[0]:pf(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var qd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new Vd(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return id(this._delegate,t._delegate)},t}(),Bd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Mr.c)(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(qd),Kd=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new jd(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,ad(this._delegate,function(t,e,n){var r=e,i=Jf("where",t);return new ud(i,r,n)}(e,n,r)))}catch(e){throw Ud(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,ad(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=Jf("orderBy",t);return new cd(r,n)}(e,n)))}catch(e){throw Ud(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,ad(this._delegate,function(t){return nf("limit",t),new hd("limit",t,"F")}(e)))}catch(e){throw Ud(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,ad(this._delegate,function(t){return nf("limitToLast",t),new hd("limitToLast",t,"L")}(e)))}catch(e){throw Ud(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,ad(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ld("startAt",t,!0)}).apply(void 0,e)))}catch(e){throw Ud(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,ad(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ld("startAfter",t,!1)}).apply(void 0,e)))}catch(e){throw Ud(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,ad(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new fd("endBefore",t,!0)}).apply(void 0,e)))}catch(e){throw Ud(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,ad(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new fd("endAt",t,!1)}).apply(void 0,e)))}catch(e){throw Ud(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return ff(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=ef(t,af);var e=ef(t.firestore,yf),n=gf(e),r=new Ed(e);return function(t,e){var n=this,r=new Pa;return t.asyncQueue.enqueueAndForget(function(){return Object(Mr.b)(n,void 0,void 0,function(){var n;return Object(Mr.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(Mr.b)(this,void 0,void 0,function(){var r,i,o,s,a;return Object(Mr.d)(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,hc(t,e,!0)];case 1:return a=u.sent(),r=new Fh(e,a.Bn),i=r._o(a.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=u.sent(),a=_h(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}})})},[4,Rl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t._query).then(function(n){return new nd(e,r,t,n)})}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=ef(t,af);var e=ef(t.firestore,yf),n=gf(e),r=new Ed(e);return Ml(n,t._query,{source:"server"}).then(function(n){return new nd(e,r,t,n)})}(this._delegate):function(t){t=ef(t,af);var e=ef(t.firestore,yf),n=gf(e),r=new Ed(e);return od(t._query),Ml(n,t._query).then(function(n){return new nd(e,r,t,n)})}(this._delegate)).then(function(t){return new Gd(e.firestore,new nd(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))})},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Md(e),i=Fd(e,function(e){return new Gd(t.firestore,new nd(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))});return _d(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,this._delegate.withConverter(e?Ld.eu(this.firestore,e):null))},t}(),zd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new Bd(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),Gd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new Kd(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map(function(e){return new Bd(t._firestore,e)})},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map(function(t){return new zd(e._firestore,t)})},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach(function(r){t.call(e,new Bd(n._firestore,r))})},t.prototype.isEqual=function(t){return id(this._delegate,t._delegate)},t}(),Qd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return Object(Mr.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new Vd(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Vd(this.firestore,void 0===t?hf(this._delegate):hf(this._delegate,t))}catch(t){throw Ud(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=ef(t.firestore,yf),r=hf(t),i=vd(t.converter,e);return Od(n,[xf(kf(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,Ko.exists(!1))]).then(function(){return r})}(this._delegate,t).then(function(t){return new Vd(e.firestore,t)})},e.prototype.isEqual=function(t){return lf(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,this._delegate.withConverter(t?Ld.eu(this.firestore,t):null))},e}(Kd);function Hd(t){return ef(t,sf)}var Wd,Yd=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(wf.bind.apply(wf,Object(Mr.f)([void 0],t)))}return t.documentId=function(){return new t(li.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=Object(A.h)(t))instanceof wf&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),Xd=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new Rf("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new Cf("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Pf("arrayUnion",t)}).apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Lf("arrayRemove",t)}).apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new Vf("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),$d=n("/6Yf"),Jd={Firestore:Cd,GeoPoint:Tf,Timestamp:ri,Blob:kd,Transaction:Rd,WriteBatch:Pd,DocumentReference:Vd,DocumentSnapshot:qd,Query:Kd,QueryDocumentSnapshot:Bd,QuerySnapshot:Gd,CollectionReference:Qd,FieldPath:Yd,FieldValue:Xd,setLogLevel:function(t){Kr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new $d.a("firestore",function(t){return function(t,e){return new Cd(t,new yf(t,e),new xd)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},Jd)))})(Wd=D.a),Wd.registerVersion("@firebase/firestore","2.3.6");var Zd=n("UbJi");function tp(t,e){return function(t,e=p.b){return new y.a(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{null!=r&&r()}})}(t,e)}function ep(t,e){return tp(t,e).pipe(Object(w.a)(t=>({payload:t,type:"query"})))}function np(t,e){return ep(t,e).pipe(Object(v.a)(void 0),Object(b.a)(),Object(w.a)(([t,e])=>{const n=e.payload.docChanges(),r=n.map(t=>({type:t.type,payload:t}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(e.payload.metadata)&&e.payload.docs.forEach((e,i)=>{const o=n.find(t=>t.doc.ref.isEqual(e.ref)),s=null==t?void 0:t.payload.docs.find(t=>t.ref.isEqual(e.ref));o&&JSON.stringify(o.doc.metadata)===JSON.stringify(e.metadata)||!o&&s&&JSON.stringify(s.metadata)===JSON.stringify(e.metadata)||r.push({type:"modified",payload:{oldIndex:i,newIndex:i,type:"modified",doc:e}})}),r}))}function rp(t,e,n){return np(t,n).pipe(Object(I.a)((t,n)=>function(t,e,n){return e.forEach(e=>{n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":if(!t[e.newIndex]||!t[e.newIndex].doc.ref.isEqual(e.doc.ref))return ip(t,e.newIndex,0,e);break;case"modified":if(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}return ip(t,e.newIndex,1,e)}break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return ip(t,e.oldIndex,1)}return t}(t,e))}),t}(t,n.map(t=>t.payload),e),[]),Object(E.a)(),Object(w.a)(t=>t.map(t=>({type:t.type,payload:t}))))}function ip(t,e,n,...r){const i=t.slice();return i.splice(e,n,...r),i}function op(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}class sp{constructor(t,e,n){this.ref=t,this.query=e,this.afs=n}stateChanges(t){let e=np(this.query,this.afs.schedulers.outsideAngular);return t&&t.length>0&&(e=e.pipe(Object(w.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)))),e.pipe(Object(v.a)(void 0),Object(b.a)(),Object(T.a)(([t,e])=>e.length>0||!t),Object(w.a)(([t,e])=>e),this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(I.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=op(t);return rp(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return ep(this.query,this.afs.schedulers.outsideAngular).pipe(Object(w.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(g.a)(this.query.get(t)).pipe(Object(_.b)(this.afs.schedulers.insideAngular))}add(t){return this.ref.add(t)}doc(t){return new ap(this.ref.doc(t),this.afs)}}class ap{constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const n=this.ref.collection(t),{ref:r,query:i}=dp(n,e);return new sp(r,i,this.afs)}snapshotChanges(){return tp(this.ref,this.afs.schedulers.outsideAngular).pipe(Object(v.a)(void 0),Object(b.a)(),Object(w.a)(([t,e])=>e.exists?(null==t?void 0:t.exists)?{payload:e,type:"modified"}:{payload:e,type:"added"}:{payload:e,type:"removed"})).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return this.snapshotChanges().pipe(Object(w.a)(({payload:e})=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data()))}get(t){return Object(g.a)(this.ref.get(t)).pipe(Object(_.b)(this.afs.schedulers.insideAngular))}}class up{constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?np(this.query,this.afs.schedulers.outsideAngular).pipe(Object(w.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)),Object(T.a)(t=>t.length>0),this.afs.keepUnstableUntilFirst):np(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(I.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=op(t);return rp(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return ep(this.query,this.afs.schedulers.outsideAngular).pipe(Object(w.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign({[t.idField]:e.id},e.data()):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(g.a)(this.query.get(t)).pipe(Object(_.b)(this.afs.schedulers.insideAngular))}}const cp=new i.s("angularfire2.enableFirestorePersistence"),hp=new i.s("angularfire2.firestore.persistenceSettings"),lp=new i.s("angularfire2.firestore.settings"),fp=new i.s("angularfire2.firestore.use-emulator");function dp(t,e=(t=>t)){return{query:e(t),ref:t}}let pp=(()=>{class t{constructor(t,e,n,i,o,s,a,u,c){this.schedulers=new O.d(s),this.keepUnstableUntilFirst=Object(O.h)(this.schedulers);const h=Object(O.g)(t,s,e);!S.a.auth&&c&&Object(O.j)();const l=u;[this.firestore,this.persistenceEnabled$]=Object(O.f)(`${h.name}.firestore`,"AngularFirestore",h,()=>{const t=s.runOutsideAngular(()=>h.firestore());if(i&&t.settings(i),l&&t.useEmulator(...l),n&&!Object(r.u)(o)){const e=()=>{try{return Object(g.a)(t.enablePersistence(a||void 0).then(()=>!0,()=>!1))}catch(Wd){return"undefined"!=typeof console&&console.warn(Wd),Object(m.a)(!1)}};return[t,s.runOutsideAngular(e)]}return[t,Object(m.a)(!1)]},[i,l,n])}collection(t,e){let n;n="string"==typeof t?this.firestore.collection(t):t;const{ref:r,query:i}=dp(n,e),o=this.schedulers.ngZone.run(()=>r);return new sp(o,i,this)}collectionGroup(t,e){const n=e||(t=>t),r=this.firestore.collectionGroup(t);return new up(n(r),this)}doc(t){let e;e="string"==typeof t?this.firestore.doc(t):t;const n=this.schedulers.ngZone.run(()=>e);return new ap(n,this)}createId(){return this.firestore.collection("_").doc().id}}return t.\u0275fac=function(e){return new(e||t)(i.Zb(O.c),i.Zb(O.b,8),i.Zb(cp,8),i.Zb(lp,8),i.Zb(i.D),i.Zb(i.B),i.Zb(hp,8),i.Zb(fp,8),i.Zb(Zd.b,8))},t.\u0275prov=i.Lb({factory:function(){return new t(i.Zb(O.c),i.Zb(O.b,8),i.Zb(cp,8),i.Zb(lp,8),i.Zb(i.D),i.Zb(i.B),i.Zb(hp,8),i.Zb(fp,8),i.Zb(Zd.b,8))},token:t,providedIn:"any"}),t})();var yp=n("kmnG"),gp=n("qFsG");let mp=(()=>{class t{constructor(t,e,n,r){this.dialogRef=t,this.data=e,this.db=n,this.auth=r,this.userData={}}ngOnInit(){this.auth.user.subscribe(t=>{this.userData=t})}saveData(){if(this.loading=!0,null==this.data.id){let t=(new Date).getTime().toString();this.data.uid=this.userData.uid,this.db.collection("employees").doc(t).set(this.data).then(t=>{this.dialogRef.close(this.data),this.loading=!1}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak Dapat Menyimpan Data")})}else this.db.collection("employees/").doc(this.data.id).update(this.data).then(t=>{this.dialogRef.close(this.data),this.loading=!1}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak Dapat Mengupdate Data")})}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(d.f),i.Pb(d.a),i.Pb(pp),i.Pb(Zd.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-employee-detail"]],decls:32,vars:8,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["appearance","outline",2,"width","100%"],["matInput","","placeholder","Ex. Afnanda Saputra",3,"ngModel","ngModelChange"],["matInput","","placeholder","Ex. Yogyakarta",3,"ngModel","ngModelChange"],["matInput","","placeholder","Ex. 19 tahun",3,"ngModel","ngModelChange"],["matInput","","placeholder","Ex. Islam",3,"ngModel","ngModelChange"],["matInput","","placeholder","Ex. 03 september 2001",3,"ngModel","ngModelChange"],["mat-dialog-action","","align","end"],["mat-button","","mat-dialog-close",""],["mat-flat-button","",3,"disabled","click"]],template:function(t,e){1&t&&(i.Vb(0,"h3",0),i.zc(1," Detail\n"),i.Ub(),i.Vb(2,"div",1),i.Vb(3,"mat-form-field",2),i.Vb(4,"mat-label"),i.zc(5,"Nama Produk"),i.Ub(),i.Vb(6,"input",3),i.cc("ngModelChange",function(t){return e.data.name=t}),i.Ub(),i.Ub(),i.Vb(7,"mat-form-field",2),i.Vb(8,"mat-label"),i.zc(9,"Ukuran"),i.Ub(),i.Vb(10,"input",4),i.cc("ngModelChange",function(t){return e.data.size=t}),i.Ub(),i.Ub(),i.Vb(11,"mat-form-field",2),i.Vb(12,"mat-label"),i.zc(13,"Kertas"),i.Ub(),i.Vb(14,"input",4),i.cc("ngModelChange",function(t){return e.data.paper=t}),i.Ub(),i.Ub(),i.Vb(15,"mat-form-field",2),i.Vb(16,"mat-label"),i.zc(17,"Bingkai"),i.Ub(),i.Vb(18,"input",5),i.cc("ngModelChange",function(t){return e.data.bingkai=t}),i.Ub(),i.Ub(),i.Vb(19,"mat-form-field",2),i.Vb(20,"mat-label"),i.zc(21,"Lama Pengerjaan"),i.Ub(),i.Vb(22,"input",6),i.cc("ngModelChange",function(t){return e.data.time=t}),i.Ub(),i.Ub(),i.Vb(23,"mat-form-field",2),i.Vb(24,"mat-label"),i.zc(25,"Harga"),i.Ub(),i.Vb(26,"input",7),i.cc("ngModelChange",function(t){return e.data.price=t}),i.Ub(),i.Ub(),i.Ub(),i.Vb(27,"div",8),i.Vb(28,"button",9),i.zc(29,"Batal"),i.Ub(),i.Vb(30,"button",10),i.cc("click",function(){return e.saveData()}),i.zc(31),i.Ub(),i.Ub()),2&t&&(i.Eb(6),i.lc("ngModel",e.data.name),i.Eb(4),i.lc("ngModel",e.data.size),i.Eb(4),i.lc("ngModel",e.data.paper),i.Eb(4),i.lc("ngModel",e.data.bingkai),i.Eb(4),i.lc("ngModel",e.data.time),i.Eb(4),i.lc("ngModel",e.data.price),i.Eb(4),i.lc("disabled",e.loading),i.Eb(1),i.Ac(e.loading?"Menyimpan..":"Simpan"))},directives:[d.g,d.d,yp.b,yp.e,gp.b,h.c,h.j,h.l,a.a,d.c],styles:[""]}),t})();var vp=n("Xa2L"),bp=n("Wp6s");function wp(t,e){1&t&&(i.Vb(0,"div",2),i.Qb(1,"mat-spinner"),i.Ub())}function Ip(t,e){if(1&t){const t=i.Wb();i.Vb(0,"tr"),i.Vb(1,"td"),i.zc(2),i.Ub(),i.Vb(3,"td"),i.zc(4),i.Ub(),i.Vb(5,"td"),i.zc(6),i.Ub(),i.Vb(7,"td"),i.zc(8),i.Ub(),i.Vb(9,"td"),i.zc(10),i.Ub(),i.Vb(11,"td"),i.zc(12),i.Ub(),i.Vb(13,"td"),i.zc(14),i.Ub(),i.Vb(15,"td"),i.zc(16),i.Ub(),i.Vb(17,"td",6),i.Vb(18,"mat-icon",8),i.cc("click",function(){i.sc(t);const n=e.$implicit,r=e.index;return i.gc(2).EmployeeDetail(n,r)}),i.zc(19,"edit_note"),i.Ub(),i.Vb(20,"mat-icon",9),i.cc("click",function(){i.sc(t);const n=e.$implicit,r=e.index;return i.gc(2).DeleteEmployee(n.id,r)}),i.zc(21,"delete_forever"),i.Ub(),i.Ub(),i.Ub()}if(2&t){const t=e.$implicit,n=e.index;i.Eb(2),i.Ac(n+1),i.Eb(2),i.Ac(t.name),i.Eb(2),i.Ac(t.size),i.Eb(2),i.Ac(t.paper),i.Eb(2),i.Ac(t.bingkai),i.Eb(2),i.Ac(t.time),i.Eb(2),i.Ac(t.price),i.Eb(2),i.Ac(t.gender)}}function Ep(t,e){if(1&t){const t=i.Wb();i.Vb(0,"mat-card"),i.Vb(1,"mat-card-header"),i.Vb(2,"mat-card-title"),i.zc(3),i.Ub(),i.Ub(),i.Vb(4,"mat-card-content"),i.Vb(5,"div",3),i.Qb(6,"span",4),i.Vb(7,"button",5),i.cc("click",function(){return i.sc(t),i.gc().EmployeeDetail({},-1)}),i.zc(8,"Tambah Daftar"),i.Ub(),i.Ub(),i.Qb(9,"br"),i.Vb(10,"table",3),i.Vb(11,"thead"),i.Vb(12,"th"),i.zc(13,"No"),i.Ub(),i.Vb(14,"th"),i.zc(15,"Nama Produk"),i.Ub(),i.Vb(16,"th"),i.zc(17,"Ukuran"),i.Ub(),i.Vb(18,"th"),i.zc(19,"Kertas"),i.Ub(),i.Vb(20,"th"),i.zc(21,"Bingkai"),i.Ub(),i.Vb(22,"th"),i.zc(23,"Lama Pengerjaan"),i.Ub(),i.Vb(24,"th"),i.zc(25,"Harga"),i.Ub(),i.Qb(26,"th",6),i.Ub(),i.Vb(27,"tbody"),i.yc(28,Ip,22,8,"tr",7),i.Ub(),i.Ub(),i.Ub(),i.Ub()}if(2&t){const t=i.gc();i.Eb(3),i.Ac(t.title),i.Eb(25),i.lc("ngForOf",t.employees)}}const Tp=[{path:"",component:u,children:[{path:"employee",component:(()=>{class t{constructor(t,e,n){this.dialog=t,this.auth=e,this.db=n,this.employees={},this.userData={},this.loadingDelete={}}ngOnInit(){this.title="Daftar Harga",this.auth.user.subscribe(t=>{this.userData=t,this.getEmployees()})}getEmployees(){this.loading=!0,this.db.collection("employees",t=>t.where("uid","==",this.userData.uid)).valueChanges({idField:"id"}).subscribe(t=>{console.log(t),this.employees=t,this.loading=!1},t=>{this.loading=!1})}EmployeeDetail(t,e){this.dialog.open(mp,{width:"400px",data:t}).afterClosed().subscribe(t=>{})}DeleteEmployee(t,e){confirm("Delete item?")&&this.db.collection("employees").doc(t).delete().then(t=>{this.employees.splice(e,1),this.loadingDelete[e]=!1}).catch(t=>{this.loadingDelete[e]=!1,alert("Tidak dapat menghapus data")})}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(d.b),i.Pb(Zd.a),i.Pb(pp))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-employee"]],decls:2,vars:2,consts:[["style","height: 300px;","class","uk-flex uk-flex-center uk-flex-middle",4,"ngIf"],[4,"ngIf"],[1,"uk-flex","uk-flex-center","uk-flex-middle",2,"height","300px"],[1,"uk-flex"],[1,"uk-width-expand"],["mat-flat-button","","color","primary",2,"color","aliceblue","float","right",3,"click"],["align","right"],[4,"ngFor","ngForOf"],["color","primary",2,"cursor","pointer","margin-right","20px",3,"click"],["color","accent",2,"cursor","pointer",3,"click"]],template:function(t,e){1&t&&(i.yc(0,wp,2,0,"div",0),i.yc(1,Ep,29,2,"mat-card",1)),2&t&&(i.lc("ngIf",e.loading),i.Eb(1),i.lc("ngIf",!e.loading))},directives:[r.k,vp.b,bp.a,bp.c,bp.e,bp.b,a.a,r.j,l.a],styles:[""]}),t})()},{path:"image",component:f},{path:"",pathMatch:"full",redirectTo:"/admin/employee"}]}];let _p=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.Nb({type:t}),t.\u0275inj=i.Mb({imports:[[r.c,o.c.forChild(Tp),c.a,h.f]]}),t})()}}]);